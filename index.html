<!doctype html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
    content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width">
  <title>[##_page_title_##]</title>
  <link rel="alternate" type="application/rss+xml" title="[##_title_##]" href="[##_rss_url_##]" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500;700&family=Ubuntu+Mono:wght@400;700&family=Fira+Code:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.19.0/js/md5.min.js"></script>

  <!-- Highlight.js (ì½”ë“œ ì‹ íƒìŠ¤ í•˜ì´ë¼ì´íŒ…) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

  <link rel="stylesheet" href="./style.css">
  <link rel="stylesheet" href="./images/font.css">
  <style>
    /* í™ˆí™”ë©´ ë°ìŠ¤í¬íƒ‘ ëª¨ë“œ: ë¸”ë¡œê·¸ ë³¸ë¬¸ ì „ì²´ ìˆ¨ê¹€ (ë°ìŠ¤í¬íƒ‘ ì˜¤ë²„ë ˆì´ê°€ ë®ìŒ) */
    #tt-body-index #dkWrap { visibility: hidden; }
    /* ì¸ë±ìŠ¤ í˜ì´ì§€: JS ì‹¤í–‰ ì „ì—ë„ ì¦‰ì‹œ ë°ìŠ¤í¬íƒ‘ í‘œì‹œ (flash ë°©ì§€) */
    #tt-body-index #dyoDesktop { display: flex; }

    <s_if_var_cover-image>.wrap_sub {
      background-image: url('[##_var_cover-image_##]');
    }
    </s_if_var_cover-image>
  </style>

  <!--[if lt IE 9]>
  <script src="//t1.daumcdn.net/tistory_admin/lib/jquery/jquery-1.12.4.min.js"></script>
  <![endif]-->
  <!--[if gte IE 9]><!-->
  <script src="//t1.daumcdn.net/tistory_admin/lib/jquery/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <!--<![endif]-->
</head>

<body id="[##_body_id_##]">
  <s_t3>

    <div id="dkIndex">
      <a href="#dkBody">ë³¸ë¬¸ ë°”ë¡œê°€ê¸°</a>
    </div>

    <div id="dkWrap" class="wrap_skin">
      <div id="dkHead" role="banner" class="area_head">
        <h1 class="screen_out">[##_title_##]</h1>
        <button type="button" class="btn_cate">
          <span class="ico_skin ico_cate">ì¹´í…Œê³ ë¦¬</span>
        </button>

        <div class="area_search">
          <button type="button" class="btn_search">
            <span class="ico_search">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg>
            </span>
          </button>
          <s_search>
            <form action="#" method="get" class="frm_search box_search" onsubmit="[##_search_onclick_submit_##]">
              <fieldset>
                <legend class="screen_out">ê²€ìƒ‰í•˜ê¸°</legend>
                <label for="[##_search_name_##]" class="lab_search screen_out">ë¸”ë¡œê·¸ ë‚´ ê²€ìƒ‰</label>
                <input type="text" name="[##_search_name_##]" id="[##_search_name_##]" class="tf_search"
                  placeholder="grep -r &quot;keyword&quot;" value="[##_search_text_##]" data-value="[##_search_text_##]">
              </fieldset>
            </form>
          </s_search>
        </div>

        <div class="area_profile">
          <div class="terminal-prompt">
            <span class="prompt-symbol">~$</span>
            <span class="prompt-cmd">whoami</span>
          </div>
          <div class="tit_post">
            <a href="/" class="link_post">[##_title_##]</a>
          </div>
          <a href="/category" class="thumb_profile">
            <img src="[##_image_##]" class="img_profile" alt="í”„ë¡œí•„ì‚¬ì§„">
          </a>
          <span class="txt_profile">[##_blogger_##]</span>
          <div class="typing-line">
            <span class="typing-prompt">~$</span>
            <span class="typing-text" id="typingText"></span>
            <span class="typing-cursor"></span>
          </div>
        </div>
      </div>

      <hr class="hide">

      <div id="dkContent" class="cont_skin" role="main">
        <div id="cMain">
          <div id="mFeature" class="wrap_sub">
            <div class="cont_sub">
              <div class="inner_sub">
                <div class="area_sub">
                  <div role="navigation" class="area_navi">
                    [##_category_list_##]
                    <a href="[##_guestbook_link_##]" class="link_guestbook">Guestbook</a>
                  </div>
                  <div class="wrap_etc">
                    <div class="col_aside left_side">
                      <s_sidebar>
                        <s_sidebar_element>
                          <s_rct_notice>
                            <div class="box_aside">
                              <strong class="tit_aside"><span class="aside-icon">&#9654;</span> Notice</strong>
                              <ul class="list_board">
                                <s_rct_notice_rep>
                                  <li><a href="[##_notice_rep_link_##]" class="link_board">[##_notice_rep_title_##]</a></li>
                                </s_rct_notice_rep>
                              </ul>
                            </div>
                          </s_rct_notice>
                        </s_sidebar_element>

                        <s_sidebar_element>
                          <div class="box_aside">
                            <strong class="tit_aside"><span class="aside-icon">&#9654;</span> Recent Posts</strong>
                            <ul class="list_board">
                              <s_rctps_rep>
                                <li><a href="[##_rctps_rep_link_##]" class="link_board">[##_rctps_rep_title_##]</a></li>
                              </s_rctps_rep>
                            </ul>
                          </div>
                        </s_sidebar_element>

                        <s_sidebar_element>
                          <div class="box_aside">
                            <strong class="tit_aside"><span class="aside-icon">&#9654;</span> Recent Comments</strong>
                            <ul class="list_board">
                              <s_rctrp_rep>
                                <li><a href="[##_rctrp_rep_link_##]" class="link_board">[##_rctrp_rep_desc_##]</a></li>
                              </s_rctrp_rep>
                            </ul>
                          </div>
                        </s_sidebar_element>

                        <s_sidebar_element>
                          <div class="box_aside">
                            <strong class="tit_aside"><span class="aside-icon">&#9654;</span> Link</strong>
                            <ul class="list_board">
                              <s_link_rep>
                                <li><a href="[##_link_url_##]" class="link_board" target="_blank">[##_link_site_##]</a></li>
                              </s_link_rep>
                            </ul>
                          </div>
                        </s_sidebar_element>
                      </s_sidebar>
                    </div>

                    <div class="col_aside right_side">
                      <s_sidebar>
                        <s_sidebar_element>
                          <div class="box_aside box_calendar">
                            [##_calendar_##]
                          </div>
                        </s_sidebar_element>

                        <s_sidebar_element>
                          <div class="box_aside box_tag">
                            <strong class="tit_aside"><span class="aside-icon">&#9654;</span> Tags</strong>
                            <ul class="list_tag">
                              <s_random_tags>
                                <li><a href="[##_tag_link_##]" class="link_tag [##_tag_class_##]">[##_tag_name_##]</a></li>
                              </s_random_tags>
                            </ul>
                            <a href="[##_taglog_link_##]" class="link_more">more</a>
                          </div>
                        </s_sidebar_element>

                        <s_sidebar_element>
                          <div class="box_aside box_archive">
                            <strong class="tit_aside"><span class="aside-icon">&#9654;</span> Archives</strong>
                            <ul class="list_keep">
                              <s_archive_rep>
                                <li><a href="[##_archive_rep_link_##]" class="link_keep">[##_archive_rep_date_##]</a>
                                  ([##_archive_rep_count_##])</li>
                              </s_archive_rep>
                            </ul>
                          </div>
                        </s_sidebar_element>

                        <s_sidebar_element>
                          <div class="box_aside box_visitor">
                            <dl class="list_visitor">
                              <dt>Today</dt>
                              <dd>[##_count_today_##]</dd>
                            </dl>
                            <dl class="list_total">
                              <dt>Total</dt>
                              <dd>[##_count_total_##]</dd>
                            </dl>
                          </div>
                        </s_sidebar_element>
                      </s_sidebar>
                    </div>
                  </div>
                </div>
              </div>
              <button type="button" class="btn_close">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>
              </button>

              <ul class="list_control">
                <li>
                  <button type="button" id="btnShell" title="Terminal">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>
                  </button>
                </li>
              </ul>
            </div>
          </div>

          <div id="mArticle" class="article_skin">

            <s_list>
              <div class="list_title">
                <h2 id="dkBody" class="tit_skin"><span class="screen_out">ëª©ë¡</span><span
                    class="txt_title">[##_list_conform_##] <span class="count-badge">([##_list_count_##])</span></span></h2>
              </div>
            </s_list>

            <div class="index_title">
              <h2 class="tit_skin"><span class="txt_title">[##_title_##]</span></h2>
            </div>

            <s_article_rep>
              <s_index_article_rep>
                <div class="list_content">
                  <s_article_rep_thumbnail>
                    <a href="[##_article_rep_link_##]" class="thumbnail_post"
                      data-tiara-action-name="ë¸”ë¡œê·¸ê¸€_í´ë¦­"
                      data-tiara-action-kind="ClickContent"
                      data-tiara-copy="[##_article_rep_title_##]"
                      data-tiara-image="[##_article_rep_thumbnail_url_##]"
                      data-tiara-click_url="[##_blog_link_##][##_article_rep_link_##]"
                      data-tiara-name="[##_article_rep_title_##]"
                      data-tiara-provider="[##_title_##]"
                      data-tiara-plink="[##_article_rep_link_##]"
                      data-tiara-id="[##_article_rep_link_##]"
                    ><img src="[##_article_rep_thumbnail_url_##]" alt="[##_article_rep_title_##]"></a>
                  </s_article_rep_thumbnail>
                  <a href="[##_article_rep_link_##]" class="link_post"
                    data-tiara-action-name="ë¸”ë¡œê·¸ê¸€_í´ë¦­"
                    data-tiara-action-kind="ClickContent"
                    data-tiara-copy="[##_article_rep_title_##]"
                    data-tiara-image="[##_article_rep_thumbnail_url_##]"
                    data-tiara-click_url="[##_blog_link_##][##_article_rep_link_##]"
                    data-tiara-name="[##_article_rep_title_##]"
                    data-tiara-provider="[##_title_##]"
                    data-tiara-plink="[##_article_rep_link_##]"
                    data-tiara-id="[##_article_rep_link_##]"
                  >
                    <strong class="tit_post">[##_article_rep_title_##]</strong>
                    <p class="txt_post">[##_article_rep_summary_##]</p>
                  </a>
                  <div class="detail_info">
                    <a href="[##_article_rep_category_link_##]" class="link_cate">[##_article_rep_category_##]</a>
                    <span class="txt_bar"></span>
                    <span class="txt_date">[##_article_rep_date_##]</span>
                  </div>
                </div>
              </s_index_article_rep>

              <s_permalink_article_rep>
                <h2 id="dkBody" class="screen_out">[##_article_rep_title_##] ë³¸ë¬¸</h2>
                <div class="area_title">
                  <strong class="tit_category"><a
                      href="[##_article_rep_category_link_##]">[##_article_rep_category_##]</a></strong>
                  <h3 class="tit_post">[##_article_rep_title_##]</h3>
                  <span class="info_post">
                    <span class="post-meta-item">[##_article_rep_author_##]</span>
                    <span class="txt_bar"></span>
                    <span class="post-meta-item">[##_article_rep_date_##]</span>
                    [##_s_ad_isolation_##]
                  </span>
                </div>

                <div class="area_view" id="article-view">
                  [##_article_rep_desc_##]
                </div>
                <div class="area_etc">
                  <s_tag_label>
                    <dl class="list_tag">
                      <dt>Tag</dt>
                      <dd>[##_tag_label_rep_##]</dd>
                    </dl>
                  </s_tag_label>
                </div>

                <s_article_related>
                  <div class="area_related">
                    <strong class="tit_related">'[##_article_rep_category_##]' Related Articles</strong>
                    <ul class="list_related">
                      <s_article_related_rep>
                        <li class="[##_article_related_rep_type_##]">
                          <a href="[##_article_related_rep_link_##]" class="link_related">
                            <s_article_related_rep_thumbnail>
                              <span class="thumb_related">
                                <img src="[##_article_related_rep_thumbnail_link_##]"
                                  class="img_related" alt="">
                              </span>
                            </s_article_related_rep_thumbnail>
                            <span class="txt_related">[##_article_related_rep_title_##]</span>
                            <span class="date_related">[##_article_related_rep_date_##]</span>
                            <span class="frame_related"></span>
                          </a>
                        </li>
                      </s_article_related_rep>
                    </ul>
                    <a href="[##_article_rep_category_link_##]" class="link_more">more</a>
                  </div>
                </s_article_related>

                <div class="area_reply">
                  <s_rp>
                    [##_comment_group_##]
                  </s_rp>
                </div>
              </s_permalink_article_rep>
            </s_article_rep>

            <s_page_rep>
              <s_permalink_article_rep>
                <h2 id="dkBody" class="screen_out">[##_article_rep_title_##] ë³¸ë¬¸</h2>
                <div class="area_title">
                  <h3 class="tit_post">[##_article_rep_title_##]</h3>
                </div>
                <div class="area_view" id="article-view">
                  [##_article_rep_desc_##]
                </div>
              </s_permalink_article_rep>
            </s_page_rep>

            <s_notice_rep>
              <s_index_article_rep>
                <div class="list_content">
                  <a href="[##_notice_rep_link_##]" class="link_post"
                    data-tiara-action-name="ê³µì§€ëª©ë¡ê¸€_í´ë¦­"
                    data-tiara-action-kind="ClickContent"
                    data-tiara-copy="[##_notice_rep_title_##]"
                    data-tiara-image="[##_notice_rep_thumbnail_url_##]"
                    data-tiara-click_url="[##_blog_link_##][##_notice_rep_link_##]"
                    data-tiara-name="[##_notice_rep_title_##]"
                    data-tiara-provider="[##_title_##]"
                    data-tiara-plink="[##_notice_rep_link_##]"
                    data-tiara-id="[##_notice_rep_link_##]"
                  >
                    <strong class="tit_post">[##_notice_rep_title_##]</strong>
                    <p class="txt_post">[##_notice_rep_summary_##]</p>
                  </a>
                  <div class="detail_info">
                    <a href="/notice" class="link_cate">ê³µì§€ì‚¬í•­</a>
                    <span class="txt_bar"></span> [##_notice_rep_date_##]
                  </div>
                </div>
              </s_index_article_rep>

              <s_permalink_article_rep>
                <h2 id="dkBody" class="screen_out">[##_notice_rep_title_##] ë³¸ë¬¸</h2>
                <div class="area_title">
                  <strong class="tit_category"><a href="/notice">ê³µì§€ì‚¬í•­</a></strong>
                  <h3 class="tit_post">[##_notice_rep_title_##]</h3>
                  <span class="info_post">[##_notice_rep_author_##]
                    <span class="txt_bar"></span>[##_notice_rep_date_##]</span>
                </div>
                <div class="area_view" id="article-view">
                  [##_notice_rep_desc_##]
                </div>
              </s_permalink_article_rep>
            </s_notice_rep>

            <s_article_protected>
              <s_index_article_rep>
                <div class="list_content">
                  <a href="[##_article_rep_link_##]" class="link_post"
                    data-tiara-action-name="ë¸”ë¡œê·¸ê¸€_í´ë¦­"
                    data-tiara-action-kind="ClickContent"
                    data-tiara-copy="[##_article_rep_title_##]"
                    data-tiara-image="[##_article_rep_thumbnail_url_##]"
                    data-tiara-click_url="[##_blog_link_##][##_article_rep_link_##]"
                    data-tiara-name="[##_article_rep_title_##]"
                    data-tiara-provider="[##_title_##]"
                    data-tiara-plink="[##_article_rep_link_##]"
                    data-tiara-id="[##_article_rep_link_##]"
                  >
                    <strong class="tit_post">[##_article_rep_title_##]</strong>
                    <p class="txt_post">ë³´í˜¸ë˜ì–´ ìˆëŠ” ê¸€ì…ë‹ˆë‹¤.</p>
                  </a>
                  <div class="detail_info">
                    <a href="[##_article_rep_category_link_##]" class="link_cate">[##_article_rep_category_##]</a>
                    <span class="txt_bar"></span> [##_article_rep_date_##]
                  </div>
                </div>
              </s_index_article_rep>

              <s_permalink_article_rep>
                <h2 id="dkBody" class="screen_out">[##_article_rep_title_##] ë³¸ë¬¸</h2>
                <div class="area_title">
                  <strong class="tit_category"><a
                      href="[##_article_rep_category_link_##]">[##_article_rep_category_##]</a></strong>
                  <h3 class="tit_post">[##_article_rep_title_##]</h3>
                  <span class="info_post">[##_article_rep_author_##]
                    <span class="txt_bar"></span>[##_article_rep_date_##]</span>
                </div>
                <form class="protected_form" onsubmit="[##_article_dissolve_##]">
                  <p>ë³´í˜¸ë˜ì–´ ìˆëŠ” ê¸€ì…ë‹ˆë‹¤.<br>ë‚´ìš©ì„ ë³´ì‹œë ¤ë©´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>
                  <input type="password" id="[##_article_password_##]" name="[##_article_password_##]" value=""
                    placeholder="ë¹„ë°€ë²ˆí˜¸" />
                  <button type="submit">í™•ì¸</button>
                </form>
              </s_permalink_article_rep>
            </s_article_protected>

            <s_tag>
              <h2 id="dkBody" class="tit_skin"><span class="txt_title">Tags</span></h2>
              <ul class="list_tag">
                <s_tag_rep>
                  <li><a href="[##_tag_link_##]" class="link_tag [##_tag_class_##]">[##_tag_name_##]</a></li>
                </s_tag_rep>
              </ul>
            </s_tag>

            <s_guest>
              [##_guestbook_group_##]
            </s_guest>

            <s_paging>
              <div class="area_paging">
                <span class="inner_paging">
                  <a [##_prev_page_##] class="btn_prev [##_no_more_prev_##]">
                    <span class="ico_prev">&larr;</span> Prev
                  </a>
                  <s_paging_rep>
                    <a [##_paging_rep_link_##] class="link_page">[##_paging_rep_link_num_##]</a>
                  </s_paging_rep>
                  <a [##_next_page_##] class="btn_next [##_no_more_next_##]">
                    Next <span class="ico_next">&rarr;</span>
                  </a>
                </span>
              </div>
            </s_paging>
          </div>
        </div>
      </div>

      <hr class="hide">

      <div id="dkFoot" role="contentinfo" class="area_foot">
        <small class="info_copyright">
          <span class="footer-prompt">$</span> echo "Powered by
          <a href="http://www.kakaocorp.com" class="emph_t" target="_blank">Kakao</a> // Designed by
          <a href="https://dyomyo.tistory.com" class="emph_t" target="_blank">Doyoucode</a>"
        </small>
      </div>
    </div>

    <!-- ìŠ¤í¬ë¡¤ ì§„í–‰ë°” -->
    <div class="scroll-progress" id="scrollProgress"></div>

    <!-- ë§¨ ìœ„ë¡œ ê°€ê¸° ë²„íŠ¼ -->
    <button type="button" class="btn-scroll-top" id="btnScrollTop" title="ë§¨ ìœ„ë¡œ">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="m18 15-6-6-6 6"/></svg>
    </button>


    <!-- íŠœí† ë¦¬ì–¼ ì˜¤ë²„ë ˆì´ -->
    <div id="dyoTutorial">
      <div id="dyoTutSpotlight"></div>
      <div id="dyoTutBox">
        <span class="dyo-tut-emoji" id="dyoTutEmoji"></span>
        <p class="dyo-tut-title" id="dyoTutTitle"></p>
        <p class="dyo-tut-desc"  id="dyoTutDesc"></p>
        <div class="dyo-tut-dots" id="dyoTutDots"></div>
        <div class="dyo-tut-actions">
          <button class="dyo-tut-skip" id="dyoTutSkip">Skip tutorial</button>
          <button class="dyo-tut-next" id="dyoTutNext">Next â†’</button>
        </div>
      </div>
      <div id="dyoTutPreview" class="hidden"></div>
    </div>

    <!-- ë°ìŠ¤í¬íƒ‘ í™ˆí™”ë©´ (ì¸ë±ìŠ¤ í˜ì´ì§€ ì „ìš©) -->
    <div class="dyo-desktop" id="dyoDesktop">
      <div class="dyo-desktop-grid">

        <!-- README ì•„ì´ì½˜ -->
        <div class="dyo-desktop-icon" id="desktopIconReadme" title="README">
          <div class="dyo-di-wrap">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" fill="#3b82f6" opacity="0.15"/>
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" fill="none" stroke="#3b82f6" stroke-width="1.5" stroke-linejoin="round"/>
              <polyline points="14 2 14 8 20 8" fill="none" stroke="#3b82f6" stroke-width="1.5" stroke-linejoin="round"/>
              <line x1="8" y1="12" x2="16" y2="12" stroke="#3b82f6" stroke-width="1.4"/>
              <line x1="8" y1="15" x2="16" y2="15" stroke="#3b82f6" stroke-width="1.4" opacity="0.65"/>
              <line x1="8" y1="18" x2="13" y2="18" stroke="#3b82f6" stroke-width="1.4" opacity="0.4"/>
            </svg>
          </div>
          <span class="dyo-di-label">README</span>
        </div>

        <!-- Terminal ì•„ì´ì½˜ (Windows CMD ìŠ¤íƒ€ì¼) -->
        <div class="dyo-desktop-icon" id="desktopIconShell" title="Terminal">
          <div class="dyo-di-wrap">
            <!-- CMD: > prompt + _ cursor -->
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="square" stroke-linejoin="miter" stroke-width="2.5">
              <polyline points="4 8 9 12 4 16"></polyline>
              <line x1="12" y1="16" x2="20" y2="16"></line>
            </svg>
          </div>
          <span class="dyo-di-label">Command Prompt</span>
        </div>

        <!-- Dev Blog ì•„ì´ì½˜ (Tistory) -->
        <div class="dyo-desktop-icon" id="desktopIconBlog" title="Dev Blog">
          <div class="dyo-di-wrap">
            <!-- Tistory T ë¡œê³  -->
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <rect x="3.5" y="6" width="17" height="3.2" rx="1.6" fill="white"/>
              <rect x="10.4" y="8.8" width="3.2" height="10.2" rx="1.6" fill="white"/>
            </svg>
          </div>
          <span class="dyo-di-label">Dev Blog</span>
        </div>

        <!-- GitHub ì•„ì´ì½˜ -->
        <div class="dyo-desktop-icon" id="desktopIconGithub" title="GitHub">
          <div class="dyo-di-wrap">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.17 6.839 9.49.5.092.682-.217.682-.482 0-.237-.008-.866-.013-1.7-2.782.604-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.464-1.11-1.464-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.741 0 .267.18.578.688.48C19.138 20.167 22 16.418 22 12c0-5.523-4.477-10-10-10z"/>
            </svg>
          </div>
          <span class="dyo-di-label">GitHub</span>
        </div>

        <!-- Guestbook ì±„íŒ… ì•„ì´ì½˜ -->
        <div class="dyo-desktop-icon" id="desktopIconGuest" title="Guestbook">
          <div class="dyo-di-wrap">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" fill="#FEE500" opacity="0.25" stroke="#c8a800" stroke-width="1.5" stroke-linejoin="round"/>
              <circle cx="8.5" cy="11" r="1.2" fill="#c8a800"/>
              <circle cx="12" cy="11" r="1.2" fill="#c8a800"/>
              <circle cx="15.5" cy="11" r="1.2" fill="#c8a800"/>
            </svg>
          </div>
          <span class="dyo-di-label">Guestbook</span>
        </div>

        <!-- File Explorer ì•„ì´ì½˜ -->
        <div class="dyo-desktop-icon" id="desktopIconExplorer" title="File Explorer">
          <div class="dyo-di-wrap">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M3 7a2 2 0 0 1 2-2h4l2 2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" fill="rgba(255,255,255,0.35)" stroke="#fff" stroke-width="1.5" stroke-linejoin="round"/>
              <path d="M3 11h18" stroke="#fff" stroke-width="1.3"/>
            </svg>
          </div>
          <span class="dyo-di-label">File Explorer</span>
        </div>

        <!-- Blogram ì•„ì´ì½˜ -->
        <div class="dyo-desktop-icon" id="desktopIconGallery" title="Blogram">
          <div class="dyo-di-wrap">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="2" y="2" width="20" height="20" rx="6" stroke="white" stroke-width="1.8"/>
              <circle cx="12" cy="12" r="5" stroke="white" stroke-width="1.8"/>
              <circle cx="17.5" cy="6.5" r="1.3" fill="white"/>
            </svg>
          </div>
          <span class="dyo-di-label">Blogram</span>
        </div>

      </div>

      <!-- í•˜ë‹¨ Dock -->
      <div class="dyo-desktop-bar">
        <div class="dyo-bar-center" id="dyoBarCenter"></div>
        <div class="dyo-dock" id="dyoDock"></div>
        <div class="dyo-bar-right">
          <span id="desktopClock">00:00</span>
          <span id="desktopDate">----/--/--</span>
        </div>
      </div>
    </div>

    <!-- ê°€ìƒ ë¸Œë¼ìš°ì € ì°½ (ë“œë˜ê·¸ ê°€ëŠ¥) -->
    <div class="dyo-browser-win" id="dyoBrowserWin">
      <div class="dyo-browser-titlebar" id="dyoBrowserTitlebar">
        <span class="dyo-term-dot red"    id="dyoBrowserClose" title="ë‹«ê¸°"></span>
        <span class="dyo-term-dot yellow" id="dyoBrowserMin"   title="ìµœì†Œí™”"></span>
        <span class="dyo-term-dot green"  id="dyoBrowserMax"   title="ìµœëŒ€í™”"></span>
        <div class="dyo-browser-navarea">
          <button class="dyo-browser-navbtn" id="dyoBrowserBack"   title="ë’¤ë¡œ">&#8592;</button>
          <button class="dyo-browser-navbtn" id="dyoBrowserFwd"    title="ì•ìœ¼ë¡œ">&#8594;</button>
          <div class="dyo-browser-urlbar" id="dyoBrowserUrl">about:blank</div>
          <button class="dyo-browser-navbtn" id="dyoBrowserReload" title="ìƒˆë¡œê³ ì¹¨">&#8635;</button>
        </div>
      </div>
      <iframe class="dyo-browser-frame" id="dyoBrowserFrame" src="about:blank"></iframe>
      <div class="dyo-brs-handle n"  data-dir="n"></div>
      <div class="dyo-brs-handle ne" data-dir="ne"></div>
      <div class="dyo-brs-handle e"  data-dir="e"></div>
      <div class="dyo-brs-handle se" data-dir="se"></div>
      <div class="dyo-brs-handle s"  data-dir="s"></div>
      <div class="dyo-brs-handle sw" data-dir="sw"></div>
      <div class="dyo-brs-handle w"  data-dir="w"></div>
      <div class="dyo-brs-handle nw" data-dir="nw"></div>
    </div>

    <!-- ê°€ìƒ í„°ë¯¸ë„ ì°½ (ë“œë˜ê·¸ ê°€ëŠ¥) -->
    <div class="dyo-shell-win" id="dyoShellWin">
      <div class="dyo-shell-titlebar" id="dyoShellTitlebar">
        <span class="dyo-term-dot red"    id="dyoShellClose"  title="ë‹«ê¸°"></span>
        <span class="dyo-term-dot yellow" id="dyoShellMin"    title="ìµœì†Œí™”"></span>
        <span class="dyo-term-dot green"  id="dyoShellMax"    title="ìµœëŒ€í™”"></span>
        <span class="dyo-shell-title">guest@blog: ~</span>
      </div>
      <div class="dyo-term-body" id="termOutput">
        <div class="dyo-term-banner">â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Welcome to doyoucode's terminal       â•‘
â•‘  Type '<span class="tr-cmd">help</span>' to see available commands â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</div>
        <form class="dyo-term-input-row" id="dyoTermForm" onsubmit="return false;">
          <span class="dyo-term-prompt" id="dyoTermPrompt">[doyoucode@blog&nbsp;~]$&nbsp;</span>
          <input class="dyo-term-input" id="termInput" type="text"
            autocomplete="off" spellcheck="false"
            placeholder="type a command...">
        </form>
      </div>
      <div class="dyo-brs-handle n"  data-dir="n"></div>
      <div class="dyo-brs-handle ne" data-dir="ne"></div>
      <div class="dyo-brs-handle e"  data-dir="e"></div>
      <div class="dyo-brs-handle se" data-dir="se"></div>
      <div class="dyo-brs-handle s"  data-dir="s"></div>
      <div class="dyo-brs-handle sw" data-dir="sw"></div>
      <div class="dyo-brs-handle w"  data-dir="w"></div>
      <div class="dyo-brs-handle nw" data-dir="nw"></div>
    </div>

    <!-- README ì°½ -->
    <div class="dyo-shell-win" id="dyoReadmeWin">
      <div class="dyo-shell-titlebar" id="dyoReadmeTitlebar">
        <span class="dyo-term-dot red"    id="dyoReadmeClose" title="ë‹«ê¸°"></span>
        <span class="dyo-term-dot yellow" id="dyoReadmeMin"   title="ìµœì†Œí™”"></span>
        <span class="dyo-term-dot green"  id="dyoReadmeMax"   title="ìµœëŒ€í™”"></span>
        <span class="dyo-shell-title">README.md</span>
      </div>
      <div class="dyo-term-body" style="overflow-y:auto;padding:20px 24px">
        <div style="font-family:'Noto Sans KR','Apple SD Gothic Neo',-apple-system,sans-serif;font-size:13px;line-height:1.85;color:#abb2bf">

          <div style="color:#e6e6e6;font-size:15px;font-weight:700;margin-bottom:2px"># doyoucode Â· README</div>
          <div style="color:#5c6370;font-size:12px;margin-bottom:16px">ê°œë°œì í…Œë§ˆì˜ Tistory ë¸”ë¡œê·¸ Â· ë°ìŠ¤í¬íƒ‘ UI + í„°ë¯¸ë„ ì¸í„°í˜ì´ìŠ¤</div>

          <div style="background:#1c2330;border:1px solid #e5c07b44;border-left:3px solid #e5c07b;border-radius:7px;padding:11px 14px;margin-bottom:22px;display:flex;align-items:flex-start;gap:10px">
            <span style="font-size:18px;flex-shrink:0;line-height:1.3">ğŸ’¡</span>
            <div>
              <div style="color:#e5c07b;font-weight:700;font-size:12px;letter-spacing:0.4px;margin-bottom:4px">TIP â€” ì „ì²´í™”ë©´ ëª¨ë“œ</div>
              <div style="color:#8b949e;font-size:12px;line-height:1.65">ìš°í•˜ë‹¨ ê´€ë¦¬ë°”ì˜ <kbd style="background:#0d1117;border:1px solid #484f58;border-bottom:2px solid #30363d;border-radius:4px;padding:1px 6px;color:#c9d1d9;font-family:'Fira Code',monospace;font-size:11px">â›¶</kbd> ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì „ì²´í™”ë©´ ëª¨ë“œë¡œ ì „í™˜ë©ë‹ˆë‹¤.<br>ë”ìš± ì‹¤ê°ë‚˜ëŠ” ë°ìŠ¤í¬íƒ‘ í™˜ê²½ì„ ê²½í—˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸ–¥ï¸</div>
            </div>
          </div>

          <div style="color:#98c379;font-weight:600;margin-bottom:8px">## ë°ìŠ¤í¬íƒ‘ ì•„ì´ì½˜</div>
          <div style="display:grid;grid-template-columns:auto 1fr;gap:2px 12px;padding-left:12px;margin-bottom:22px">
            <span style="color:#61afef">README</span><span>ì´ ë„ì›€ë§ í˜ì´ì§€</span>
            <span style="color:#61afef">Terminal</span><span>í„°ë¯¸ë„ ì°½ ì—´ê¸°</span>
            <span style="color:#61afef">Dev Blog</span><span>ì „ì²´ í¬ìŠ¤íŠ¸ ë³´ê¸° (ë¸Œë¼ìš°ì € ì°½)</span>
            <span style="color:#61afef">Blogram</span><span>Instagram ìŠ¤íƒ€ì¼ ì‚¬ì§„ í”¼ë“œ</span>
            <span style="color:#61afef">Guestbook</span><span>ë°©ëª…ë¡ ì±„íŒ… / ë©”ì‹œì§€ ë‚¨ê¸°ê¸°</span>
            <span style="color:#61afef">GitHub</span><span>GitHub í”„ë¡œí•„ ìƒˆ íƒ­ìœ¼ë¡œ ì—´ê¸°</span>
          </div>

          <div style="color:#98c379;font-weight:600;margin-bottom:8px">## í„°ë¯¸ë„ ëª…ë ¹ì–´</div>
          <div style="display:grid;grid-template-columns:auto 1fr;gap:2px 12px;padding-left:12px;margin-bottom:12px">
            <span style="color:#61afef">ls <span style="color:#5c6370">[-l|-al]</span></span><span>ë””ë ‰í† ë¦¬ ëª©ë¡ <span style="color:#5c6370">(-l ìƒì„¸, -al ìˆ¨ê¹€ í¬í•¨)</span></span>
            <span style="color:#61afef">cd <span style="color:#5c6370">[name|..|~|-]</span></span><span>ë””ë ‰í† ë¦¬ ì´ë™ <span style="color:#5c6370">(..: ìƒìœ„, ~: ë£¨íŠ¸, -: ì´ì „)</span><br><span style="color:#5c6370;font-size:11px">â”” ìµœí•˜ìœ„ ì¹´í…Œê³ ë¦¬ëŠ” File Explorerì—ì„œ ìë™ìœ¼ë¡œ ì—´ë¦¼</span></span>
            <span style="color:#61afef">pwd</span><span>í˜„ì¬ ê²½ë¡œ ì¶œë ¥</span>
            <span style="color:#61afef">search &lt;ê²€ìƒ‰ì–´&gt;</span><span>í¬ìŠ¤íŠ¸ ê²€ìƒ‰</span>
            <span style="color:#61afef">about / github</span><span>ë¸”ë¡œê·¸ ì†Œê°œ / GitHub ì—´ê¸°</span>
            <span style="color:#61afef">clear / exit</span><span>í„°ë¯¸ë„ ì´ˆê¸°í™” / ë‹«ê¸°</span>
          </div>

          <div style="background:#161b22;border:1px solid #21262d;border-radius:6px;padding:10px 13px;margin-bottom:22px;font-family:'Fira Code',monospace;font-size:11.5px;line-height:1.9;color:#8b949e">
            <span style="color:#58a6ff">[doyoucode@blog ~]$</span> <span style="color:#e6edf3">cd Backend</span><br>
            <span style="color:#58a6ff">[doyoucode@blog ~/Backend]$</span> <span style="color:#e6edf3">ls</span><br>
            <span style="color:#58a6ff">â˜• Java/</span>&nbsp;&nbsp;<span style="color:#58a6ff">ğŸƒ Spring Boot/</span>&nbsp;&nbsp;<span style="color:#58a6ff">ğŸ’¾ Database/</span><br>
            <span style="color:#58a6ff">[doyoucode@blog ~/Backend]$</span> <span style="color:#e6edf3">open Spring Boot</span><br>
            <span style="color:#3fb950">ğŸŒ Opening Spring Boot ...</span>
          </div>

          <div style="color:#98c379;font-weight:600;margin-bottom:8px">## ë¸Œë¼ìš°ì € ì°½</div>
          <div style="padding-left:12px;margin-bottom:22px">
            <div>ë“œë˜ê·¸ë¡œ ì´ë™ / ëª¨ì„œë¦¬ë¡œ í¬ê¸° ì¡°ì ˆ</div>
            <div>ë‹«ê¸°(ë¹¨ê°•) Â· ìµœì†Œí™”(ë…¸ë‘) Â· ìµœëŒ€í™”(ì´ˆë¡)</div>
            <div>ë’¤ë¡œ Â· ì•ìœ¼ë¡œ Â· ìƒˆë¡œê³ ì¹¨ ì§€ì›</div>
          </div>

          <div style="color:#98c379;font-weight:600;margin-bottom:8px">## Blogram <span style="color:#5c6370;font-weight:400;font-size:12px">(ì¸ìŠ¤íƒ€ê·¸ë¨ ìŠ¤íƒ€ì¼ ì‚¬ì§„ í”¼ë“œ)</span></div>
          <div style="padding-left:12px;margin-bottom:22px">
            <div>ì‚¬ì§„ ì¹´í…Œê³ ë¦¬ í¬ìŠ¤íŠ¸ë¥¼ Instagram UIë¡œ ê°ìƒ</div>
            <div>í”„ë¡œí•„ í—¤ë” â€” ì•„ë°”íƒ€ Â· ê²Œì‹œë¬¼ ìˆ˜ Â· íŒ”ë¡œì›Œ Â· íŒ”ë¡œì‰</div>
            <div>3ì—´ ê·¸ë¦¬ë“œ ì¸ë„¤ì¼, ì‚¬ì§„ í´ë¦­ ì‹œ ë¼ì´íŠ¸ë°•ìŠ¤</div>
            <div>ë¼ì´íŠ¸ë°•ìŠ¤ â€” ì¢‹ì•„ìš” Â· ëŒ“ê¸€ Â· ê³µìœ  ë§í¬ ë³µì‚¬</div>
            <div>ì¢‹ì•„ìš”: ë¡œê·¸ì¸ / ë¹„ë¡œê·¸ì¸ ëª¨ë‘ ê°€ëŠ¥ (ì¿ í‚¤ ì¤‘ë³µ ë°©ì§€)</div>
            <div>ëŒ“ê¸€: ê²ŒìŠ¤íŠ¸ëŠ” ì´ë¦„ + ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í›„ ì‘ì„±</div>
            <div style="color:#5c6370">â† â†’ í‚¤ ë˜ëŠ” ë²„íŠ¼ìœ¼ë¡œ ì´ì „ / ë‹¤ìŒ ì‚¬ì§„ ì´ë™</div>
          </div>

          <div style="color:#98c379;font-weight:600;margin-bottom:8px">## Guestbook <span style="color:#5c6370;font-weight:400;font-size:12px">(ë°©ëª…ë¡ ì±„íŒ…)</span></div>
          <div style="padding-left:12px;margin-bottom:22px">
            <div>ì¹´ì¹´ì˜¤í†¡ ìŠ¤íƒ€ì¼ ì±„íŒ… ì¸í„°í˜ì´ìŠ¤</div>
            <div>ë°©ë¬¸ì ë©”ì‹œì§€ â†’ ì˜¤ë¥¸ìª½ ë…¸ë€ ë§í’ì„ </div>
            <div>ê´€ë¦¬ì ë‹µê¸€ â†’ ì™¼ìª½ í° ë§í’ì„ </div>
            <div>ì´ë¦„ + ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í›„ ë©”ì‹œì§€ ì „ì†¡</div>
            <div style="color:#5c6370">Ctrl+Enter ë¡œ ë¹ ë¥¸ ì „ì†¡</div>
          </div>

          <div style="color:#98c379;font-weight:600;margin-bottom:8px">## ê´€ë¦¬ì ë©”ë‰´ <span style="color:#5c6370;font-weight:400;font-size:12px">(ë©”ì¸í™”ë©´ ìš°í•˜ë‹¨)</span></div>
          <div style="display:grid;grid-template-columns:auto 1fr;gap:2px 12px;padding-left:12px">
            <span style="color:#61afef">ê¸€ì“°ê¸°</span><span>ìƒˆ í¬ìŠ¤íŠ¸ ì‘ì„±</span>
            <span style="color:#61afef">ê´€ë¦¬</span><span>Tistory ê´€ë¦¬ í˜ì´ì§€</span>
          </div>

        </div>
      </div>
      <div class="dyo-brs-handle n"  data-dir="n"></div>
      <div class="dyo-brs-handle ne" data-dir="ne"></div>
      <div class="dyo-brs-handle e"  data-dir="e"></div>
      <div class="dyo-brs-handle se" data-dir="se"></div>
      <div class="dyo-brs-handle s"  data-dir="s"></div>
      <div class="dyo-brs-handle sw" data-dir="sw"></div>
      <div class="dyo-brs-handle w"  data-dir="w"></div>
      <div class="dyo-brs-handle nw" data-dir="nw"></div>
    </div>

    <!-- Guestbook ì±„íŒ…ì°½ -->
    <div class="dyo-shell-win" id="dyoGuestWin">
      <div class="dyo-shell-titlebar" id="dyoGuestTitlebar">
        <span class="dyo-term-dot red"    id="dyoGuestClose" title="ë‹«ê¸°"></span>
        <span class="dyo-term-dot yellow" id="dyoGuestMin"   title="ìµœì†Œí™”"></span>
        <span class="dyo-term-dot green"  id="dyoGuestMax"   title="ìµœëŒ€í™”"></span>
        <span class="dyo-shell-title">Guestbook</span>
      </div>
      <div class="dyo-guest-kakaohdr">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" fill="#3b1e08" opacity="0.6"/></svg>
        <span>ë°©ëª…ë¡</span>
        <button class="dyo-guest-reload" id="dyoGuestReload" title="ìƒˆë¡œê³ ì¹¨">â†º</button>
      </div>
      <div class="dyo-guest-body" id="dyoGuestBody">
        <div class="dyo-guest-loading" id="dyoGuestLoading">
          <div class="dyo-guest-spinner"></div>
          <span>ë°©ëª…ë¡ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span>
        </div>
        <div class="dyo-guest-chat" id="dyoGuestChat" style="display:none"></div>
      </div>
      <div class="dyo-guest-footer" id="dyoGuestFooter">
        <div class="dyo-guest-meta" id="dyoGuestMeta">
          <input type="text"     class="dyo-guest-finput" id="dyoGuestIName" placeholder="ì´ë¦„" maxlength="20" autocomplete="off">
          <input type="password" class="dyo-guest-finput" id="dyoGuestIPw"   placeholder="ë¹„ë°€ë²ˆí˜¸" maxlength="40" autocomplete="off">
        </div>
        <div class="dyo-guest-compose">
          <textarea class="dyo-guest-textarea" id="dyoGuestTextarea" placeholder="ë°©ëª…ë¡ì„ ë‚¨ê²¨ë³´ì„¸ìš”â€¦" maxlength="500" rows="2"></textarea>
          <button class="dyo-guest-sendbtn" id="dyoGuestSend" title="ì „ì†¡ (Ctrl+Enter)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
          </button>
        </div>
      </div>
      <div class="dyo-brs-handle n"  data-dir="n"></div>
      <div class="dyo-brs-handle ne" data-dir="ne"></div>
      <div class="dyo-brs-handle e"  data-dir="e"></div>
      <div class="dyo-brs-handle se" data-dir="se"></div>
      <div class="dyo-brs-handle s"  data-dir="s"></div>
      <div class="dyo-brs-handle sw" data-dir="sw"></div>
      <div class="dyo-brs-handle w"  data-dir="w"></div>
      <div class="dyo-brs-handle nw" data-dir="nw"></div>
    </div>

    <!-- ê´€ë¦¬ì ë¹ ë¥¸ ë©”ë‰´ë°” -->
    <div class="dyo-admin-bar">
      <a href="/manage/newpost/?type=post&returnURL=%2Fmanage%2Fposts%2F" class="dyo-admin-btn" title="ê¸€ì“°ê¸°">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
        </svg>
      </a>
      <a href="/manage" class="dyo-admin-btn" title="ê´€ë¦¬">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="3"/>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
        </svg>
      </a>
      <div class="dyo-admin-sep"></div>
      <button class="dyo-admin-btn" id="btnFullscreen" title="ì „ì²´í™”ë©´">
        <!-- ì „ì²´í™”ë©´ ì§„ì… ì•„ì´ì½˜ -->
        <svg id="fsIconExpand" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>
        </svg>
        <!-- ì „ì²´í™”ë©´ ì¢…ë£Œ ì•„ì´ì½˜ (ìˆ¨ê¹€) -->
        <svg id="fsIconCompress" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none">
          <path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"/>
        </svg>
      </button>
    </div>

    <!-- ì™¸ë¶€ ë§í¬ í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ -->
    <div class="dyo-confirm-overlay" id="dyoConfirmOverlay">
      <div class="dyo-confirm-box">
        <div class="dyo-confirm-icon">ğŸ”—</div>
        <div class="dyo-confirm-msg">ì™¸ë¶€ ë§í¬ë¡œ ì´ë™í•©ë‹ˆë‹¤.<br>ìƒˆ íƒ­ì—ì„œ ì—¬ì‹œê² ìŠµë‹ˆê¹Œ?</div>
        <div class="dyo-confirm-url" id="dyoConfirmUrl"></div>
        <div class="dyo-confirm-btns">
          <button class="dyo-confirm-cancel" id="dyoConfirmCancel">ì·¨ì†Œ</button>
          <button class="dyo-confirm-ok" id="dyoConfirmOk">ìƒˆ íƒ­ìœ¼ë¡œ ì—´ê¸° â†’</button>
        </div>
      </div>
    </div>

    <!-- ìš°í´ë¦­ ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ (JSë¡œ ë™ì  ìƒì„±) -->
    <div class="dyo-ctx-menu" id="dyoCtxMenu"></div>

    <!-- File Explorer Window -->
    <div class="dyo-shell-win dyo-explorer-win" id="dyoExplorerWin" style="width:580px;height:400px;top:80px;left:180px;">
      <div class="dyo-brs-handle n"></div><div class="dyo-brs-handle ne"></div>
      <div class="dyo-brs-handle e"></div><div class="dyo-brs-handle se"></div>
      <div class="dyo-brs-handle s"></div><div class="dyo-brs-handle sw"></div>
      <div class="dyo-brs-handle w"></div><div class="dyo-brs-handle nw"></div>
      <div class="dyo-shell-titlebar" id="dyoExplorerTitlebar">
        <span class="dyo-term-dot red"    id="dyoExplorerClose" title="Close"></span>
        <span class="dyo-term-dot yellow" id="dyoExplorerMin"   title="Minimize"></span>
        <span class="dyo-term-dot green"  id="dyoExplorerMax"   title="Maximize"></span>
        <span class="dyo-shell-title">ğŸ“‚ File Explorer</span>
      </div>
      <div class="dyo-explorer-navbar" id="dyoExplorerNavbar">
        <button class="dyo-exp-navbtn" id="dyoExpBack" disabled title="ë’¤ë¡œê°€ê¸°">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
        </button>
        <button class="dyo-exp-navbtn" id="dyoExpForward" disabled title="ì•ìœ¼ë¡œê°€ê¸°">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
        </button>
        <div class="dyo-exp-addrbar" id="dyoExpAddrBar"></div>
        <div class="dyo-exp-view-btns">
          <button class="dyo-exp-viewbtn active" id="dyoExpViewGrid" title="Grid ë·°">
            <svg width="13" height="13" viewBox="0 0 24 24" fill="currentColor"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
          </button>
          <button class="dyo-exp-viewbtn" id="dyoExpViewList" title="List ë·°">
            <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"><line x1="9" y1="6" x2="21" y2="6"/><line x1="9" y1="12" x2="21" y2="12"/><line x1="9" y1="18" x2="21" y2="18"/><circle cx="4" cy="6" r="1.5" fill="currentColor" stroke="none"/><circle cx="4" cy="12" r="1.5" fill="currentColor" stroke="none"/><circle cx="4" cy="18" r="1.5" fill="currentColor" stroke="none"/></svg>
          </button>
        </div>
      </div>
      <div class="dyo-explorer-body">
        <div class="dyo-explorer-sidebar" id="dyoExplorerTree"></div>
        <div class="dyo-explorer-main" id="dyoExplorerMain"></div>
      </div>
    </div>

    <!-- Properties Window -->
    <div class="dyo-shell-win dyo-props-win" id="dyoPropsWin" style="width:360px;height:480px;top:100px;left:420px;">
      <div class="dyo-brs-handle n"></div><div class="dyo-brs-handle ne"></div>
      <div class="dyo-brs-handle e"></div><div class="dyo-brs-handle se"></div>
      <div class="dyo-brs-handle s"></div><div class="dyo-brs-handle sw"></div>
      <div class="dyo-brs-handle w"></div><div class="dyo-brs-handle nw"></div>
      <div class="dyo-shell-titlebar" id="dyoPropsTitlebar">
        <span class="dyo-term-dot red"    id="dyoPropsClose" title="Close"></span>
        <span class="dyo-term-dot yellow" id="dyoPropsMin"   title="Minimize"></span>
        <span class="dyo-term-dot green"  id="dyoPropsMax"   title="Maximize"></span>
        <span class="dyo-shell-title" id="dyoPropsTitle">Properties</span>
      </div>
      <div class="dyo-props-body" id="dyoPropsBody"></div>
    </div>

    <!-- Blogram ì°½ -->
    <div class="dyo-shell-win dyo-gallery-win" id="dyoGalleryWin">
      <div class="dyo-brs-handle n"></div><div class="dyo-brs-handle ne"></div>
      <div class="dyo-brs-handle e"></div><div class="dyo-brs-handle se"></div>
      <div class="dyo-brs-handle s"></div><div class="dyo-brs-handle sw"></div>
      <div class="dyo-brs-handle w"></div><div class="dyo-brs-handle nw"></div>
      <div class="dyo-shell-titlebar" id="dyoGalleryTitlebar">
        <span class="dyo-term-dot red"    id="dyoGalleryClose" title="ë‹«ê¸°"></span>
        <span class="dyo-term-dot yellow" id="dyoGalleryMin"   title="ìµœì†Œí™”"></span>
        <span class="dyo-term-dot green"  id="dyoGalleryMax"   title="ìµœëŒ€í™”"></span>
        <span class="dyo-shell-title">ğŸ“· Blogram</span>
      </div>
      <div class="dyo-gallery-toolbar" id="dyoGalleryToolbar">
        <span class="dyo-gallery-status" id="dyoGalleryStatus"></span>
      </div>
      <div class="dyo-gallery-body" id="dyoGalleryBody">
        <!-- Instagram í”„ë¡œí•„ í—¤ë” -->
        <div class="dyo-gallery-profile" id="dyoGalleryProfile">
          <div class="dyo-gp-avatar-ring">
            <img class="dyo-gp-avatar-img" src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2Fdcw74H%2FdJMcacCdDz7%2FAAAAAAAAAAAAAAAAAAAAADsp14QhaXFHW-MrLGX64kxBD-4ExyawRyxn5bwMsN05%2Fimg.jpg%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1774969199%26allow_ip%3D%26allow_referer%3D%26signature%3D2Wpl5e4o6CQ3Th%252BrrBkwoYobc7E%253D" alt="í”„ë¡œí•„">
          </div>
          <div class="dyo-gp-info">
            <div class="dyo-gp-uname">doyoucode</div>
            <div class="dyo-gp-stats">
              <span class="dyo-gp-stat"><strong id="dyoGpPostCount">â€”</strong> ê²Œì‹œë¬¼</span>
              <span class="dyo-gp-stat"><strong>42</strong> íŒ”ë¡œì›Œ</span>
              <span class="dyo-gp-stat"><strong>42</strong> íŒ”ë¡œì‰</span>
            </div>
            <div class="dyo-gp-bio">ğŸ“· ì‚¬ì§„ê³¼ ì¼ìƒì„ ê¸°ë¡í•©ë‹ˆë‹¤</div>
          </div>
        </div>
        <!-- íƒ­ ë°” -->
        <div class="dyo-gp-tabs">
          <button class="dyo-gp-tab dyo-gp-tab-active">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><rect x="2" y="2" width="9" height="9" rx="1"/><rect x="13" y="2" width="9" height="9" rx="1"/><rect x="2" y="13" width="9" height="9" rx="1"/><rect x="13" y="13" width="9" height="9" rx="1"/></svg>
            ê²Œì‹œë¬¼
          </button>
        </div>
        <div class="dyo-gallery-grid" id="dyoGalleryGrid"></div>
        <div class="dyo-gallery-empty" id="dyoGalleryEmpty" style="display:none">
          <span style="font-size:32px">ğŸ“·</span>
          <span>ì•„ì§ ë“±ë¡ëœ ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤</span>
          <span style="font-size:11px;color:#484f58">index.htmlì˜ GALLERY_POSTS ë°°ì—´ì— ì¶”ê°€í•˜ì„¸ìš”</span>
        </div>
      </div>
    </div>

    <!-- Gallery Lightbox â€” Instagram Style -->
    <div class="dyo-lightbox" id="dyoLightbox">
      <div class="dyo-lb-bg" id="dyoLbBg"></div>
      <button class="dyo-lb-close" id="dyoLbClose">âœ•</button>

      <div class="dyo-lb-modal">
        <!-- ì™¼ìª½: ì‚¬ì§„ + ì´ì „/ë‹¤ìŒ -->
        <div class="dyo-lb-photo-side">
          <button class="dyo-lb-nav dyo-lb-prev" id="dyoLbPrev">&#8249;</button>
          <img class="dyo-lb-img" id="dyoLbImg" src="" alt="">
          <button class="dyo-lb-nav dyo-lb-next" id="dyoLbNext">&#8250;</button>
        </div>

        <!-- ì˜¤ë¥¸ìª½: Instagram ì‚¬ì´ë“œë°” -->
        <div class="dyo-lb-ig-side">
          <!-- í—¤ë”: ì‘ì„±ì + í–„ë²„ê±° -->
          <div class="dyo-lb-ig-header">
            <div class="dyo-lb-ig-profile">
              <div class="dyo-lb-ig-avatar"></div>
              <span class="dyo-lb-ig-username">doyoucode</span>
            </div>
            <div class="dyo-lb-ig-menu-wrap" id="dyoLbMenuWrap">
              <button class="dyo-lb-ig-menu-btn" id="dyoLbMenuBtn" title="ë”ë³´ê¸°">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><circle cx="5" cy="12" r="2"/><circle cx="12" cy="12" r="2"/><circle cx="19" cy="12" r="2"/></svg>
              </button>
              <div class="dyo-lb-ig-dropdown" id="dyoLbDropdown">
                <a class="dyo-lb-ig-dd-item" id="dyoLbPostLink" href="#" target="_blank">í¬ìŠ¤íŠ¸ ë³´ê¸°</a>
                <button class="dyo-lb-ig-dd-item" id="dyoLbCopyLink">ë§í¬ ë³µì‚¬</button>
              </div>
            </div>
          </div>
          <div class="dyo-lb-ig-divider"></div>

          <!-- ìº¡ì…˜ + ëŒ“ê¸€ ì˜ì—­ -->
          <div class="dyo-lb-ig-scroll" id="dyoLbScroll">
            <div class="dyo-lb-ig-caption">
              <div class="dyo-lb-ig-avatar-sm"></div>
              <div class="dyo-lb-ig-caption-text">
                <span class="dyo-lb-ig-uname">doyoucode</span>
                <span id="dyoLbTitle"></span>
              </div>
            </div>
            <div class="dyo-lb-ig-cmt-stub" id="dyoLbCmtStub">
              <!-- ëŒ“ê¸€ ê°œìˆ˜ ë¡œë“œ í›„ í‘œì‹œ -->
            </div>
          </div>
          <div class="dyo-lb-ig-divider"></div>

          <!-- ì•¡ì…˜ ë°”: ì¢‹ì•„ìš” / ëŒ“ê¸€ / ê³µìœ  -->
          <div class="dyo-lb-ig-actions">
            <div class="dyo-lb-ig-action-row">
              <button class="dyo-lb-ig-btn dyo-lb-ig-like-btn" id="dyoLbLikeBtn" title="ì¢‹ì•„ìš”">
                <svg class="dyo-lb-heart-outline" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
                <svg class="dyo-lb-heart-filled" width="24" height="24" viewBox="0 0 24 24" fill="#ed4956" stroke="#ed4956" stroke-width="2" stroke-linejoin="round" style="display:none"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
              </button>
              <button class="dyo-lb-ig-btn dyo-lb-ig-cmt-btn" id="dyoLbCmtBtn" title="ëŒ“ê¸€ ë‹¬ê¸°">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
              </button>
              <button class="dyo-lb-ig-btn dyo-lb-ig-share-btn" id="dyoLbShareBtn" title="ê³µìœ ">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
              </button>
            </div>
            <div class="dyo-lb-ig-likes-line" id="dyoLbLikesLine">ì¢‹ì•„ìš” 0ê°œ</div>
            <div class="dyo-lb-ig-date-line" id="dyoLbDate"></div>
            <div class="dyo-lb-ig-counter" id="dyoLbCounter"></div>
          </div>
          <div class="dyo-lb-ig-divider"></div>

          <!-- ëŒ“ê¸€ ì…ë ¥ í¼ -->
          <div class="dyo-lb-ig-compose">
            <div class="dyo-lb-ig-compose-meta">
              <input class="dyo-lb-ig-meta-inp" id="dyoLbCmtName" type="text" placeholder="ì´ë¦„" maxlength="40" autocomplete="nickname">
              <input class="dyo-lb-ig-meta-inp" id="dyoLbCmtPw"   type="password" placeholder="ë¹„ë°€ë²ˆí˜¸" maxlength="60" autocomplete="current-password">
            </div>
            <div class="dyo-lb-ig-compose-row">
              <div class="dyo-lb-ig-avatar-sm"></div>
              <input class="dyo-lb-ig-cmt-input" id="dyoLbCmtInput" type="text" placeholder="ëŒ“ê¸€ ë‹¬ê¸°...">
              <button class="dyo-lb-ig-cmt-submit" id="dyoLbCmtSubmit" disabled>ê²Œì‹œ</button>
            </div>
          </div>
        </div>
      </div>
    </div>

  </s_t3>
  <script src="./images/script.js"></script>
  <script>
    // íƒ€ì´í•‘ ì• ë‹ˆë©”ì´ì…˜
    (function() {
      var el = document.getElementById('typingText');
      if (!el) return;

      var text = 'Do You Coding?';
      var i = 0;
      var deleting = false;
      var typeSpeed = 120;
      var deleteSpeed = 80;
      var pauseAfterType = 2000;
      var pauseAfterDelete = 800;

      function tick() {
        if (!deleting) {
          el.textContent = text.substring(0, i + 1);
          i++;
          if (i === text.length) {
            deleting = true;
            setTimeout(tick, pauseAfterType);
          } else {
            setTimeout(tick, typeSpeed);
          }
        } else {
          i--;
          el.textContent = text.substring(0, i);
          if (i === 0) {
            deleting = false;
            setTimeout(tick, pauseAfterDelete);
          } else {
            setTimeout(tick, deleteSpeed);
          }
        }
      }

      setTimeout(tick, 1000);
    })();

    // í™ˆ(ì¸ë±ìŠ¤) í˜ì´ì§€ - ë°ìŠ¤í¬íƒ‘ í™ˆí™”ë©´ í‘œì‹œ
    (function() {
      if (document.body.id !== 'tt-body-index') return;

      var desktop = document.getElementById('dyoDesktop');
      if (!desktop) return;

      // ë°ìŠ¤í¬íƒ‘ í‘œì‹œ + ë°”ë”” ìŠ¤í¬ë¡¤ ì ê¸ˆ
      desktop.classList.add('show');
      document.body.style.overflow = 'hidden';

      // ì‹œê³„ ì—…ë°ì´íŠ¸
      function updateClock() {
        var now = new Date();
        var hh = String(now.getHours()).padStart(2, '0');
        var mm = String(now.getMinutes()).padStart(2, '0');
        var yyyy = now.getFullYear();
        var mo = String(now.getMonth() + 1).padStart(2, '0');
        var dd = String(now.getDate()).padStart(2, '0');
        var clockEl = document.getElementById('desktopClock');
        var dateEl  = document.getElementById('desktopDate');
        if (clockEl) clockEl.textContent = hh + ':' + mm;
        if (dateEl)  dateEl.textContent  = yyyy + '/' + mo + '/' + dd;
      }
      updateClock();
      setInterval(updateClock, 1000);

      // README ì•„ì´ì½˜ í´ë¦­
      var iconReadme = document.getElementById('desktopIconReadme');
      if (iconReadme) {
        iconReadme.addEventListener('click', function() {
          window._dyoAnimSrc = this;
          if (window.dyoOpenReadme) window.dyoOpenReadme();
        });
      }

      // Terminal ì•„ì´ì½˜ í´ë¦­ â†’ í„°ë¯¸ë„ ì°½ ì—´ê¸°
      var iconShell = document.getElementById('desktopIconShell');
      if (iconShell) {
        iconShell.addEventListener('click', function() {
          window._dyoAnimSrc = this;
          if (window.dyoOpenShell) window.dyoOpenShell();
        });
      }

      // Blog ì•„ì´ì½˜ í´ë¦­ â†’ ì „ì²´ê¸€ë³´ê¸° ì°½ìœ¼ë¡œ ì—´ê¸°
      var iconBlog = document.getElementById('desktopIconBlog');
      if (iconBlog) {
        iconBlog.addEventListener('click', function() {
          window._dyoAnimSrc = this;
          if (window.dyoOpenBrowser) window.dyoOpenBrowser('/category');
        });
      }

      // Guestbook ì•„ì´ì½˜ í´ë¦­ â†’ ì±„íŒ…ì°½ ì—´ê¸°
      var iconGuest = document.getElementById('desktopIconGuest');
      if (iconGuest) {
        iconGuest.addEventListener('click', function() {
          window._dyoAnimSrc = this;
          if (window.dyoOpenGuest) window.dyoOpenGuest();
        });
      }

      // GitHub ì•„ì´ì½˜ í´ë¦­ â†’ ì™¸ë¶€ ë§í¬ í™•ì¸ í›„ ìƒˆ íƒ­ìœ¼ë¡œ ì—´ê¸°
      var iconGithub = document.getElementById('desktopIconGithub');
      if (iconGithub) {
        iconGithub.addEventListener('click', function() {
          if (window.dyoOpenExternal) window.dyoOpenExternal('https://github.com/doyoungkim-code');
        });
      }

      // File Explorer ì•„ì´ì½˜ í´ë¦­
      var iconExplorer = document.getElementById('desktopIconExplorer');
      if (iconExplorer) {
        iconExplorer.addEventListener('click', function() {
          window._dyoAnimSrc = this;
          if (window.dyoOpenExplorer) window.dyoOpenExplorer();
        });
      }

      // Blogram ì•„ì´ì½˜ í´ë¦­
      var iconGallery = document.getElementById('desktopIconGallery');
      if (iconGallery) {
        iconGallery.addEventListener('click', function() {
          window._dyoAnimSrc = this;
          if (window.dyoOpenGallery) window.dyoOpenGallery();
        });
      }

    })();

    // ê²Œì‹œê¸€ ëª©ì°¨(TOC) ìë™ ìƒì„±
    (function() {
      var view = document.getElementById('article-view');
      if (!view) return;
      var bodyId = document.body.id;
      if (bodyId !== 'tt-body-page') return;

      var headings = view.querySelectorAll('h2, h3');
      if (headings.length < 2) return;

      var toc = document.createElement('div');
      toc.className = 'toc-wrapper';

      var title = document.createElement('div');
      title.className = 'toc-title';
      title.innerHTML = 'Table of Contents <span class="toc-toggle">&#9660;</span>';
      title.addEventListener('click', function() {
        toc.classList.toggle('collapsed');
      });

      var list = document.createElement('ul');
      list.className = 'toc-list';

      headings.forEach(function(h, i) {
        var id = 'toc-heading-' + i;
        h.id = id;
        var li = document.createElement('li');
        li.className = 'toc-' + h.tagName.toLowerCase();
        var a = document.createElement('a');
        a.href = '#' + id;
        a.textContent = h.textContent;
        li.appendChild(a);
        list.appendChild(li);
      });

      toc.appendChild(title);
      toc.appendChild(list);
      view.insertBefore(toc, view.firstChild);
    })();

    // ì½”ë“œë¸”ëŸ­: highlight.js ì ìš© + ì–¸ì–´ ê°ì§€ + ë³µì‚¬ ë²„íŠ¼ + wrapper
    (function() {
      var view = document.getElementById('article-view');
      if (!view) return;

      // highlight.js ì‹¤í–‰ (Tistory data-ke-language ì§€ì›)
      if (typeof hljs !== 'undefined') {
        view.querySelectorAll('pre code').forEach(function(codeEl) {
          var pre = codeEl.parentElement;
          var keLang = pre && pre.getAttribute('data-ke-language');
          if (keLang && !codeEl.classList.contains('hljs')) {
            codeEl.className = 'language-' + keLang.toLowerCase();
          }
          if (!codeEl.classList.contains('hljs')) {
            hljs.highlightElement(codeEl);
          }
        });
        // code ì—†ì´ preë§Œ ìˆëŠ” ê²½ìš°
        view.querySelectorAll('pre').forEach(function(pre) {
          if (!pre.querySelector('code')) {
            var code = document.createElement('code');
            code.textContent = pre.textContent;
            var keLang = pre.getAttribute('data-ke-language');
            if (keLang) code.className = 'language-' + keLang.toLowerCase();
            pre.textContent = '';
            pre.appendChild(code);
            hljs.highlightElement(code);
          }
        });
      }

      // ì–¸ì–´ ê°ì§€ ë§µ: classëª… â†’ í‘œì‹œ ì´ë¦„
      var langMap = {
        'java': 'Java', 'python': 'Python', 'py': 'Python',
        'javascript': 'JavaScript', 'js': 'JavaScript',
        'typescript': 'TypeScript', 'ts': 'TypeScript',
        'html': 'HTML', 'css': 'CSS', 'scss': 'SCSS',
        'json': 'JSON', 'xml': 'XML', 'yaml': 'YAML', 'yml': 'YAML',
        'sql': 'SQL', 'bash': 'Bash', 'sh': 'Shell', 'shell': 'Shell',
        'c': 'C', 'cpp': 'C++', 'csharp': 'C#', 'cs': 'C#',
        'go': 'Go', 'rust': 'Rust', 'ruby': 'Ruby', 'rb': 'Ruby',
        'php': 'PHP', 'swift': 'Swift', 'kotlin': 'Kotlin', 'kt': 'Kotlin',
        'dart': 'Dart', 'scala': 'Scala', 'r': 'R',
        'markdown': 'Markdown', 'md': 'Markdown',
        'dockerfile': 'Dockerfile', 'docker': 'Docker',
        'groovy': 'Groovy', 'gradle': 'Gradle',
        'properties': 'Properties', 'ini': 'INI', 'toml': 'TOML',
        'plaintext': 'Text', 'text': 'Text'
      };

      // ì–¸ì–´ ìƒ‰ìƒ ë§µ
      var langColors = {
        'Java': '#b07219', 'Python': '#3572A5', 'JavaScript': '#f1e05a',
        'TypeScript': '#3178c6', 'HTML': '#e34c26', 'CSS': '#563d7c',
        'JSON': '#292929', 'SQL': '#e38c00', 'Bash': '#89e051',
        'Shell': '#89e051', 'C': '#555555', 'C++': '#f34b7d',
        'C#': '#178600', 'Go': '#00ADD8', 'Rust': '#dea584',
        'Ruby': '#701516', 'PHP': '#4F5D95', 'Swift': '#F05138',
        'Kotlin': '#A97BFF', 'Dart': '#00B4AB', 'Scala': '#c22d40',
        'Dockerfile': '#384d54', 'Groovy': '#4298b8', 'Gradle': '#02303A',
        'SCSS': '#c6538c', 'XML': '#0060ac', 'YAML': '#cb171e',
        'Markdown': '#083fa1'
      };

      // ì½”ë“œ ë‚´ìš©ìœ¼ë¡œ ì–¸ì–´ ì¶”ì¸¡
      function guessLang(code) {
        if (/public\s+(static\s+)?void\s+main|System\.out\.print|import\s+java\.|@(Override|Autowired|Service|Controller|Repository|Entity|Component)/.test(code)) return 'Java';
        if (/from\s+\w+\s+import|def\s+\w+\s*\(|print\s*\(|if\s+__name__/.test(code)) return 'Python';
        if (/console\.\w+\(|=>\s*\{|const\s+\w+\s*=|let\s+\w+\s*=|require\s*\(|module\.exports/.test(code)) return 'JavaScript';
        if (/interface\s+\w+|:\s*(string|number|boolean)\b|<\w+>/.test(code) && /const\s+|let\s+|=>\s*/.test(code)) return 'TypeScript';
        if (/<\/?[a-z][\s\S]*>/i.test(code) && /<(div|span|html|head|body|p|a|img|ul|li|table|form)\b/i.test(code)) return 'HTML';
        if (/\{[\s\S]*?[\w-]+\s*:\s*[\w#][\s\S]*?\}/.test(code) && /(color|margin|padding|display|font-size|background)\s*:/.test(code)) return 'CSS';
        if (/^\s*(SELECT|INSERT|UPDATE|DELETE|CREATE|ALTER|DROP|FROM|WHERE)\b/im.test(code)) return 'SQL';
        if (/^(#!\/?bin\/|apt-get|sudo|echo|grep|chmod|mkdir|cd\s|ls\s|curl\s|wget\s)/m.test(code)) return 'Bash';
        if (/^\s*\{[\s\S]*"[\w]+":\s*/m.test(code)) return 'JSON';
        if (/^\s*<\?xml|<\/?\w+:\w+/m.test(code)) return 'XML';
        if (/^(FROM|RUN|CMD|EXPOSE|COPY|ADD|ENTRYPOINT|WORKDIR)\s/m.test(code)) return 'Dockerfile';
        if (/^(spring|server|logging)\.\w+\s*=/m.test(code)) return 'Properties';
        if (/func\s+\w+|package\s+main|fmt\.Print/.test(code)) return 'Go';
        if (/fn\s+\w+|let\s+mut\s|println!\(|use\s+std::/.test(code)) return 'Rust';
        return '';
      }

      var pres = view.querySelectorAll('pre');
      pres.forEach(function(pre) {
        if (pre.closest('.code-block-wrapper')) return;

        var codeEl = pre.querySelector('code');
        var lang = '';

        // 1. classì—ì„œ ì–¸ì–´ ê°ì§€
        if (codeEl) {
          var cls = (codeEl.className || '') + ' ' + (pre.className || '');
          var m = cls.match(/(?:language-|lang-|hljs\s+)(\w+)/);
          if (m && langMap[m[1].toLowerCase()]) {
            lang = langMap[m[1].toLowerCase()];
          }
        }
        // 2. data-ke-language (Tistory ì—ë””í„°)
        if (!lang && pre.getAttribute('data-ke-language')) {
          var keLang = pre.getAttribute('data-ke-language').toLowerCase();
          if (langMap[keLang]) lang = langMap[keLang];
        }
        // 3. ì½”ë“œ ë‚´ìš©ìœ¼ë¡œ ì¶”ì¸¡
        if (!lang) {
          var codeText = (codeEl || pre).textContent || '';
          lang = guessLang(codeText);
        }

        var dotColor = (lang && langColors[lang]) ? langColors[lang] : '#8b949e';
        var displayLang = lang || 'Code';

        // wrapper ìƒì„±
        var wrapper = document.createElement('div');
        wrapper.className = 'code-block-wrapper';

        // header
        var header = document.createElement('div');
        header.className = 'code-block-header';
        header.innerHTML =
          '<span class="code-lang-label">' +
            '<span class="code-lang-dot" style="background:' + dotColor + ';"></span>' +
            displayLang +
          '</span>' +
          '<button type="button" class="code-copy-btn">' +
            '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>' +
            '<span>Copy</span>' +
          '</button>';

        // ë³µì‚¬ ê¸°ëŠ¥
        var btn = header.querySelector('.code-copy-btn');
        btn.addEventListener('click', function() {
          var text = (codeEl || pre).textContent;
          navigator.clipboard.writeText(text).then(function() {
            btn.classList.add('copied');
            btn.querySelector('span').textContent = 'Copied!';
            btn.querySelector('svg').innerHTML = '<polyline points="20 6 9 17 4 12"></polyline>';
            setTimeout(function() {
              btn.classList.remove('copied');
              btn.querySelector('span').textContent = 'Copy';
              btn.querySelector('svg').innerHTML = '<rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>';
            }, 2000);
          });
        });

        pre.parentNode.insertBefore(wrapper, pre);
        wrapper.appendChild(header);
        wrapper.appendChild(pre);
      });
    })();

    // ìŠ¤í¬ë¡¤ ì§„í–‰ë°” + ë§¨ ìœ„ë¡œ ê°€ê¸° ë²„íŠ¼
    (function() {
      var progressBar = document.getElementById('scrollProgress');
      var btnTop = document.getElementById('btnScrollTop');
      if (!progressBar || !btnTop) return;

      // ê²Œì‹œê¸€ í˜ì´ì§€ì—ì„œë§Œ ì§„í–‰ë°” í‘œì‹œ
      var isArticle = document.body.id === 'tt-body-page';

      window.addEventListener('scroll', function() {
        var scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        var docHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;

        // ì§„í–‰ë°”
        if (isArticle && docHeight > 0) {
          var progress = (scrollTop / docHeight) * 100;
          progressBar.style.width = progress + '%';
        }

        // ë§¨ ìœ„ë¡œ ë²„íŠ¼: 300px ì´ìƒ ìŠ¤í¬ë¡¤ ì‹œ í‘œì‹œ
        if (scrollTop > 300) {
          btnTop.classList.add('visible');
        } else {
          btnTop.classList.remove('visible');
        }
      });

      btnTop.addEventListener('click', function() {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });
    })();

    // ============================================================
    // ê°€ìƒ í„°ë¯¸ë„ ì°½ (ë“œë˜ê·¸ ê°€ëŠ¥, ìµœì†Œí™”/ìµœëŒ€í™”)
    // ============================================================
    (function() {
      var win      = document.getElementById('dyoShellWin');
      var btnShell = document.getElementById('btnShell');
      var titlebar = document.getElementById('dyoShellTitlebar');
      var closeBtn = document.getElementById('dyoShellClose');
      var minBtn   = document.getElementById('dyoShellMin');
      var maxBtn   = document.getElementById('dyoShellMax');
      var termInput= document.getElementById('termInput');
      var output   = document.getElementById('termOutput');
      var form     = document.getElementById('dyoTermForm');
      if (!win || !btnShell) return;

      var history = [], histIdx = -1;
      var dragging = false, dragOX = 0, dragOY = 0;
      var resizing = false, resizeDir = '', resizeSX = 0, resizeSY = 0, resizeSRect = null;
      var MIN_W = 360, MIN_H = 180;
      // ìµœëŒ€í™” ì „ ì €ì¥ìš©
      var savedPos = null;

      // ê°€ìƒ íŒŒì¼ì‹œìŠ¤í…œ (File Explorerì™€ ë™ì¼í•œ íŠ¸ë¦¬)
      var FS = { label: '~', icon: 'ğŸ“‚', url: '/category', children: [
        { label: 'Project', icon: 'ğŸ“‚', url: '/category/Project', children: [
          { label: 'Dev Log',    icon: 'ğŸ“', url: '/category/Project/Dev%20Log' },
          { label: 'Retrospect', icon: 'ğŸ“', url: '/category/Project/Retrospect' }
        ]},
        { label: 'Backend', icon: 'â˜•', url: '/category/Backend', children: [
          { label: 'Java',        icon: 'â˜•', url: '/category/Backend/Java' },
          { label: 'Spring Boot', icon: 'ğŸƒ', url: '/category/Backend/Spring%20Boot' },
          { label: 'Database',    icon: 'ğŸ’¾', url: '/category/Backend/Database' }
        ]},
        { label: 'Frontend', icon: 'ğŸ¨', url: '/category/Frontend', children: [
          { label: 'Mobile', icon: 'ğŸ“±', url: '/category/Frontend/Mobile' },
          { label: 'Web',    icon: 'ğŸŒ', url: '/category/Frontend/Web' }
        ]},
        { label: 'CS & Engineering', icon: 'ğŸ’»', url: '/category/CS%20&%20Engineering', children: [
          { label: 'C',                icon: 'ğŸ“—', url: '/category/CS%20&%20Engineering/C' },
          { label: 'Algorithm',        icon: 'ğŸ“', url: '/category/CS%20&%20Engineering/Algorithm' },
          { label: 'Computer Science', icon: 'ğŸ“š', url: '/category/CS%20&%20Engineering/Computer%20Science' },
          { label: 'Infra & Tools',    icon: 'ğŸ§±', url: '/category/CS%20&%20Engineering/Infra%20&%20Tools' }
        ]},
        { label: 'Growth', icon: 'ğŸŒ±', url: '/category/Growth', children: [
          { label: 'Certifications', icon: 'ğŸ“œ', url: '/category/Growth/Certifications' },
          { label: 'English',        icon: 'ğŸ“–', url: '/category/Growth/English' },
          { label: 'Books',          icon: 'ğŸ“š', url: '/category/Growth/Books' },
          { label: 'Documents',      icon: 'ğŸ“‘', url: '/category/Growth/Documents' },
          { label: 'etc',            icon: 'ğŸ“„', url: '/category/Growth/etc' }
        ]}
      ]};
      var cwdPath     = [FS]; // í˜„ì¬ ê²½ë¡œ (ë…¸ë“œ ë°°ì—´, root = [FS])
      var prevCwdPath = null; // cd - ìš© ì´ì „ ê²½ë¡œ

      function esc(t) { return t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

      function getCwdNode() { return cwdPath[cwdPath.length - 1]; }
      function getCwdStr() {
        if (cwdPath.length === 1) return '~';
        return '~/' + cwdPath.slice(1).map(function(n){ return n.label; }).join('/');
      }
      function updatePrompt() {
        var el = document.getElementById('dyoTermPrompt');
        if (el) el.innerHTML = '[doyoucode@blog&nbsp;<span style="color:#58a6ff;font-weight:600">' + getCwdStr() + '</span>]$&nbsp;';
      }

      function addOutput(cmd, html) {
        var block = document.createElement('div');
        block.className = 'dyo-output-block';
        var pStr = '[doyoucode@blog&nbsp;<span style="color:#58a6ff">' + getCwdStr() + '</span>]$';
        block.innerHTML =
          '<div class="dyo-output-cmd-line">' +
            '<span class="dyo-output-prompt">' + pStr + '</span> ' +
            '<span class="dyo-output-cmd">' + esc(cmd) + '</span>' +
          '</div>' +
          (html ? '<div class="dyo-output-result">' + html + '</div>' : '');
        output.insertBefore(block, form);
        output.scrollTop = output.scrollHeight;
      }

      var BANNER = 'â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\nâ•‘  Welcome to doyoucode\'s terminal       â•‘\nâ•‘  Type \'<span class="tr-cmd">help</span>\' to see available commands â•‘\nâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•';

      // â”€â”€ ë¸Œë¼ìš°ì € ì°½ ì—´ê¸° (iframe) â”€â”€
      function launchBrowser(url) {
        if (window.dyoOpenBrowser) window.dyoOpenBrowser(url);
      }

      function processCmd(raw) {
        var cmd = raw.trim();
        if (!cmd) return;
        history.push(cmd); histIdx = history.length;

        var parts = cmd.split(/\s+/);
        var base = parts[0].toLowerCase();
        var arg  = parts.slice(1).join(' ');

        switch (base) {
          case 'help':
            addOutput(cmd,
              '<span class="tr-info">Available commands:</span><br><br>' +
              '<span style="color:#8b949e">â”€â”€ Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br>' +
              '<span class="tr-cmd">ls</span> <span style="color:#5c6370">[-l|-al]</span>          â€” ë””ë ‰í† ë¦¬ ëª©ë¡ <span style="color:#5c6370">(-l ìƒì„¸, -al ìˆ¨ê¹€ í¬í•¨)</span><br>' +
              '<span class="tr-cmd">cd</span> <span style="color:#5c6370">[name|..|~|-]</span>   â€” ë””ë ‰í† ë¦¬ ì´ë™ <span style="color:#5c6370">(..: ìƒìœ„, ~: ë£¨íŠ¸, -: ì´ì „)</span><br>' +
              '<span style="color:#5c6370;padding-left:20px;font-size:11px">â”” ìµœí•˜ìœ„ ì¹´í…Œê³ ë¦¬ëŠ” cd ì‹œ File Explorerì—ì„œ ìë™ìœ¼ë¡œ ì—´ë¦¼</span><br>' +
              '<span class="tr-cmd">pwd</span>                 â€” í˜„ì¬ ê²½ë¡œ ì¶œë ¥<br>' +
              '<br><span style="color:#8b949e">â”€â”€ Etc â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br>' +
              '<span class="tr-cmd">about</span> / <span class="tr-cmd">whoami</span>   â€” ë¸”ë¡œê·¸ ì†Œê°œ<br>' +
              '<span class="tr-cmd">search &lt;keyword&gt;</span>   â€” ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ê²€ìƒ‰<br>' +
              '<span class="tr-cmd">date</span>                â€” í˜„ì¬ ë‚ ì§œ ë° ì‹œê°„<br>' +
              '<span class="tr-cmd">echo &lt;text&gt;</span>        â€” í…ìŠ¤íŠ¸ ì¶œë ¥<br>' +
              '<span class="tr-cmd">github</span>              â€” GitHub í”„ë¡œí•„ ì—´ê¸°<br>' +
              '<span class="tr-cmd">clear</span>               â€” í„°ë¯¸ë„ í™”ë©´ ì§€ìš°ê¸°<br>' +
              '<span class="tr-cmd">exit</span>                â€” í„°ë¯¸ë„ ë‹«ê¸°<br>' +
              '<br><span style="color:#5c6370">ğŸ’¡ <kbd style="background:#21262d;border:1px solid #30363d;border-radius:3px;padding:0 4px">Tab</kbd> ìë™ì™„ì„± | <kbd style="background:#21262d;border:1px solid #30363d;border-radius:3px;padding:0 4px">â†‘â†“</kbd> íˆìŠ¤í† ë¦¬</span>'
            ); break;

          case 'about': case 'whoami':
            addOutput(cmd,
              '<span class="tr-success"><b>doyoucode</b></span> â€” Backend Developer<br>' +
              'í”„ë¡œê·¸ë˜ë°ì´ ì¼ìƒì´ ëœ ê°œë°œì ê¿ˆë‚˜ë¬´ì˜ ê¸°ë¡ ê³µê°„<br>' +
              '<span style="color:#5c6370">ì½”ë”© ê³µë¶€ë¥¼ í•˜ë©° ë§ˆì£¼ì¹œ ì‹œí–‰ì°©ì˜¤ì™€ í•´ê²° ê³¼ì •ì„ ì •ë¦¬í•˜ë©° ì„±ì¥ ì¤‘</span>'
            ); break;

          case 'ls': {
            var lsFlags = parts.slice(1).filter(function(p){ return p.startsWith('-'); }).join('');
            var lsLong  = lsFlags.indexOf('l') !== -1;
            var lsAll   = lsFlags.indexOf('a') !== -1;
            var lsNode  = getCwdNode();
            var lsKids  = lsNode.children || [];
            var lsNow   = new Date();
            var lsMon   = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'][lsNow.getMonth()];
            var lsDay   = String(lsNow.getDate()).padStart(2,' ');
            var lsTime  = String(lsNow.getHours()).padStart(2,'0') + ':' + String(lsNow.getMinutes()).padStart(2,'0');
            var lsDate  = lsMon + ' ' + lsDay + ' ' + lsTime;
            if (lsLong) {
              var lsH = '<pre style="margin:0;font-family:var(--font-mono);line-height:1.6">';
              lsH += '<span style="color:#8b949e">total ' + (lsKids.length + (lsAll ? 2 : 0)) + '</span>\n';
              if (lsAll) {
                lsH += '<span style="color:#484f58">drwxr-xr-x</span> <span style="color:#8b949e">doyoucode blog ' + lsDate + '</span> <span style="color:#58a6ff">ğŸ“‚ .</span>\n';
                lsH += '<span style="color:#484f58">drwxr-xr-x</span> <span style="color:#8b949e">doyoucode root ' + lsDate + '</span> <span style="color:#58a6ff">ğŸ“‚ ..</span>\n';
              }
              lsKids.forEach(function(c) {
                var isDir  = c.children && c.children.length;
                var perm   = isDir ? 'drwxr-xr-x' : '-rw-r--r--';
                var nColor = isDir ? '#58a6ff' : '#e6edf3';
                lsH += '<span style="color:#484f58">' + perm + '</span> ';
                lsH += '<span style="color:#8b949e">doyoucode blog ' + lsDate + '</span> ';
                lsH += '<span style="color:' + nColor + '">' + c.icon + ' ' + esc(c.label) + (isDir ? '/' : '') + '</span>\n';
              });
              lsH += '</pre>';
              if (!lsKids.length && !lsAll) lsH = '<span style="color:#8b949e">total 0</span><br><span style="color:#5c6370">(í•˜ìœ„ ë””ë ‰í† ë¦¬ ì—†ìŒ) â€” <span class="tr-cmd">cd ..</span> ë¡œ ìƒìœ„ë¡œ ì´ë™í•˜ì„¸ìš”.</span>';
              addOutput(cmd, lsH);
            } else {
              if (!lsKids.length) {
                addOutput(cmd, '<span style="color:#8b949e">(í•˜ìœ„ ë””ë ‰í† ë¦¬ ì—†ìŒ)</span><br><span style="color:#5c6370"><span class="tr-cmd">cd ..</span> ë¡œ ìƒìœ„ë¡œ ì´ë™í•˜ì„¸ìš”.</span>');
              } else {
                var lsH2 = '';
                lsKids.forEach(function(c) {
                  var isDir  = c.children && c.children.length;
                  var nColor = isDir ? '#58a6ff' : '#e6edf3';
                  lsH2 += '<span style="color:' + nColor + ';margin-right:18px">' + c.icon + '&nbsp;' + esc(c.label) + (isDir ? '/' : '') + '</span>';
                });
                addOutput(cmd, lsH2);
              }
            }
            break;
          }

          case 'cd': {
            var cdArg  = arg.replace(/^['"]|['"]$/g,'').trim();
            var cdPrev = cwdPath.slice();
            if (!cdArg || cdArg === '~') {
              // cd ë˜ëŠ” cd ~ â†’ root
              addOutput(cmd, '');
              prevCwdPath = cdPrev;
              cwdPath = [FS];
              updatePrompt();
            } else if (cdArg === '-') {
              // cd - â†’ ì´ì „ ìœ„ì¹˜
              if (!prevCwdPath) {
                addOutput(cmd, '<span class="tr-error">bash: cd: OLDPWD not set</span>');
              } else {
                // ìƒˆ ê²½ë¡œ ë¬¸ìì—´ì„ ë¯¸ë¦¬ ê³„ì‚° í›„, addOutputì€ cwdPath ë³€ê²½ ì „ì— í˜¸ì¶œ (í”„ë¡¬í”„íŠ¸ = í˜„ì¬ ìœ„ì¹˜)
                var cdNewStr = prevCwdPath.length === 1 ? '~' : '~/' + prevCwdPath.slice(1).map(function(n){ return n.label; }).join('/');
                addOutput(cmd, '<span style="color:#8b949e">' + cdNewStr + '</span>');
                var cdTmp = cwdPath.slice();
                cwdPath = prevCwdPath;
                prevCwdPath = cdTmp;
                updatePrompt();
              }
            } else if (cdArg === '.') {
              // cd . â†’ í˜„ì¬ ìœ„ì¹˜ ìœ ì§€
              addOutput(cmd, '');
            } else if (cdArg === '..') {
              // cd .. â†’ ìƒìœ„ë¡œ
              if (cwdPath.length <= 1) {
                addOutput(cmd, '');
              } else {
                addOutput(cmd, '');
                prevCwdPath = cdPrev;
                cwdPath = cwdPath.slice(0, -1);
                updatePrompt();
              }
            } else {
              // ì´ë¦„ìœ¼ë¡œ ìì‹ ê²€ìƒ‰ (ëŒ€ì†Œë¬¸ì ë¬´ì‹œ)
              var cdCur    = getCwdNode();
              var cdTarget = null;
              if (cdCur.children) {
                for (var ci = 0; ci < cdCur.children.length; ci++) {
                  if (cdCur.children[ci].label.toLowerCase() === cdArg.toLowerCase()) {
                    cdTarget = cdCur.children[ci]; break;
                  }
                }
              }
              if (cdTarget) {
                if (!cdTarget.children || !cdTarget.children.length) {
                  // ìµœí•˜ìœ„ ì¹´í…Œê³ ë¦¬ â†’ ë¸Œë¼ìš°ì €ì—ì„œ ì—´ê³  í˜„ì¬ ìœ„ì¹˜ ìœ ì§€
                  addOutput(cmd, '<span class="tr-success">ğŸŒ ' + esc(cdTarget.label) + ' ì„(ë¥¼) ë¸Œë¼ìš°ì €ì—ì„œ ì—´ê¸°...</span>');
                  launchBrowser(cdTarget.url);
                } else {
                  addOutput(cmd, '');
                  prevCwdPath = cdPrev;
                  cwdPath = cwdPath.concat([cdTarget]);
                  updatePrompt();
                }
              } else {
                var cdSugg = [];
                if (cdCur.children) {
                  cdCur.children.forEach(function(c) {
                    if (c.label.toLowerCase().indexOf(cdArg.toLowerCase()) !== -1) cdSugg.push(esc(c.label));
                  });
                }
                var cdMsg = '<span class="tr-error">bash: cd: ' + esc(cdArg) + ': No such file or directory</span>';
                if (cdSugg.length) cdMsg += '<br><span class="tr-warn">í˜¹ì‹œ ì´ í•­ëª©ì„ ì°¾ìœ¼ì‹œë‚˜ìš”? ' + cdSugg.join(', ') + '</span>';
                addOutput(cmd, cdMsg);
              }
            }
            break;
          }

          case 'pwd':
            var pwdFull = '/home/doyoucode/blog';
            if (cwdPath.length > 1) pwdFull += '/' + cwdPath.slice(1).map(function(n){ return n.label; }).join('/');
            addOutput(cmd, '<span class="tr-default">' + esc(pwdFull) + '</span>'); break;

          case 'search': case 'grep':
            if (!arg) { addOutput(cmd,'<span class="tr-warn">Usage: search &lt;keyword&gt;</span>'); break; }
            addOutput(cmd,'<span class="tr-success">ğŸ” Searching for "'+esc(arg)+'" ...</span>');
            launchBrowser('/search/'+encodeURIComponent(arg)); break;

          case 'date':
            var now = new Date();
            var ds = now.getFullYear()+'-'+String(now.getMonth()+1).padStart(2,'0')+'-'+
              String(now.getDate()).padStart(2,'0')+' '+String(now.getHours()).padStart(2,'0')+':'+
              String(now.getMinutes()).padStart(2,'0')+':'+String(now.getSeconds()).padStart(2,'0');
            addOutput(cmd,'<span class="tr-default">'+['Sun','Mon','Tue','Wed','Thu','Fri','Sat'][now.getDay()]+' '+ds+' KST</span>'); break;

          case 'echo':
            addOutput(cmd,'<span class="tr-default">'+(arg?esc(arg):'')+'</span>'); break;

          case 'clear':
            while (output.firstChild && output.firstChild !== form) {
              output.removeChild(output.firstChild);
            }
            var bannerEl = document.createElement('div');
            bannerEl.className = 'dyo-term-banner';
            bannerEl.innerHTML = BANNER;
            output.insertBefore(bannerEl, form);
            output.scrollTop = 0;
            return;

          case 'github':
            addOutput(cmd,'<span class="tr-success">ğŸš€ Opening GitHub ...</span>');
            setTimeout(function(){ if (window.dyoOpenExternal) window.dyoOpenExternal('https://github.com/doyoungkim-code'); }, 400); break;

          case 'sudo':   addOutput(cmd,'<span class="tr-error">ğŸ”’ Permission denied ğŸ˜</span>'); break;
          case 'rm':     addOutput(cmd,'<span class="tr-error">ğŸš« Not gonna happen here ğŸ˜…</span>'); break;
          case 'exit':   closeWindow(); return;
          case 'hello': case 'hi':
            addOutput(cmd,'<span class="tr-success">ğŸ‘‹ Hello! Type <span class="tr-cmd">help</span> to see what you can do.</span>'); break;

          default:
            addOutput(cmd,
              '<span class="tr-error">bash: '+esc(base)+': command not found</span><br>' +
              '<span style="color:#5c6370">Type <span class="tr-cmd">help</span> to see available commands.</span>'
            );
        }
      }

      // â”€â”€ ì°½ ì—´ê¸°/ë‹«ê¸°/ìµœì†Œí™”/ìµœëŒ€í™” â”€â”€
      function openWindow() {
        var wasOpen = win.classList.contains('open');
        if (!wasOpen) {
          var W = 680, H = 440;
          win.style.left   = Math.round((window.innerWidth  - W) / 2) + 'px';
          win.style.top    = Math.round((window.innerHeight - H) / 2) + 'px';
          win.style.right  = 'auto';
          win.style.bottom = 'auto';
        }
        win.classList.add('open');
        win.classList.remove('minimized');
        btnShell.classList.add('active');
        window._dyoZTop = (window._dyoZTop || 9000) + 1;
        win.style.zIndex = window._dyoZTop;
        if (!wasOpen && window.dyoAnimOpen) window.dyoAnimOpen(win);
        setTimeout(function() {
          termInput && termInput.focus();
          output.scrollTop = output.scrollHeight;
        }, 50);
      }
      function closeWindow() {
        if (window.dyoAnimDismiss) {
          window.dyoAnimDismiss(win, function() {
            win.classList.remove('open', 'minimized', 'maximized');
            btnShell.classList.remove('active');
            savedPos = null;
          });
        } else {
          win.classList.remove('open', 'minimized', 'maximized');
          btnShell.classList.remove('active');
          savedPos = null;
        }
      }
      function minimizeWindow() {
        if (win.classList.contains('minimized')) {
          var tb = document.querySelector('.dyo-taskbtn[data-win-id="dyoShellWin"]');
          window._dyoAnimSrc = tb || null;
          win.classList.remove('minimized');
          if (window.dyoAnimOpen) window.dyoAnimOpen(win);
          setTimeout(function(){ termInput && termInput.focus(); }, 200);
        } else {
          if (win.classList.contains('maximized')) {
            win.classList.remove('maximized');
            if (savedPos) {
              win.style.left = savedPos.left; win.style.top = savedPos.top;
              win.style.right = savedPos.right; win.style.bottom = savedPos.bottom;
              win.style.width = savedPos.width; win.style.height = savedPos.height;
              savedPos = null;
            }
          }
          if (window.dyoAnimMinimize) {
            window.dyoAnimMinimize(win, function() { win.classList.add('minimized'); });
          } else {
            win.classList.add('minimized');
          }
        }
      }
      function maximizeWindow() {
        if (win.classList.contains('maximized')) {
          win.classList.remove('maximized');
          if (savedPos) {
            win.style.left   = savedPos.left;
            win.style.top    = savedPos.top;
            win.style.right  = savedPos.right;
            win.style.bottom = savedPos.bottom;
            win.style.width  = savedPos.width;
            win.style.height = savedPos.height;
            savedPos = null;
          }
          if (window.dyoAnimMaximizeOut) window.dyoAnimMaximizeOut(win);
        } else {
          win.classList.remove('minimized');
          savedPos = {
            left: win.style.left, top: win.style.top,
            right: win.style.right, bottom: win.style.bottom,
            width: win.style.width, height: win.style.height
          };
          win.classList.add('maximized');
          win.style.left = win.style.top = win.style.right =
          win.style.bottom = win.style.width = win.style.height = '';
          if (window.dyoAnimMaximizeIn) window.dyoAnimMaximizeIn(win);
        }
        setTimeout(function(){ termInput && termInput.focus(); }, 50);
      }

      // ë°ìŠ¤í¬íƒ‘ ì•„ì´ì½˜ì—ì„œ í˜¸ì¶œí•  ìˆ˜ ìˆë„ë¡ ì „ì—­ ë…¸ì¶œ
      window.dyoOpenShell = openWindow;

      // ì°½ í¬ì»¤ìŠ¤ (z-index ìµœìƒìœ„)
      function bringToFront() {
        window._dyoZTop = (window._dyoZTop || 9000) + 1;
        win.style.zIndex = window._dyoZTop;
      }
      win.addEventListener('mousedown', bringToFront);

      btnShell.addEventListener('click', function() {
        if (win.classList.contains('open')) {
          closeWindow();
        } else {
          window._dyoAnimSrc = btnShell;
          openWindow();
        }
      });
      if (closeBtn) closeBtn.addEventListener('click', closeWindow);
      if (minBtn)   minBtn.addEventListener('click',   minimizeWindow);
      if (maxBtn)   maxBtn.addEventListener('click',   maximizeWindow);


      // â”€â”€ ë“œë˜ê·¸ â”€â”€
      titlebar.addEventListener('dblclick', function(e) {
        if (e.target === closeBtn || e.target === minBtn || e.target === maxBtn) return;
        maximizeWindow();
      });

      titlebar.addEventListener('mousedown', function(e) {
        if (win.classList.contains('maximized')) return;
        if (e.target === minBtn || e.target === maxBtn || e.target === closeBtn) return;
        var rect = win.getBoundingClientRect();
        // ì¸ë¼ì¸ left/top ì¢Œí‘œë¡œ ì „í™˜
        win.style.left   = rect.left + 'px';
        win.style.top    = rect.top  + 'px';
        win.style.right  = 'auto';
        win.style.bottom = 'auto';
        dragging = true;
        dragOX = e.clientX - rect.left;
        dragOY = e.clientY - rect.top;
        e.preventDefault();
      });

      document.addEventListener('mousemove', function(e) {
        if (dragging) {
          var x = Math.max(0, Math.min(window.innerWidth  - win.offsetWidth,  e.clientX - dragOX));
          var y = Math.max(0, Math.min(window.innerHeight - 40, e.clientY - dragOY));
          win.style.left = x + 'px';
          win.style.top  = y + 'px';
        }
        if (resizing) {
          var dx = e.clientX - resizeSX;
          var dy = e.clientY - resizeSY;
          var r = resizeSRect;
          var newL = r.left, newT = r.top, newW = r.width, newH = r.height;
          if (resizeDir.indexOf('e') !== -1) newW = Math.max(MIN_W, r.width + dx);
          if (resizeDir.indexOf('s') !== -1) newH = Math.max(MIN_H, r.height + dy);
          if (resizeDir.indexOf('w') !== -1) { newW = Math.max(MIN_W, r.width - dx); newL = r.left + r.width - newW; }
          if (resizeDir.indexOf('n') !== -1) { newH = Math.max(MIN_H, r.height - dy); newT = r.top + r.height - newH; }
          win.style.left   = newL + 'px';
          win.style.top    = newT + 'px';
          win.style.width  = newW + 'px';
          win.style.height = newH + 'px';
        }
      });

      document.addEventListener('mouseup', function() {
        dragging = false;
        resizing = false;
      });

      // â”€â”€ ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ â”€â”€
      win.querySelectorAll('.dyo-brs-handle').forEach(function(handle) {
        handle.addEventListener('mousedown', function(e) {
          if (win.classList.contains('maximized') || win.classList.contains('minimized')) return;
          e.stopPropagation();
          e.preventDefault();
          resizing = true;
          resizeDir = handle.getAttribute('data-dir');
          resizeSX = e.clientX;
          resizeSY = e.clientY;
          var rect = win.getBoundingClientRect();
          resizeSRect = { left: rect.left, top: rect.top, width: rect.width, height: rect.height };
          win.style.left   = rect.left   + 'px';
          win.style.top    = rect.top    + 'px';
          win.style.width  = rect.width  + 'px';
          win.style.height = rect.height + 'px';
          win.style.right  = 'auto';
          win.style.bottom = 'auto';
        });
      });

      // í„°ì¹˜ ë“œë˜ê·¸ (ëª¨ë°”ì¼)
      titlebar.addEventListener('touchstart', function(e) {
        if (win.classList.contains('maximized')) return;
        var t = e.touches[0];
        var rect = win.getBoundingClientRect();
        win.style.left   = rect.left + 'px';
        win.style.top    = rect.top  + 'px';
        win.style.right  = 'auto';
        win.style.bottom = 'auto';
        dragging = true;
        dragOX = t.clientX - rect.left;
        dragOY = t.clientY - rect.top;
      }, { passive: true });

      document.addEventListener('touchmove', function(e) {
        if (!dragging) return;
        var t = e.touches[0];
        var x = Math.max(0, Math.min(window.innerWidth  - win.offsetWidth,  t.clientX - dragOX));
        var y = Math.max(0, Math.min(window.innerHeight - 40, t.clientY - dragOY));
        win.style.left = x + 'px';
        win.style.top  = y + 'px';
      }, { passive: true });

      document.addEventListener('touchend', function() { dragging = false; });

      // â”€â”€ ì…ë ¥ ì´ë²¤íŠ¸ â”€â”€
      // Enter: form submit (ê°€ì¥ ì•ˆì •ì ì¸ í¬ë¡œìŠ¤-ë¸Œë¼ìš°ì € ë°©ì‹)
      if (form) {
        form.addEventListener('submit', function(e) {
          e.preventDefault();
          if (!termInput) return;
          processCmd(termInput.value);
          termInput.value = '';
          termInput.focus();
        });
      }

      // í™”ì‚´í‘œí‚¤(íˆìŠ¤í† ë¦¬) + Tab(ìë™ì™„ì„±)ë§Œ keydownìœ¼ë¡œ ì²˜ë¦¬
      if (termInput) {
        termInput.addEventListener('keydown', function(e) {
          if (e.key === 'ArrowUp' || e.keyCode === 38) {
            e.preventDefault();
            if (histIdx > 0) termInput.value = history[--histIdx];
          } else if (e.key === 'ArrowDown' || e.keyCode === 40) {
            e.preventDefault();
            termInput.value = histIdx < history.length-1 ? history[++histIdx] : (histIdx=history.length,'');
          } else if (e.key === 'Tab' || e.keyCode === 9) {
            e.preventDefault();
            var val = termInput.value;
            var valTrim = val.trim().toLowerCase();
            var cmds = ['help','about','whoami','ls','cd','pwd','search','grep','date','echo','clear','github','exit'];
            if (!val.trim().includes(' ')) {
              var tm = cmds.filter(function(c){ return c.startsWith(valTrim); });
              if (tm.length === 1) termInput.value = tm[0] + ' ';
            } else {
              // cd/open ì´í›„ ìì‹ ì´ë¦„ ìë™ì™„ì„±
              var spIdx = val.indexOf(' ');
              var tabCmd = val.slice(0, spIdx).toLowerCase();
              var tabArg = val.slice(spIdx + 1).toLowerCase();
              if (tabCmd === 'cd') {
                var tabKids = (getCwdNode().children || []).map(function(c){ return c.label; });
                var tabM = tabKids.filter(function(n){ return n.toLowerCase().startsWith(tabArg); });
                if (tabM.length === 1) termInput.value = tabCmd + ' ' + tabM[0];
                else if (tabM.length > 1) {
                  addOutput(val.trim(), tabM.map(function(n){ return '<span style="color:#58a6ff">' + esc(n) + '</span>'; }).join('  '));
                }
              }
            }
          }
        });
      }

      if (output) {
        output.addEventListener('click', function(e) {
          if (e.target.tagName !== 'A') termInput && termInput.focus();
        });
      }
    })();

    // ============================================================
    // ê°€ìƒ ë¸Œë¼ìš°ì € ì°½ (ë“œë˜ê·¸ ê°€ëŠ¥, ìµœì†Œí™”/ìµœëŒ€í™”/ë‹«ê¸°)
    // ============================================================
    (function() {
      var bwin     = document.getElementById('dyoBrowserWin');
      var btbar    = document.getElementById('dyoBrowserTitlebar');
      var bClose   = document.getElementById('dyoBrowserClose');
      var bMin     = document.getElementById('dyoBrowserMin');
      var bMax     = document.getElementById('dyoBrowserMax');
      var bBack    = document.getElementById('dyoBrowserBack');
      var bFwd     = document.getElementById('dyoBrowserFwd');
      var bReload  = document.getElementById('dyoBrowserReload');
      var bUrlBar  = document.getElementById('dyoBrowserUrl');
      var bFrame   = document.getElementById('dyoBrowserFrame');
      if (!bwin || !bFrame || !bUrlBar) return;
      window._dyoBWin = bwin;
      window._dyoBFrame = bFrame;
      window._dyoBUrlBar = bUrlBar;

      var dragging = false, dragOX = 0, dragOY = 0;
      var resizing = false, resizeDir = '', resizeSX = 0, resizeSY = 0, resizeSRect = null;
      var savedPos = null;
      var MIN_W = 360, MIN_H = 200;

      function openBrowser(url) {
        var fullUrl = url.startsWith('http') ? url : (window.location.origin + url);
        bFrame.src = fullUrl;
        bUrlBar.textContent = window.location.hostname + (url.startsWith('/') ? url : '/' + url);
        var wasOpen = bwin.classList.contains('open');
        if (!wasOpen) {
          var W = Math.min(1200, window.innerWidth  - 40);
          var H = Math.min(700,  window.innerHeight - 40);
          bwin.style.width  = W + 'px';
          bwin.style.height = H + 'px';
          bwin.style.left   = Math.round((window.innerWidth  - W) / 2) + 'px';
          bwin.style.top    = Math.round((window.innerHeight - H) / 2) + 'px';
          bwin.style.right  = 'auto';
          bwin.style.bottom = 'auto';
        }
        bwin.classList.add('open');
        bwin.classList.remove('minimized');
        window._dyoZTop = (window._dyoZTop || 9000) + 1;
        bwin.style.zIndex = window._dyoZTop;
        if (!wasOpen && window.dyoAnimOpen) window.dyoAnimOpen(bwin);
      }

      function closeBrowser() {
        if (window.dyoAnimDismiss) {
          window.dyoAnimDismiss(bwin, function() {
            bwin.classList.remove('open', 'minimized', 'maximized');
            bFrame.src = 'about:blank';
            bUrlBar.textContent = 'about:blank';
            savedPos = null;
          });
        } else {
          bwin.classList.remove('open', 'minimized', 'maximized');
          bFrame.src = 'about:blank';
          bUrlBar.textContent = 'about:blank';
          savedPos = null;
        }
      }

      function minimizeBrowser() {
        if (bwin.classList.contains('minimized')) {
          var tb = document.querySelector('.dyo-taskbtn[data-win-id="dyoBrowserWin"]');
          window._dyoAnimSrc = tb || null;
          bwin.classList.remove('minimized');
          if (window.dyoAnimOpen) window.dyoAnimOpen(bwin);
        } else {
          if (window.dyoAnimMinimize) {
            window.dyoAnimMinimize(bwin, function() { bwin.classList.add('minimized'); });
          } else {
            bwin.classList.add('minimized');
          }
        }
      }

      function maximizeBrowser() {
        if (bwin.classList.contains('maximized')) {
          bwin.classList.remove('maximized');
          if (savedPos) {
            bwin.style.left   = savedPos.left;
            bwin.style.top    = savedPos.top;
            bwin.style.right  = savedPos.right;
            bwin.style.bottom = savedPos.bottom;
            bwin.style.width  = savedPos.width;
            bwin.style.height = savedPos.height;
            savedPos = null;
          }
          if (window.dyoAnimMaximizeOut) window.dyoAnimMaximizeOut(bwin);
        } else {
          bwin.classList.remove('minimized');
          savedPos = {
            left: bwin.style.left, top: bwin.style.top,
            right: bwin.style.right, bottom: bwin.style.bottom,
            width: bwin.style.width, height: bwin.style.height
          };
          bwin.classList.add('maximized');
          bwin.style.left = bwin.style.top = bwin.style.right =
          bwin.style.bottom = bwin.style.width = bwin.style.height = '';
          if (window.dyoAnimMaximizeIn) window.dyoAnimMaximizeIn(bwin);
        }
      }

      // URL ì—…ë°ì´íŠ¸ (iframe ë‚´ í˜ì´ì§€ ì´ë™ ê°ì§€)
      bFrame.addEventListener('load', function() {
        try {
          var loc = bFrame.contentWindow.location.href;
          if (loc && loc !== 'about:blank' && loc !== 'about:srcdoc') {
            bUrlBar.textContent = loc.replace(/^https?:\/\//, '');
          }
        } catch(e) { /* cross-origin: ë¬´ì‹œ */ }
      });

      // ì „ì—­ ë…¸ì¶œ
      window.dyoOpenBrowser = openBrowser;

      // ì°½ í¬ì»¤ìŠ¤ (z-index ìµœìƒìœ„)
      function bringToFront() {
        window._dyoZTop = (window._dyoZTop || 9000) + 1;
        bwin.style.zIndex = window._dyoZTop;
      }
      bwin.addEventListener('mousedown', bringToFront);

      if (bClose)  bClose.addEventListener('click',  closeBrowser);
      if (bMin)    bMin.addEventListener('click',    minimizeBrowser);
      if (bMax)    bMax.addEventListener('click',    maximizeBrowser);
      if (bBack)   bBack.addEventListener('click',   function() { try { bFrame.contentWindow.history.back(); } catch(e){} });
      if (bFwd)    bFwd.addEventListener('click',    function() { try { bFrame.contentWindow.history.forward(); } catch(e){} });
      if (bReload) bReload.addEventListener('click', function() { try { bFrame.contentWindow.location.reload(); } catch(e){ bFrame.src = bFrame.src; } });

      // ë”ë¸”í´ë¦­ íƒ€ì´í‹€ë°” â†’ ìµœëŒ€í™” í† ê¸€
      btbar.addEventListener('dblclick', function(e) {
        if (e.target === bClose || e.target === bMin || e.target === bMax) return;
        maximizeBrowser();
      });

      // ë“œë˜ê·¸ (ë§ˆìš°ìŠ¤)
      btbar.addEventListener('mousedown', function(e) {
        if (bwin.classList.contains('maximized')) return;
        if (e.target === bClose || e.target === bMin || e.target === bMax) return;
        var rect = bwin.getBoundingClientRect();
        bwin.style.left   = rect.left + 'px';
        bwin.style.top    = rect.top  + 'px';
        bwin.style.right  = 'auto';
        bwin.style.bottom = 'auto';
        dragging = true;
        dragOX = e.clientX - rect.left;
        dragOY = e.clientY - rect.top;
        bFrame.style.pointerEvents = 'none';
        e.preventDefault();
      });

      document.addEventListener('mousemove', function(e) {
        if (dragging) {
          var x = Math.max(0, Math.min(window.innerWidth  - bwin.offsetWidth,  e.clientX - dragOX));
          var y = Math.max(0, Math.min(window.innerHeight - 40, e.clientY - dragOY));
          bwin.style.left = x + 'px';
          bwin.style.top  = y + 'px';
        }
        if (resizing) {
          var dx = e.clientX - resizeSX;
          var dy = e.clientY - resizeSY;
          var r = resizeSRect;
          var newL = r.left, newT = r.top, newW = r.width, newH = r.height;
          if (resizeDir.indexOf('e') !== -1) newW = Math.max(MIN_W, r.width + dx);
          if (resizeDir.indexOf('s') !== -1) newH = Math.max(MIN_H, r.height + dy);
          if (resizeDir.indexOf('w') !== -1) { newW = Math.max(MIN_W, r.width - dx); newL = r.left + r.width - newW; }
          if (resizeDir.indexOf('n') !== -1) { newH = Math.max(MIN_H, r.height - dy); newT = r.top + r.height - newH; }
          bwin.style.left   = newL + 'px';
          bwin.style.top    = newT + 'px';
          bwin.style.width  = newW + 'px';
          bwin.style.height = newH + 'px';
        }
      });

      document.addEventListener('mouseup', function() {
        if (dragging || resizing) bFrame.style.pointerEvents = '';
        dragging = false;
        resizing = false;
      });

      // ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ (ë§ˆìš°ìŠ¤)
      bwin.querySelectorAll('.dyo-brs-handle').forEach(function(handle) {
        handle.addEventListener('mousedown', function(e) {
          if (bwin.classList.contains('maximized') || bwin.classList.contains('minimized')) return;
          e.stopPropagation();
          e.preventDefault();
          resizing = true;
          resizeDir = handle.getAttribute('data-dir');
          resizeSX = e.clientX;
          resizeSY = e.clientY;
          var rect = bwin.getBoundingClientRect();
          resizeSRect = { left: rect.left, top: rect.top, width: rect.width, height: rect.height };
          bwin.style.left   = rect.left   + 'px';
          bwin.style.top    = rect.top    + 'px';
          bwin.style.width  = rect.width  + 'px';
          bwin.style.height = rect.height + 'px';
          bwin.style.right  = 'auto';
          bwin.style.bottom = 'auto';
          bFrame.style.pointerEvents = 'none';
        });
      });

      // ë“œë˜ê·¸ (í„°ì¹˜)
      btbar.addEventListener('touchstart', function(e) {
        if (bwin.classList.contains('maximized')) return;
        var t = e.touches[0];
        var rect = bwin.getBoundingClientRect();
        bwin.style.left   = rect.left + 'px';
        bwin.style.top    = rect.top  + 'px';
        bwin.style.right  = 'auto';
        bwin.style.bottom = 'auto';
        dragging = true;
        dragOX = t.clientX - rect.left;
        dragOY = t.clientY - rect.top;
      }, { passive: true });

      document.addEventListener('touchmove', function(e) {
        if (!dragging) return;
        var t = e.touches[0];
        var x = Math.max(0, Math.min(window.innerWidth  - bwin.offsetWidth,  t.clientX - dragOX));
        var y = Math.max(0, Math.min(window.innerHeight - 40, t.clientY - dragOY));
        bwin.style.left = x + 'px';
        bwin.style.top  = y + 'px';
      }, { passive: true });

      document.addEventListener('touchend', function() { dragging = false; });
    })();
  </script>

  <script>
    (function() {
      var w        = document.getElementById('dyoReadmeWin');
      var titlebar = document.getElementById('dyoReadmeTitlebar');
      var closeBtn = document.getElementById('dyoReadmeClose');
      var minBtn   = document.getElementById('dyoReadmeMin');
      var maxBtn   = document.getElementById('dyoReadmeMax');
      if (!w) return;

      var dragging = false, dragOX = 0, dragOY = 0;
      var resizing = false, resizeDir = '', resizeSX = 0, resizeSY = 0, resizeSRect = null;
      var MIN_W = 360, MIN_H = 180;
      var savedPos = null;

      function openReadme() {
        var wasOpen = w.classList.contains('open');
        if (!wasOpen) {
          var W = Math.min(700, window.innerWidth  - 40);
          var H = Math.min(480, window.innerHeight - 40);
          w.style.width  = W + 'px';
          w.style.height = H + 'px';
          w.style.left   = Math.round((window.innerWidth  - W) / 2) + 'px';
          w.style.top    = Math.round((window.innerHeight - H) / 2) + 'px';
          w.style.right  = 'auto';
          w.style.bottom = 'auto';
        }
        w.classList.add('open');
        w.classList.remove('minimized');
        window._dyoZTop = (window._dyoZTop || 9000) + 1;
        w.style.zIndex = window._dyoZTop;
        if (!wasOpen && window.dyoAnimOpen) window.dyoAnimOpen(w);
      }
      function closeReadme() {
        if (window.dyoAnimDismiss) {
          window.dyoAnimDismiss(w, function() {
            w.classList.remove('open', 'minimized', 'maximized');
            savedPos = null;
          });
        } else {
          w.classList.remove('open', 'minimized', 'maximized');
          savedPos = null;
        }
      }
      function minimizeReadme() {
        if (w.classList.contains('minimized')) {
          var tb = document.querySelector('.dyo-taskbtn[data-win-id="dyoReadmeWin"]');
          window._dyoAnimSrc = tb || null;
          w.classList.remove('minimized');
          if (window.dyoAnimOpen) window.dyoAnimOpen(w);
        } else {
          if (w.classList.contains('maximized')) {
            w.classList.remove('maximized');
            if (savedPos) {
              w.style.left = savedPos.left; w.style.top = savedPos.top;
              w.style.right = savedPos.right; w.style.bottom = savedPos.bottom;
              w.style.width = savedPos.width; w.style.height = savedPos.height;
              savedPos = null;
            }
          }
          if (window.dyoAnimMinimize) {
            window.dyoAnimMinimize(w, function() { w.classList.add('minimized'); });
          } else {
            w.classList.add('minimized');
          }
        }
      }
      function maximizeReadme() {
        if (w.classList.contains('maximized')) {
          w.classList.remove('maximized');
          if (savedPos) {
            w.style.left   = savedPos.left;
            w.style.top    = savedPos.top;
            w.style.right  = savedPos.right;
            w.style.bottom = savedPos.bottom;
            w.style.width  = savedPos.width;
            w.style.height = savedPos.height;
            savedPos = null;
          }
          if (window.dyoAnimMaximizeOut) window.dyoAnimMaximizeOut(w);
        } else {
          w.classList.remove('minimized');
          savedPos = {
            left: w.style.left, top: w.style.top,
            right: w.style.right, bottom: w.style.bottom,
            width: w.style.width, height: w.style.height
          };
          w.classList.add('maximized');
          w.style.left = w.style.top = w.style.right =
          w.style.bottom = w.style.width = w.style.height = '';
          if (window.dyoAnimMaximizeIn) window.dyoAnimMaximizeIn(w);
        }
      }

      window.dyoOpenReadme = openReadme;

      w.addEventListener('mousedown', function() {
        window._dyoZTop = (window._dyoZTop || 9000) + 1;
        w.style.zIndex = window._dyoZTop;
      });
      if (closeBtn) closeBtn.addEventListener('click', closeReadme);
      if (minBtn)   minBtn.addEventListener('click',   minimizeReadme);
      if (maxBtn)   maxBtn.addEventListener('click',   maximizeReadme);

      // íƒ€ì´í‹€ë°” ë”ë¸”í´ë¦­ â†’ ìµœëŒ€í™” í† ê¸€
      if (titlebar) {
        titlebar.addEventListener('dblclick', function(e) {
          if (e.target === closeBtn || e.target === minBtn || e.target === maxBtn) return;
          maximizeReadme();
        });

        // ë“œë˜ê·¸
        titlebar.addEventListener('mousedown', function(e) {
          if (w.classList.contains('maximized')) return;
          if (e.target === closeBtn || e.target === minBtn || e.target === maxBtn) return;
          var rect = w.getBoundingClientRect();
          w.style.left = rect.left + 'px'; w.style.top = rect.top + 'px';
          w.style.right = 'auto'; w.style.bottom = 'auto';
          dragging = true;
          dragOX = e.clientX - rect.left;
          dragOY = e.clientY - rect.top;
          e.preventDefault();
        });

        // í„°ì¹˜ ë“œë˜ê·¸
        titlebar.addEventListener('touchstart', function(e) {
          if (w.classList.contains('maximized')) return;
          var t = e.touches[0];
          var rect = w.getBoundingClientRect();
          w.style.left = rect.left + 'px'; w.style.top = rect.top + 'px';
          w.style.right = 'auto'; w.style.bottom = 'auto';
          dragging = true;
          dragOX = t.clientX - rect.left;
          dragOY = t.clientY - rect.top;
        }, { passive: true });
      }

      document.addEventListener('mousemove', function(e) {
        if (dragging) {
          var x = Math.max(0, Math.min(window.innerWidth  - w.offsetWidth,  e.clientX - dragOX));
          var y = Math.max(0, Math.min(window.innerHeight - 40, e.clientY - dragOY));
          w.style.left = x + 'px'; w.style.top = y + 'px';
        }
        if (resizing) {
          var dx = e.clientX - resizeSX;
          var dy = e.clientY - resizeSY;
          var r = resizeSRect;
          var nL = r.left, nT = r.top, nW = r.width, nH = r.height;
          if (resizeDir.indexOf('e') !== -1) nW = Math.max(MIN_W, r.width + dx);
          if (resizeDir.indexOf('s') !== -1) nH = Math.max(MIN_H, r.height + dy);
          if (resizeDir.indexOf('w') !== -1) { nW = Math.max(MIN_W, r.width - dx); nL = r.left + r.width - nW; }
          if (resizeDir.indexOf('n') !== -1) { nH = Math.max(MIN_H, r.height - dy); nT = r.top + r.height - nH; }
          w.style.left = nL + 'px'; w.style.top = nT + 'px';
          w.style.width = nW + 'px'; w.style.height = nH + 'px';
        }
      });
      document.addEventListener('touchmove', function(e) {
        if (!dragging) return;
        var t = e.touches[0];
        var x = Math.max(0, Math.min(window.innerWidth  - w.offsetWidth,  t.clientX - dragOX));
        var y = Math.max(0, Math.min(window.innerHeight - 40, t.clientY - dragOY));
        w.style.left = x + 'px'; w.style.top = y + 'px';
      }, { passive: true });
      document.addEventListener('mouseup',  function() { dragging = false; resizing = false; });
      document.addEventListener('touchend', function() { dragging = false; });

      // ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤
      w.querySelectorAll('.dyo-brs-handle').forEach(function(handle) {
        handle.addEventListener('mousedown', function(e) {
          if (w.classList.contains('maximized') || w.classList.contains('minimized')) return;
          e.stopPropagation(); e.preventDefault();
          resizing = true;
          resizeDir = handle.getAttribute('data-dir');
          resizeSX = e.clientX; resizeSY = e.clientY;
          var rect = w.getBoundingClientRect();
          resizeSRect = { left: rect.left, top: rect.top, width: rect.width, height: rect.height };
          w.style.left = rect.left + 'px'; w.style.top = rect.top + 'px';
          w.style.width = rect.width + 'px'; w.style.height = rect.height + 'px';
          w.style.right = 'auto'; w.style.bottom = 'auto';
        });
      });
    })();

    // ============================================================
    // Guestbook ì±„íŒ…ì°½
    // ============================================================
    (function() {
      var w        = document.getElementById('dyoGuestWin');
      var titlebar = document.getElementById('dyoGuestTitlebar');
      var closeBtn = document.getElementById('dyoGuestClose');
      var minBtn   = document.getElementById('dyoGuestMin');
      var maxBtn   = document.getElementById('dyoGuestMax');
      var reloadBtn  = document.getElementById('dyoGuestReload');
      var chat       = document.getElementById('dyoGuestChat');
      var loading    = document.getElementById('dyoGuestLoading');
      var metaRow    = document.getElementById('dyoGuestMeta');
      var nameInput  = document.getElementById('dyoGuestIName');
      var pwInput    = document.getElementById('dyoGuestIPw');
      var textarea   = document.getElementById('dyoGuestTextarea');
      var sendBtn    = document.getElementById('dyoGuestSend');
      if (!w) return;

      var ADMIN_NICK = 'doyoucode';
      var isOwner    = false;
      var isLoggedIn = false;
      var msgData    = {};   // id â†’ { author, content }
      var dragging = false, dragOX = 0, dragOY = 0;
      var resizing = false, resizeDir = '', resizeSX = 0, resizeSY = 0, resizeSRect = null;
      var MIN_W = 300, MIN_H = 200;
      var savedPos = null;
      var loaded = false;

      // â”€â”€ ìœ í‹¸ â”€â”€
      function esc(t) {
        return String(t).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
      }

      function sha256hex(str) {
        return crypto.subtle.digest('SHA-256', new TextEncoder().encode(str))
          .then(function(buf) {
            return Array.from(new Uint8Array(buf))
              .map(function(b){ return b.toString(16).padStart(2,'0'); }).join('');
          });
      }

      // Tistory ë°©ëª…ë¡ ë¹„ë°€ë²ˆí˜¸: SHA-256( MD5( encodeURIComponent(pw) ) )
      function tistoryHashPw(passwd) {
        var encoded = encodeURIComponent(passwd);
        var md5hash = (typeof md5 === 'function') ? md5(encoded) : encoded;
        return sha256hex(md5hash);
      }

      function sendGuest() {
        var text = textarea ? textarea.value.trim() : '';
        if (!text) return;
        var name = nameInput ? nameInput.value.trim() : '';
        var pw   = pwInput   ? pwInput.value        : '';
        if (!name && metaRow && !metaRow.classList.contains('owner-mode')) return;

        sendBtn.disabled = true;
        var hashPromise = pw ? tistoryHashPw(pw) : Promise.resolve('');
        hashPromise.then(function(hashedPw) {
          return fetch('/m/api/guestbook', {
            method: 'POST',
            credentials: 'include',
            headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
            body: JSON.stringify({
              captcha:    '',
              comment:    text,
              homepage:   '',
              isSecret:   false,
              mentionId:  null,
              name:       name,
              parent:     null,
              password:   hashedPw
            })
          });
        }).then(function(r) {
          if (!r.ok) throw new Error('HTTP ' + r.status);
          return r.json();
        }).then(function() {
          if (textarea) textarea.value = '';
          loaded = false;
          loadGuest();
          if (window.dyoToast) window.dyoToast('ë©”ì‹œì§€ê°€ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
        }).catch(function() {
          if (window.dyoToast) window.dyoToast('ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 'error');
        }).finally(function() {
          sendBtn.disabled = false;
        });
      }

      function editGuest(id, bwrap) {
        var d = msgData[id];
        if (!d) return;
        var bubbleEl = bwrap.querySelector('.dyo-chat-bubble');
        var editBtnEl = bwrap.querySelector('.dyo-chat-editbtn');
        bubbleEl.style.display = 'none';
        if (editBtnEl) editBtnEl.style.display = 'none';

        var form = document.createElement('div');
        form.className = 'dyo-cedit-wrap';
        form.innerHTML =
          '<textarea class="dyo-cedit-ta" rows="2">' + esc(d.content) + '</textarea>' +
          (isLoggedIn ? '' : '<input type="password" class="dyo-cedit-pw" placeholder="ë¹„ë°€ë²ˆí˜¸">') +
          '<div class="dyo-cedit-btns">' +
          '<button class="dyo-cedit-cancel">ì·¨ì†Œ</button>' +
          '<button class="dyo-cedit-save">ìˆ˜ì •</button>' +
          '</div>';
        bwrap.insertBefore(form, bubbleEl);

        var ta      = form.querySelector('.dyo-cedit-ta');
        var pwEl    = form.querySelector('.dyo-cedit-pw');
        var cancelB = form.querySelector('.dyo-cedit-cancel');
        var saveB   = form.querySelector('.dyo-cedit-save');

        ta.focus();
        ta.setSelectionRange(ta.value.length, ta.value.length);

        cancelB.addEventListener('click', function() {
          form.remove();
          bubbleEl.style.display = '';
          if (editBtnEl) editBtnEl.style.display = '';
        });

        function doSave() {
          var newText = ta.value.trim();
          if (!newText) return;
          var pwVal = pwEl ? pwEl.value : '';
          saveB.disabled = true;
          (pwVal ? tistoryHashPw(pwVal) : Promise.resolve(''))
            .then(function(hashed) {
              return fetch('/m/api/guestbook/' + id, {
                method: 'PUT',
                credentials: 'include',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ comment: newText, mentionId: null, name: d.author, password: hashed, secret: false })
              });
            })
            .then(function(r) { if (!r.ok) throw new Error(); return r.json(); })
            .then(function() {
              loaded = false;
              loadGuest();
              if (window.dyoToast) window.dyoToast('ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            })
            .catch(function() {
              if (window.dyoToast) window.dyoToast('ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
              saveB.disabled = false;
            });
        }

        saveB.addEventListener('click', doSave);
        ta.addEventListener('keydown', function(e) {
          if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) { e.preventDefault(); doSave(); }
        });
      }

      function deleteGuest(id, bwrap) {
        var d = msgData[id];
        if (!d) return;

        var bubbleEl  = bwrap.querySelector('.dyo-chat-bubble');
        var editBtnEl = bwrap.querySelector('.dyo-chat-editbtn');
        var delBtnEl  = bwrap.querySelector('.dyo-chat-delbtn');

        function restore() {
          bubbleEl.style.display = '';
          if (editBtnEl) editBtnEl.style.display = '';
          if (delBtnEl)  delBtnEl.style.display  = '';
        }

        function doDelete(hashedPw, form) {
          fetch('/m/api/guestbook/' + id, {
            method: 'DELETE',
            credentials: 'include',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ password: hashedPw })
          })
          .then(function(r) { if (!r.ok) throw new Error(); return r.json(); })
          .then(function() {
            loaded = false;
            loadGuest();
            if (window.dyoToast) window.dyoToast('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
          })
          .catch(function() {
            if (window.dyoToast) window.dyoToast('ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.', 'error');
            if (form) form.remove();
            restore();
          });
        }

        // ë¡œê·¸ì¸ ì—¬ë¶€ ê´€ê³„ì—†ì´ ì°½ ì•ˆì—ì„œ ì¸ë¼ì¸ í™•ì¸ í¼ í‘œì‹œ
        {
          bubbleEl.style.display = 'none';
          if (editBtnEl) editBtnEl.style.display = 'none';
          if (delBtnEl)  delBtnEl.style.display  = 'none';

          var form = document.createElement('div');
          form.className = 'dyo-cedit-wrap';
          form.innerHTML =
            '<div class="dyo-cdel-notice">ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</div>' +
            (isLoggedIn ? '' : '<input type="password" class="dyo-cedit-pw" placeholder="ë¹„ë°€ë²ˆí˜¸">') +
            '<div class="dyo-cedit-btns">' +
            '<button class="dyo-cedit-cancel">ì·¨ì†Œ</button>' +
            '<button class="dyo-cedit-save dyo-cedit-del">ì‚­ì œ</button>' +
            '</div>';
          bwrap.insertBefore(form, bubbleEl);

          var pwEl    = form.querySelector('.dyo-cedit-pw');
          var cancelB = form.querySelector('.dyo-cedit-cancel');
          var saveB   = form.querySelector('.dyo-cedit-save');

          if (pwEl) pwEl.focus(); else saveB.focus();

          cancelB.addEventListener('click', function() {
            form.remove();
            restore();
          });

          saveB.addEventListener('click', function() {
            if (isLoggedIn) {
              saveB.disabled = true;
              doDelete('', form);
            } else {
              var pwVal = pwEl.value;
              if (!pwVal) { pwEl.focus(); return; }
              saveB.disabled = true;
              tistoryHashPw(pwVal).then(function(hashed) {
                doDelete(hashed, form);
              });
            }
          });

          pwEl.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') { e.preventDefault(); saveB.click(); }
          });
        }
      }

      function formatMsgDate(dateStr) {
        return dateStr || '';
      }

      function renderChat(msgs) {
        if (msgs.length === 0) {
          chat.innerHTML = '<div class="dyo-guest-empty">ë°©ëª…ë¡ì´ ë¹„ì–´ìˆê±°ë‚˜<br>ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
        } else {
          chat.innerHTML = msgs.map(function(m) {
            var role    = m.isAdmin ? 'admin' : 'visitor';
            var editBtn = m.canEdit && m.id
              ? '<button class="dyo-chat-editbtn" data-id="' + m.id + '" title="ìˆ˜ì •">âœ</button>'
              : '';
            var delBtn  = m.canDelete && m.id
              ? '<button class="dyo-chat-delbtn" data-id="' + m.id + '" title="ì‚­ì œ">ğŸ—‘</button>'
              : '';
            var timeStr = formatMsgDate(m.date);
            var timeEl  = timeStr ? '<div class="dyo-chat-time">' + timeStr + '</div>' : '';
            return '<div class="dyo-chat-row ' + role + '">' +
                   '<div class="dyo-chat-wrap">' +
                   '<div class="dyo-chat-name">' + esc(m.author) + '</div>' +
                   '<div class="dyo-chat-bwrap">' +
                   '<div class="dyo-chat-bubble">' + esc(m.content) + '</div>' +
                   editBtn + delBtn +
                   '</div>' +
                   timeEl +
                   '</div></div>';
          }).join('');
          chat.scrollTop = chat.scrollHeight;
        }
        loading.style.display = 'none';
        chat.style.display = 'flex';
      }

      function loadGuest() {
        loaded = true;
        loading.style.display = 'flex';
        loading.querySelector('span').textContent = 'ë°©ëª…ë¡ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...';
        loading.querySelector('.dyo-guest-spinner').style.display = '';
        chat.style.display = 'none';
        chat.innerHTML = '';

        fetch('/m/api/guestbook?reverse=true', { credentials: 'include', cache: 'no-store' })
          .then(function(r) {
            if (!r.ok) throw new Error('HTTP ' + r.status);
            return r.json();
          })
          .then(function(json) {
            var items = (json.data && json.data.items) || [];
            var msgs = [];
            // Pass 1: ë¡œê·¸ì¸ ìƒíƒœ í™•ì •
            //   isOwner    = ê´€ë¦¬ì ë¡œê·¸ì¸ (isRequestUser && role=owner)
            //   isLoggedIn = ì¼ë°˜ ê³„ì • ë¡œê·¸ì¸ (isRequestUser, ê´€ë¦¬ì í¬í•¨)
            isOwner    = false;
            isLoggedIn = false;
            msgData    = {};
            items.forEach(function(item) {
              if (item.writer && item.writer.isRequestUser) {
                isLoggedIn = true;
                if (item.writer.role === 'owner') isOwner = true;
              }
              (item.children || []).forEach(function(c) {
                if (c.writer && c.writer.isRequestUser) {
                  isLoggedIn = true;
                  if (c.writer.role === 'owner') isOwner = true;
                }
              });
            });
            // Pass 2: canEdit ê²°ì •
            //   ê´€ë¦¬ì(isOwner)    : ë³¸ì¸(ê´€ë¦¬ì) ë©”ì‹œì§€ë§Œ
            //   ë¡œê·¸ì¸ ì¼ë°˜ ê³„ì •   : isRequestUser=trueì¸ ë³¸ì¸ ë©”ì‹œì§€ë§Œ
            //   ë¹„ë¡œê·¸ì¸ ê²ŒìŠ¤íŠ¸    : ê²ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì²´ (í´ë¦­ ì‹œ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥)
            function calcCanEdit(writer) {
              var isAdmin = !!(writer && writer.role === 'owner');
              var isMine  = !!(writer && writer.isRequestUser);
              if (isOwner)    return isAdmin;   // ê´€ë¦¬ì: ê´€ë¦¬ì ë©”ì‹œì§€ë§Œ
              if (isLoggedIn) return isMine;    // ë¡œê·¸ì¸: ë³¸ì¸ ë©”ì‹œì§€ë§Œ
              return !isAdmin;                  // ë¹„ë¡œê·¸ì¸: ê²ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì²´
            }
            function calcCanDelete(writer) {
              var isAdmin = !!(writer && writer.role === 'owner');
              var isMine  = !!(writer && writer.isRequestUser);
              if (isOwner)    return true;      // ê´€ë¦¬ì: ëª¨ë“  ë©”ì‹œì§€ ì‚­ì œ ê°€ëŠ¥
              if (isLoggedIn) return isMine;    // ë¡œê·¸ì¸: ë³¸ì¸ ë©”ì‹œì§€ë§Œ
              return !isAdmin;                  // ë¹„ë¡œê·¸ì¸: ê²ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì²´ (ë¹„ë°€ë²ˆí˜¸ í•„ìš”)
            }
            items.forEach(function(item) {
              var isAdmin    = !!(item.writer && item.writer.role === 'owner');
              var canEdit    = calcCanEdit(item.writer);
              var canDelete  = calcCanDelete(item.writer);
              msgData[item.id] = { author: item.writer ? item.writer.name : 'ë°©ë¬¸ì', content: item.content };
              msgs.push({ id: item.id, author: item.writer ? item.writer.name : 'ë°©ë¬¸ì', content: item.content, isAdmin: isAdmin, canEdit: canEdit, canDelete: canDelete, date: item.written || '' });
              (item.children || []).forEach(function(child) {
                var childIsAdmin   = !!(child.writer && child.writer.role === 'owner');
                var childCanEdit   = calcCanEdit(child.writer);
                var childCanDelete = calcCanDelete(child.writer);
                msgData[child.id] = { author: child.writer ? child.writer.name : ADMIN_NICK, content: child.content };
                msgs.push({ id: child.id, author: child.writer ? child.writer.name : ADMIN_NICK, content: child.content, isAdmin: true, canEdit: childCanEdit, canDelete: childCanDelete, date: child.written || '' });
              });
            });
            // ownerì´ë©´ ì´ë¦„/ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ ìˆ¨ê¸°ê¸°
            if (metaRow) {
              if (isOwner) metaRow.classList.add('owner-mode');
              else         metaRow.classList.remove('owner-mode');
            }
            renderChat(msgs);
          })
          .catch(function() {
            loading.querySelector('span').textContent = 'ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨. â†º ë²„íŠ¼ìœ¼ë¡œ ì¬ì‹œë„';
            loading.querySelector('.dyo-guest-spinner').style.display = 'none';
          });
      }

      // â”€â”€ ì°½ ì—´ê¸°/ë‹«ê¸°/ìµœì†Œí™”/ìµœëŒ€í™” â”€â”€
      function openGuest() {
        var wasOpen = w.classList.contains('open');
        if (!wasOpen) {
          var W = Math.min(360, window.innerWidth  - 40);
          var H = Math.min(580, window.innerHeight - 40);
          w.style.width  = W + 'px';
          w.style.height = H + 'px';
          w.style.left   = Math.round(window.innerWidth - W - 24) + 'px';
          // í† ìŠ¤íŠ¸ ì•Œë¦¼(bottom: 108px) ê³¼ ê²¹ì¹˜ì§€ ì•Šë„ë¡ í•˜ë‹¨ 160px ì—¬ìœ  í™•ë³´
          w.style.top    = Math.max(20, Math.min(
            Math.round((window.innerHeight - H) / 2),
            window.innerHeight - H - 160
          )) + 'px';
          w.style.right  = 'auto';
          w.style.bottom = 'auto';
        }
        w.classList.add('open');
        w.classList.remove('minimized');
        window._dyoZTop = (window._dyoZTop || 9000) + 1;
        w.style.zIndex = window._dyoZTop;
        if (!wasOpen && window.dyoAnimOpen) window.dyoAnimOpen(w);
        if (!loaded) loadGuest();
      }
      function closeGuest() {
        if (window.dyoAnimDismiss) {
          window.dyoAnimDismiss(w, function() {
            w.classList.remove('open','minimized','maximized');
            savedPos = null;
          });
        } else {
          w.classList.remove('open','minimized','maximized');
          savedPos = null;
        }
      }
      function minimizeGuest() {
        if (w.classList.contains('minimized')) {
          var tb = document.querySelector('.dyo-taskbtn[data-win-id="dyoGuestWin"]');
          window._dyoAnimSrc = tb || null;
          w.classList.remove('minimized');
          if (window.dyoAnimOpen) window.dyoAnimOpen(w);
        } else {
          if (w.classList.contains('maximized')) {
            w.classList.remove('maximized');
            if (savedPos) {
              w.style.left=savedPos.left; w.style.top=savedPos.top;
              w.style.right=savedPos.right; w.style.bottom=savedPos.bottom;
              w.style.width=savedPos.width; w.style.height=savedPos.height;
              savedPos=null;
            }
          }
          if (window.dyoAnimMinimize) {
            window.dyoAnimMinimize(w, function() { w.classList.add('minimized'); });
          } else {
            w.classList.add('minimized');
          }
        }
      }
      function maximizeGuest() {
        if (w.classList.contains('maximized')) {
          w.classList.remove('maximized');
          if (savedPos) {
            w.style.left=savedPos.left; w.style.top=savedPos.top;
            w.style.right=savedPos.right; w.style.bottom=savedPos.bottom;
            w.style.width=savedPos.width; w.style.height=savedPos.height;
            savedPos=null;
          }
          if (window.dyoAnimMaximizeOut) window.dyoAnimMaximizeOut(w);
        } else {
          w.classList.remove('minimized');
          savedPos = { left:w.style.left, top:w.style.top, right:w.style.right,
                       bottom:w.style.bottom, width:w.style.width, height:w.style.height };
          w.classList.add('maximized');
          w.style.left=w.style.top=w.style.right=w.style.bottom=w.style.width=w.style.height='';
          if (window.dyoAnimMaximizeIn) window.dyoAnimMaximizeIn(w);
        }
      }

      window.dyoOpenGuest = openGuest;

      w.addEventListener('mousedown', function() {
        window._dyoZTop = (window._dyoZTop || 9000) + 1;
        w.style.zIndex = window._dyoZTop;
      });
      if (closeBtn)  closeBtn.addEventListener('click',  closeGuest);
      if (minBtn)    minBtn.addEventListener('click',    minimizeGuest);
      if (maxBtn)    maxBtn.addEventListener('click',    maximizeGuest);
      if (reloadBtn) reloadBtn.addEventListener('click', function() { loaded=false; loadGuest(); });
      if (sendBtn)   sendBtn.addEventListener('click', sendGuest);
      chat.addEventListener('click', function(e) {
        var editBtn = e.target.closest('.dyo-chat-editbtn');
        if (editBtn) {
          var bwrap = editBtn.closest('.dyo-chat-bwrap');
          if (bwrap) editGuest(editBtn.dataset.id, bwrap);
          return;
        }
        var delBtn = e.target.closest('.dyo-chat-delbtn');
        if (delBtn) {
          var bwrap = delBtn.closest('.dyo-chat-bwrap');
          if (bwrap) deleteGuest(delBtn.dataset.id, bwrap);
        }
      });
      if (textarea) {
        textarea.addEventListener('keydown', function(e) {
          if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) { e.preventDefault(); sendGuest(); }
        });
      }

      if (titlebar) {
        titlebar.addEventListener('dblclick', function(e) {
          if (e.target===closeBtn||e.target===minBtn||e.target===maxBtn) return;
          maximizeGuest();
        });
        titlebar.addEventListener('mousedown', function(e) {
          if (w.classList.contains('maximized')) return;
          if (e.target===closeBtn||e.target===minBtn||e.target===maxBtn) return;
          var r = w.getBoundingClientRect();
          w.style.left=r.left+'px'; w.style.top=r.top+'px';
          w.style.right='auto'; w.style.bottom='auto';
          dragging=true; dragOX=e.clientX-r.left; dragOY=e.clientY-r.top;
          e.preventDefault();
        });
        titlebar.addEventListener('touchstart', function(e) {
          if (w.classList.contains('maximized')) return;
          var t=e.touches[0], r=w.getBoundingClientRect();
          w.style.left=r.left+'px'; w.style.top=r.top+'px';
          w.style.right='auto'; w.style.bottom='auto';
          dragging=true; dragOX=t.clientX-r.left; dragOY=t.clientY-r.top;
        }, {passive:true});
      }

      document.addEventListener('mousemove', function(e) {
        if (dragging) {
          var x=Math.max(0,Math.min(window.innerWidth-w.offsetWidth, e.clientX-dragOX));
          var y=Math.max(0,Math.min(window.innerHeight-40, e.clientY-dragOY));
          w.style.left=x+'px'; w.style.top=y+'px';
        }
        if (resizing) {
          var dx=e.clientX-resizeSX, dy=e.clientY-resizeSY, r=resizeSRect;
          var nL=r.left,nT=r.top,nW=r.width,nH=r.height;
          if (resizeDir.indexOf('e')!==-1) nW=Math.max(MIN_W,r.width+dx);
          if (resizeDir.indexOf('s')!==-1) nH=Math.max(MIN_H,r.height+dy);
          if (resizeDir.indexOf('w')!==-1){nW=Math.max(MIN_W,r.width-dx);nL=r.left+r.width-nW;}
          if (resizeDir.indexOf('n')!==-1){nH=Math.max(MIN_H,r.height-dy);nT=r.top+r.height-nH;}
          w.style.left=nL+'px'; w.style.top=nT+'px';
          w.style.width=nW+'px'; w.style.height=nH+'px';
        }
      });
      document.addEventListener('touchmove', function(e) {
        if (!dragging) return;
        var t=e.touches[0];
        var x=Math.max(0,Math.min(window.innerWidth-w.offsetWidth, t.clientX-dragOX));
        var y=Math.max(0,Math.min(window.innerHeight-40, t.clientY-dragOY));
        w.style.left=x+'px'; w.style.top=y+'px';
      }, {passive:true});
      document.addEventListener('mouseup',  function(){dragging=false;resizing=false;});
      document.addEventListener('touchend', function(){dragging=false;});

      w.querySelectorAll('.dyo-brs-handle').forEach(function(handle) {
        handle.addEventListener('mousedown', function(e) {
          if (w.classList.contains('maximized')||w.classList.contains('minimized')) return;
          e.stopPropagation(); e.preventDefault();
          resizing=true; resizeDir=handle.getAttribute('data-dir');
          resizeSX=e.clientX; resizeSY=e.clientY;
          var r=w.getBoundingClientRect();
          resizeSRect={left:r.left,top:r.top,width:r.width,height:r.height};
          w.style.left=r.left+'px'; w.style.top=r.top+'px';
          w.style.width=r.width+'px'; w.style.height=r.height+'px';
          w.style.right='auto'; w.style.bottom='auto';
        });
      });
    })();
  </script>

  <script>
    // ============================================================
    // ì™¸ë¶€ ë§í¬ í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸
    // ============================================================
    (function() {
      var overlay   = document.getElementById('dyoConfirmOverlay');
      var urlEl     = document.getElementById('dyoConfirmUrl');
      var cancelBtn = document.getElementById('dyoConfirmCancel');
      var okBtn     = document.getElementById('dyoConfirmOk');
      if (!overlay) return;

      var pendingUrl = null;

      window.dyoOpenExternal = function(url) {
        pendingUrl = url;
        urlEl.textContent = url;
        overlay.classList.add('show');
      };

      okBtn.addEventListener('click', function() {
        if (pendingUrl) window.open(pendingUrl, '_blank');
        overlay.classList.remove('show');
        pendingUrl = null;
      });

      cancelBtn.addEventListener('click', function() {
        overlay.classList.remove('show');
        pendingUrl = null;
      });

      overlay.addEventListener('click', function(e) {
        if (e.target === overlay) {
          overlay.classList.remove('show');
          pendingUrl = null;
        }
      });

      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && overlay.classList.contains('show')) {
          overlay.classList.remove('show');
          pendingUrl = null;
        }
        if (e.key === 'Enter' && overlay.classList.contains('show')) {
          okBtn.click();
        }
      });
    })();

    // ============================================================
    // Toast ì•Œë¦¼
    // ============================================================
    (function() {
      var container = document.createElement('div');
      container.className = 'dyo-toast-container';
      document.body.appendChild(container);

      var ICONS = { success: 'âœ“', error: 'âœ•', warn: 'âš ', info: 'i' };

      window.dyoToast = function(msg, type, duration) {
        type     = type     || 'info';
        duration = duration || 3000;

        var toast = document.createElement('div');
        toast.className = 'dyo-toast ' + type;
        toast.innerHTML =
          '<em class="dyo-toast-icon">' + (ICONS[type] || 'i') + '</em>' +
          '<span>' + msg + '</span>' +
          '<div class="dyo-toast-bar" style="animation-duration:' + duration + 'ms"></div>';
        container.appendChild(toast);

        function dismiss() {
          if (toast.classList.contains('dyo-toast-out')) return;
          toast.classList.add('dyo-toast-out');
          setTimeout(function() { if (toast.parentNode) toast.remove(); }, 220);
        }

        var timer = setTimeout(dismiss, duration);
        toast.addEventListener('click', function() {
          clearTimeout(timer);
          dismiss();
        }, { once: true });
      };
    })();

    // ============================================================
    // ì°½ íŒì—… ì• ë‹ˆë©”ì´ì…˜ í—¬í¼
    // ============================================================
    (function() {
      // ì•„ì´ì½˜ â†’ ì°½ì´ íŠ€ì–´ë‚˜ì˜¤ëŠ” íŒ ì• ë‹ˆë©”ì´ì…˜
      // ì‚¬ìš©ë²•: ê° open í•¨ìˆ˜ì—ì„œ window.dyoAnimOpen(winEl) í˜¸ì¶œ
      //         ì•„ì´ì½˜ í´ë¦­ ì‹œ window._dyoAnimSrc = iconEl; ì„¤ì •
      // ë‹«ê¸°/ìˆ¨ê¹€: í˜ì´ë“œì•„ì›ƒ í›„ ì½œë°±
      window.dyoAnimDismiss = function(winEl, cb) {
        // ìµœì†Œí™” ìƒíƒœ(display:none)ë©´ animationì´ ì‹¤í–‰ ì•ˆ ë˜ë¯€ë¡œ ì¦‰ì‹œ ì½œë°±
        if (winEl.classList.contains('minimized') || !winEl.offsetParent) {
          if (cb) cb();
          return;
        }
        winEl.classList.add('dyo-win-dismissing');
        winEl.addEventListener('animationend', function() {
          winEl.classList.remove('dyo-win-dismissing');
          if (cb) cb();
        }, { once: true });
      };

      // ìµœì†Œí™”: íƒœìŠ¤í¬ë°” ë²„íŠ¼ ìœ„ì¹˜ë¡œ ë‚ ì•„ê°€ë©° ì‚¬ë¼ì§
      window.dyoAnimMinimize = function(winEl, cb) {
        // ì´ë¯¸ ìµœì†Œí™” ì• ë‹ˆë©”ì´ì…˜ ì¤‘ì´ë©´ ì¦‰ì‹œ ì²˜ë¦¬
        if (winEl.classList.contains('dyo-win-minimizing')) {
          winEl.classList.remove('dyo-win-minimizing');
          winEl.style.removeProperty('--min-tx');
          winEl.style.removeProperty('--min-ty');
          if (cb) cb();
          return;
        }
        var dockItem = document.querySelector('.dyo-dock-item[data-win-id="' + winEl.id + '"]');
        var taskBtn  = dockItem || document.querySelector('.dyo-taskbtn[data-win-id="' + winEl.id + '"]');
        var wr = winEl.getBoundingClientRect();
        var wx = wr.left + wr.width  / 2;
        var wy = wr.top  + wr.height / 2;
        // ê¸°ë³¸ê°’: í™”ë©´ í•˜ë‹¨ ì¤‘ì•™ (ë…/íƒœìŠ¤í¬ë°” ìœ„ì¹˜)
        var tx = window.innerWidth / 2 - wx;
        var ty = window.innerHeight - wy;
        if (taskBtn) {
          var tr = taskBtn.getBoundingClientRect();
          tx = (tr.left + tr.width  / 2) - wx;
          ty = (tr.top  + tr.height / 2) - wy;
        }
        winEl.style.setProperty('--min-tx', tx + 'px');
        winEl.style.setProperty('--min-ty', ty + 'px');
        winEl.classList.add('dyo-win-minimizing');
        winEl.addEventListener('animationend', function() {
          if (cb) cb();
          winEl.classList.remove('dyo-win-minimizing');
          winEl.style.removeProperty('--min-tx');
          winEl.style.removeProperty('--min-ty');
        }, { once: true });
      };

      // ìµœëŒ€í™” ì§„ì… ì• ë‹ˆë©”ì´ì…˜
      window.dyoAnimMaximizeIn = function(winEl) {
        winEl.classList.remove('dyo-win-zoom-in');
        void winEl.offsetWidth;
        winEl.classList.add('dyo-win-zoom-in');
        winEl.addEventListener('animationend', function() {
          winEl.classList.remove('dyo-win-zoom-in');
        }, { once: true });
      };

      // ìµœëŒ€í™” ë³µì› ì• ë‹ˆë©”ì´ì…˜
      window.dyoAnimMaximizeOut = function(winEl) {
        winEl.classList.remove('dyo-win-zoom-out');
        void winEl.offsetWidth;
        winEl.classList.add('dyo-win-zoom-out');
        winEl.addEventListener('animationend', function() {
          winEl.classList.remove('dyo-win-zoom-out');
        }, { once: true });
      };

      window.dyoAnimOpen = function(winEl) {
        var src = window._dyoAnimSrc || null;
        window._dyoAnimSrc = null;

        // ê¸°ì¤€ì (transform-origin) ê³„ì‚°: ì•„ì´ì½˜ ì¤‘ì‹¬ â†’ ì°½ ê¸°ì¤€ ìƒëŒ€ ì¢Œí‘œ
        var wr = winEl.getBoundingClientRect();
        var ox, oy;
        if (src) {
          var sr = src.getBoundingClientRect();
          ox = sr.left + sr.width  / 2;
          oy = sr.top  + sr.height / 2;
        } else {
          ox = window.innerWidth  / 2;
          oy = window.innerHeight / 2;
        }
        var tx = ox - wr.left;
        var ty = oy - wr.top;

        winEl.style.transformOrigin = tx + 'px ' + ty + 'px';
        winEl.classList.remove('dyo-win-pop');
        void winEl.offsetWidth; // reflow
        winEl.classList.add('dyo-win-pop');

        winEl.addEventListener('animationend', function() {
          winEl.classList.remove('dyo-win-pop');
          winEl.style.transformOrigin = '';
        }, { once: true });
      };
    })();

    // ============================================================
    // ì „ì²´í™”ë©´ í† ê¸€ ë²„íŠ¼
    // ============================================================
    (function() {
      var btn      = document.getElementById('btnFullscreen');
      var iconExp  = document.getElementById('fsIconExpand');
      var iconComp = document.getElementById('fsIconCompress');
      if (!btn) return;

      function updateIcons() {
        var isFs = !!(document.fullscreenElement || document.webkitFullscreenElement);
        iconExp.style.display  = isFs ? 'none'  : '';
        iconComp.style.display = isFs ? ''      : 'none';
        btn.title = isFs ? 'ì „ì²´í™”ë©´ ì¢…ë£Œ' : 'ì „ì²´í™”ë©´';
      }

      btn.addEventListener('click', function() {
        if (document.fullscreenElement || document.webkitFullscreenElement) {
          (document.exitFullscreen || document.webkitExitFullscreen).call(document);
        } else {
          var el = document.documentElement;
          if (el.requestFullscreen) el.requestFullscreen();
          else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
        }
      });

      document.addEventListener('fullscreenchange', updateIcons);
      document.addEventListener('webkitfullscreenchange', updateIcons);
    })();

    // ============================================================
    // íƒœìŠ¤í¬ë°” ì—´ë¦° ì°½ ë²„íŠ¼
    // ============================================================
    (function() {
      var container = document.getElementById('dyoBarCenter');
      if (!container) return;

      var winDefs = [
        {
          id: 'dyoShellWin', label: 'Terminal',
          icon: '<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/></svg>',
          open: function() { if (window.dyoOpenShell) window.dyoOpenShell(); }
        },
        {
          id: 'dyoBrowserWin', label: 'Browser',
          icon: '<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>',
          open: function() { if (window.dyoOpenBrowser) window.dyoOpenBrowser('/category'); }
        },
        {
          id: 'dyoReadmeWin', label: 'README',
          icon: '<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>',
          open: function() { if (window.dyoOpenReadme) window.dyoOpenReadme(); }
        },
        {
          id: 'dyoGuestWin', label: 'Guestbook',
          icon: '<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>',
          open: function() { if (window.dyoOpenGuest) window.dyoOpenGuest(); }
        },
        {
          id: 'dyoPropsWin', label: 'Properties',
          icon: '<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/><path d="M4.93 4.93a10 10 0 0 0 0 14.14"/></svg>',
          open: function() { if (window.dyoOpenProps && window._dyoLastPropsMeta) window.dyoOpenProps(window._dyoLastPropsMeta); }
        },
        {
          id: 'dyoExplorerWin', label: 'File Explorer',
          icon: '<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 7a2 2 0 0 1 2-2h4l2 2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg>',
          open: function() { if (window.dyoOpenExplorer) window.dyoOpenExplorer(); }
        },
        {
          id: 'dyoGalleryWin', label: 'Blogram',
          icon: '<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="2" width="20" height="20" rx="6"/><circle cx="12" cy="12" r="5"/><circle cx="17.5" cy="6.5" r="1.3" fill="currentColor" stroke="none"/></svg>',
          open: function() { if (window.dyoOpenGallery) window.dyoOpenGallery(); }
        }
      ];

      winDefs.forEach(function(def) {
        var winEl = document.getElementById(def.id);
        if (!winEl) return;

        var btn = document.createElement('button');
        btn.className = 'dyo-taskbtn';
        btn.dataset.winId = def.id;
        btn.innerHTML = def.icon + '<span class="dyo-taskbtn-label">' + def.label + '</span>';
        container.appendChild(btn);

        // í´ë¦­: ë‹«í˜â†’ì—´ê¸° / ë‚˜ë¨¸ì§€â†’í•­ìƒ ë§¨ ì•ìœ¼ë¡œ ë³µì›
        btn.addEventListener('click', function() {
          if (!winEl.classList.contains('open')) {
            def.open();
          } else if (winEl.classList.contains('minimized')) {
            window._dyoAnimSrc = btn;
            winEl.classList.remove('minimized');
            window._dyoZTop = (window._dyoZTop || 9000) + 1;
            winEl.style.zIndex = window._dyoZTop;
            if (window.dyoAnimOpen) window.dyoAnimOpen(winEl);
          } else {
            // ì´ë¯¸ ì—´ë ¤ìˆê³  ìµœì†Œí™” ì•„ë‹˜ â†’ ìµœì†Œí™”
            if (window.dyoAnimMinimize) {
              window.dyoAnimMinimize(winEl, function() { winEl.classList.add('minimized'); });
            } else {
              winEl.classList.add('minimized');
            }
          }
        });

        // ì°½ í´ë˜ìŠ¤ ë³€í™” ê°ì§€ â†’ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
        var observer = new MutationObserver(function() {
          var isOpen = winEl.classList.contains('open');
          var isMin  = winEl.classList.contains('minimized');
          btn.classList.toggle('open',      isOpen);
          btn.classList.toggle('active',    isOpen && !isMin);
          btn.classList.toggle('minimized', isOpen && isMin);
        });
        observer.observe(winEl, { attributes: true, attributeFilter: ['class'] });
      });
    })();

    // ============================================================
    // macOS Dock
    // ============================================================
    (function() {
      var dock = document.getElementById('dyoDock');
      if (!dock) return;

      var dockDefs = [
        {
          id: 'dyoReadmeWin', label: 'README',
          style: 'background:linear-gradient(145deg,#f0f6ff,#dce8fb);border:1px solid rgba(100,160,255,.35)',
          icon: '<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" fill="#3b82f6" opacity=".15"/><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" fill="none" stroke="#3b82f6" stroke-width="1.5" stroke-linejoin="round"/><polyline points="14 2 14 8 20 8" fill="none" stroke="#3b82f6" stroke-width="1.5" stroke-linejoin="round"/><line x1="8" y1="12" x2="16" y2="12" stroke="#3b82f6" stroke-width="1.4"/><line x1="8" y1="15" x2="16" y2="15" stroke="#3b82f6" stroke-width="1.4" opacity=".65"/><line x1="8" y1="18" x2="13" y2="18" stroke="#3b82f6" stroke-width="1.4" opacity=".4"/></svg>',
          open: function() { if (window.dyoOpenReadme) window.dyoOpenReadme(); }
        },
        {
          id: 'dyoShellWin', label: 'Terminal',
          style: 'background:#0c0c0c;border:1px solid #3a3a3a',
          icon: '<svg viewBox="0 0 24 24" fill="none" stroke="#cccccc" stroke-linecap="square" stroke-width="2.5"><polyline points="4 8 9 12 4 16"/><line x1="12" y1="16" x2="20" y2="16"/></svg>',
          open: function() { if (window.dyoOpenShell) window.dyoOpenShell(); }
        },
        {
          id: 'dyoBrowserWin', label: 'Dev Blog',
          style: 'background:linear-gradient(145deg,#ff6320,#e8501a);border:1px solid rgba(255,140,80,.4)',
          icon: '<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><rect x="3.5" y="6" width="17" height="3.2" rx="1.6" fill="white"/><rect x="10.4" y="8.8" width="3.2" height="10.2" rx="1.6" fill="white"/></svg>',
          open: function() { if (window.dyoOpenBrowser) window.dyoOpenBrowser('/category'); }
        },
        {
          id: 'dyoGuestWin', label: 'Guestbook',
          style: 'background:linear-gradient(145deg,#fffbe0,#fff3a0);border:1px solid rgba(200,168,0,.4)',
          icon: '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" fill="#FEE500" opacity=".25" stroke="#c8a800" stroke-width="1.5" stroke-linejoin="round"/><circle cx="8.5" cy="11" r="1.2" fill="#c8a800"/><circle cx="12" cy="11" r="1.2" fill="#c8a800"/><circle cx="15.5" cy="11" r="1.2" fill="#c8a800"/></svg>',
          open: function() { if (window.dyoOpenGuest) window.dyoOpenGuest(); }
        },
        {
          id: 'dyoExplorerWin', label: 'Files',
          style: 'background:linear-gradient(145deg,#ffe066,#f0a30a);border:1px solid rgba(240,163,10,.5)',
          icon: '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 7a2 2 0 0 1 2-2h4l2 2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" fill="rgba(255,255,255,.35)" stroke="#fff" stroke-width="1.5" stroke-linejoin="round"/><path d="M3 11h18" stroke="#fff" stroke-width="1.3"/></svg>',
          open: function() { if (window.dyoOpenExplorer) window.dyoOpenExplorer(); }
        },
        {
          id: 'dyoGalleryWin', label: 'Blogram',
          style: 'background:linear-gradient(135deg,#833ab4,#c13584 35%,#e1306c 60%,#f77737 85%,#fcaf45);border:1px solid rgba(225,48,108,.4)',
          icon: '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="2" y="2" width="20" height="20" rx="6" stroke="white" stroke-width="1.8"/><circle cx="12" cy="12" r="5" stroke="white" stroke-width="1.8"/><circle cx="17.5" cy="6.5" r="1.3" fill="white"/></svg>',
          open: function() { if (window.dyoOpenGallery) window.dyoOpenGallery(); }
        }
      ];

      function updateDockVisibility() {
        var hasOpen = !!dock.querySelector('.dyo-dock-item.open');
        dock.style.display = hasOpen ? 'flex' : 'none';
      }

      dockDefs.forEach(function(def) {
        var item = document.createElement('div');
        item.className = 'dyo-dock-item';
        if (def.id) item.dataset.winId = def.id;
        item.innerHTML =
          '<div class="dyo-dock-icon" style="' + def.style + '">' + def.icon + '</div>' +
          '<div class="dyo-dock-dot"></div>' +
          '<div class="dyo-dock-label">' + def.label + '</div>';

        item.addEventListener('click', function() {
          if (!def.id) { def.open(); return; }
          var winEl = document.getElementById(def.id);
          if (!winEl) return;
          if (!winEl.classList.contains('open')) {
            window._dyoAnimSrc = item;
            def.open();
          } else if (winEl.classList.contains('minimized')) {
            window._dyoAnimSrc = item;
            winEl.classList.remove('minimized');
            window._dyoZTop = (window._dyoZTop || 9000) + 1;
            winEl.style.zIndex = window._dyoZTop;
            if (window.dyoAnimOpen) window.dyoAnimOpen(winEl);
          } else {
            var isFront = parseInt(winEl.style.zIndex) >= (window._dyoZTop || 9000);
            if (isFront) {
              if (window.dyoAnimMinimize) {
                window.dyoAnimMinimize(winEl, function() { winEl.classList.add('minimized'); });
              } else {
                winEl.classList.add('minimized');
              }
            } else {
              window._dyoZTop = (window._dyoZTop || 9000) + 1;
              winEl.style.zIndex = window._dyoZTop;
            }
          }
        });

        item.addEventListener('contextmenu', function(e) {
          e.preventDefault();
          e.stopPropagation();
          var old = document.getElementById('dyoDockCtxMenu');
          if (old) old.remove();

          var winEl = def.id ? document.getElementById(def.id) : null;
          if (!winEl) return;
          var isOpen = winEl.classList.contains('open');
          var isMin  = winEl.classList.contains('minimized');

          var menu = document.createElement('div');
          menu.id = 'dyoDockCtxMenu';
          menu.className = 'dyo-ctx-menu show';
          menu.style.left = e.clientX + 'px';
          menu.style.top  = (e.clientY - 8) + 'px';

          function addItem(label, disabled, action) {
            var btn = document.createElement('button');
            btn.className = 'dyo-ctx-item' + (disabled ? ' disabled' : '');
            btn.textContent = label;
            if (disabled) btn.disabled = true;
            else btn.addEventListener('click', function() { menu.remove(); action(); });
            menu.appendChild(btn);
          }

          addItem('Minimize', !isOpen || isMin, function() {
            if (window.dyoAnimMinimize) {
              window.dyoAnimMinimize(winEl, function() { winEl.classList.add('minimized'); });
            } else {
              winEl.classList.add('minimized');
            }
          });

          addItem('Restore', !isOpen || !isMin, function() {
            window._dyoAnimSrc = item;
            winEl.classList.remove('minimized');
            window._dyoZTop = (window._dyoZTop || 9000) + 1;
            winEl.style.zIndex = window._dyoZTop;
            if (window.dyoAnimOpen) window.dyoAnimOpen(winEl);
          });

          addItem('Close', !isOpen, function() {
            if (window.dyoAnimClose) {
              window.dyoAnimClose(winEl, function() {
                winEl.classList.remove('open','minimized','maximized');
              });
            } else {
              winEl.classList.remove('open','minimized','maximized');
            }
          });

          document.body.appendChild(menu);

          var rect = menu.getBoundingClientRect();
          if (rect.bottom > window.innerHeight) menu.style.top  = (e.clientY - rect.height - 8) + 'px';
          if (rect.right  > window.innerWidth)  menu.style.left = (e.clientX - rect.width) + 'px';

          function closeMenu(ev) {
            if (!menu.contains(ev.target)) {
              menu.remove();
              document.removeEventListener('mousedown', closeMenu);
            }
          }
          document.addEventListener('mousedown', closeMenu);
        });

        if (def.id) {
          var winEl = document.getElementById(def.id);
          if (winEl) {
            var obs = new MutationObserver(function() {
              var isOpen = winEl.classList.contains('open');
              var isMin  = winEl.classList.contains('minimized');
              item.classList.toggle('open',      isOpen);
              item.classList.toggle('minimized', isOpen && isMin);
              updateDockVisibility();
            });
            obs.observe(winEl, { attributes: true, attributeFilter: ['class'] });
          }
        }

        dock.appendChild(item);
      });

      // ì´ˆê¸° ìƒíƒœ (ëª¨ë“  ì°½ ë‹«í˜€ìˆìœ¼ë©´ dock ìˆ¨ê¹€)
      updateDockVisibility();

      // â”€â”€ hover í™•ëŒ€ (macOS Dock íš¨ê³¼) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      var MAX_SCALE = 1.6;
      var INFLUENCE = 90;

      dock.addEventListener('mousemove', function(e) {
        dock.querySelectorAll('.dyo-dock-item.open').forEach(function(item) {
          var rect   = item.getBoundingClientRect();
          var center = rect.left + rect.width / 2;
          var dist   = Math.abs(e.clientX - center);
          var t      = dist < INFLUENCE ? 1 - dist / INFLUENCE : 0;
          var scale  = 1 + (MAX_SCALE - 1) * Math.pow(t, 1.2);
          item.style.transform = 'scale(' + scale.toFixed(3) + ')';
          var lbl = item.querySelector('.dyo-dock-label');
          if (lbl) lbl.style.opacity = dist < 28 ? '1' : '0';
        });
      });

      dock.addEventListener('mouseleave', function() {
        dock.querySelectorAll('.dyo-dock-item.open').forEach(function(item) {
          item.style.transform = '';
          var lbl = item.querySelector('.dyo-dock-label');
          if (lbl) lbl.style.opacity = '0';
        });
      });
    })();

    // ============================================================
    // ë°”íƒ•í™”ë©´ ìš°í´ë¦­ ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´
    // ============================================================
    (function() {
      var desktop = document.getElementById('dyoDesktop');
      var menu    = document.getElementById('dyoCtxMenu');
      if (!desktop || !menu) return;

      // ì•„ì´ì½˜ ë©”íƒ€ë°ì´í„° (í’ë¶€í•œ ì†ì„± í¬í•¨)
      var iconMeta = {
        desktopIconReadme: {
          name: 'README', ext: '.md', type: 'Document',
          desc: 'ë¸”ë¡œê·¸ ì†Œê°œ ë° ì‚¬ìš©ë²• ë¬¸ì„œ',
          location: '~/Desktop/README.md',
          size: '4.2 KB', disk: '8 KB',
          created: '2025-01-15', modified: '2026-02-27',
          owner: 'doyoucode', group: 'staff',
          permissions: 'Read-only', version: '1.0',
          iconBg: 'linear-gradient(145deg,#f0f6ff 0%,#dce8fb 100%)',
          iconBorder: 'rgba(100,160,255,0.35)', iconColor: '#3b82f6', iconChar: 'ğŸ“„',
          action: function() { if (window.dyoOpenReadme) window.dyoOpenReadme(); }
        },
        desktopIconShell: {
          name: 'Terminal', ext: '.app', type: 'Application',
          desc: 'í„°ë¯¸ë„ ì—ë®¬ë ˆì´í„° (Bash-like shell)',
          location: '/usr/bin/terminal',
          size: 'â€”', disk: 'â€”',
          created: '2025-01-15', modified: '2026-02-27',
          owner: 'root', group: 'wheel',
          permissions: 'Read / Execute', version: '2.1.0',
          iconBg: '#0c0c0c', iconBorder: '#3a3a3a', iconColor: '#cccccc', iconChar: '>_',
          action: function() { if (window.dyoOpenShell) window.dyoOpenShell(); }
        },
        desktopIconBlog: {
          name: 'Dev Blog', ext: '.url', type: 'Shortcut',
          desc: 'Tistory ê°œë°œ ë¸”ë¡œê·¸ ë°”ë¡œê°€ê¸°',
          location: 'https://doyoucode.tistory.com',
          url: 'https://doyoucode.tistory.com/category',
          size: 'â€”', disk: 'â€”',
          created: '2025-01-15', modified: '2026-02-27',
          owner: 'doyoucode', group: 'staff',
          permissions: 'Read-only', version: 'â€”',
          iconBg: 'linear-gradient(145deg,#ff6320 0%,#e8501a 100%)',
          iconBorder: 'rgba(255,140,80,0.4)', iconColor: '#fff', iconChar: 'T',
          action: function() { if (window.dyoOpenBrowser) window.dyoOpenBrowser('/category'); }
        },
        desktopIconGithub: {
          name: 'GitHub', ext: '.url', type: 'Shortcut',
          desc: 'GitHub í”„ë¡œí•„ í˜ì´ì§€ (ì™¸ë¶€ ë§í¬)',
          location: 'https://github.com/doyoungkim-code',
          url: 'https://github.com/doyoungkim-code',
          size: 'â€”', disk: 'â€”',
          created: '2025-01-15', modified: '2026-02-27',
          owner: 'doyoucode', group: 'staff',
          permissions: 'Read-only', version: 'â€”',
          iconBg: 'linear-gradient(145deg,#24292e 0%,#1a1e22 100%)',
          iconBorder: 'rgba(139,148,158,0.3)', iconColor: '#fff', iconChar: 'âŒ¥G',
          action: function() { if (window.dyoOpenExternal) window.dyoOpenExternal('https://github.com/doyoungkim-code'); }
        },
        desktopIconGuest: {
          name: 'Guestbook', ext: '.app', type: 'Application',
          desc: 'ë°©ëª…ë¡ ì±„íŒ… ì• í”Œë¦¬ì¼€ì´ì…˜',
          location: '/home/doyoucode/guestbook',
          size: 'â€”', disk: 'â€”',
          created: '2025-01-15', modified: '2026-02-27',
          owner: 'doyoucode', group: 'staff',
          permissions: 'Read / Write', version: '1.2.0',
          iconBg: 'linear-gradient(145deg,#fffbe0 0%,#fff3a0 100%)',
          iconBorder: 'rgba(200,168,0,0.4)', iconColor: '#c8a800', iconChar: 'ğŸ’¬',
          action: function() { if (window.dyoOpenGuest) window.dyoOpenGuest(); }
        },
        desktopIconExplorer: {
          name: 'File Explorer', ext: '.app', type: 'Application',
          desc: 'ë¸”ë¡œê·¸ ì¹´í…Œê³ ë¦¬ íƒìƒ‰ê¸°',
          location: '/usr/bin/explorer',
          size: 'â€”', disk: 'â€”',
          created: '2025-01-15', modified: '2026-02-27',
          owner: 'root', group: 'wheel',
          permissions: 'Read / Execute', version: '1.0.0',
          iconBg: 'linear-gradient(145deg,#fffbe0 0%,#fde68a 100%)',
          iconBorder: 'rgba(240,163,10,0.4)', iconColor: '#f0a30a', iconChar: 'ğŸ“‚',
          action: function() { if (window.dyoOpenExplorer) window.dyoOpenExplorer(); }
        },
        desktopIconGallery: {
          name: 'Blogram', ext: '.app', type: 'Application',
          desc: 'Instagram ìŠ¤íƒ€ì¼ ì‚¬ì§„ í”¼ë“œ. í”„ë¡œí•„ í—¤ë”(ê²Œì‹œë¬¼Â·íŒ”ë¡œì›ŒÂ·íŒ”ë¡œì‰), 3ì—´ ê·¸ë¦¬ë“œ, ë¼ì´íŠ¸ë°•ìŠ¤(ì¢‹ì•„ìš”Â·ëŒ“ê¸€Â·ê³µìœ ) ì§€ì›.',
          location: '/home/doyoucode/blogram',
          size: 'â€”', disk: 'â€”',
          created: '2026-02-28', modified: '2026-03-01',
          owner: 'doyoucode', group: 'staff',
          permissions: 'Read-only', version: '2.0.0',
          iconBg: 'linear-gradient(145deg,#fff0f6 0%,#fcd6e8 100%)',
          iconBorder: 'rgba(255,120,180,0.4)', iconColor: '#ff78b4', iconChar: 'ğŸ“·',
          action: function() { if (window.dyoOpenGallery) window.dyoOpenGallery(); }
        }
      };

      // ë©”ë‰´ ì•„ì´í…œ ë™ì  ë¹Œë“œ
      function buildMenu(items) {
        menu.innerHTML = '';
        items.forEach(function(item) {
          if (item === 'sep') {
            var sep = document.createElement('div');
            sep.className = 'dyo-ctx-sep';
            menu.appendChild(sep);
          } else {
            var el = document.createElement('button');
            el.className = 'dyo-ctx-item' +
              (item.disabled ? ' disabled' : '') +
              (item.danger   ? ' danger'   : '');
            el.textContent = item.label;
            el.dataset.action = item.action || '';
            if (item.disabled) el.setAttribute('disabled', '');
            menu.appendChild(el);
          }
        });
      }

      function showMenu(x, y) {
        menu.classList.add('show');
        var mw = menu.offsetWidth  || 180;
        var mh = menu.offsetHeight || 200;
        var px = Math.min(x, window.innerWidth  - mw - 8);
        var py = Math.min(y, window.innerHeight - mh - 8);
        menu.style.left = px + 'px';
        menu.style.top  = py + 'px';
      }

      function hideMenu() { menu.classList.remove('show'); }

      function showProps(meta) {
        if (window.dyoOpenProps) window.dyoOpenProps(meta);
      }

      var currentCtx = null;

      // ë°ìŠ¤í¬íƒ‘ ìš°í´ë¦­ â€” 3ê°€ì§€ ì¼€ì´ìŠ¤
      desktop.addEventListener('contextmenu', function(e) {
        if (e.target.closest('.dyo-shell-win, .dyo-browser-win')) return;
        e.preventDefault();

        var iconEl  = e.target.closest('.dyo-desktop-icon');
        var taskBtn = e.target.closest('.dyo-taskbtn');

        if (iconEl) {
          // â”€â”€ ì•„ì´ì½˜ ìš°í´ë¦­
          var meta = iconMeta[iconEl.id];
          currentCtx = { type: 'icon', meta: meta };
          buildMenu([
            { label: 'Open',       action: 'icon-open' },
            'sep',
            { label: 'Properties', action: 'icon-props', disabled: !meta }
          ]);

        } else if (taskBtn) {
          // â”€â”€ íƒœìŠ¤í¬ë°” ë²„íŠ¼ ìš°í´ë¦­
          var winId  = taskBtn.dataset.winId;
          var winEl  = winId ? document.getElementById(winId) : null;
          var isOpen = !!(winEl && winEl.classList.contains('open'));
          var isMini = !!(winEl && winEl.classList.contains('minimized'));
          currentCtx = { type: 'task', winEl: winEl };
          buildMenu([
            { label: 'Bring to Front', action: 'task-front',    disabled: !isOpen },
            { label: 'Minimize',       action: 'task-minimize', disabled: !isOpen || isMini },
            'sep',
            { label: 'Close',          action: 'task-close', danger: true, disabled: !isOpen }
          ]);

        } else {
          // â”€â”€ ë°°ê²½ ìš°í´ë¦­
          currentCtx = { type: 'bg' };
          buildMenu([
            { label: 'New Terminal',       action: 'terminal'  },
            { label: 'Open README',        action: 'readme'    },
            { label: 'Open Guestbook',     action: 'guestbook' },
            { label: 'Dev Blog',           action: 'blog'      },
            { label: 'Open File Explorer', action: 'explorer'  },
            { label: 'Open Blogram',       action: 'gallery'   },
            'sep',
            { label: 'Tutorial',           action: 'tutorial'  },
            { label: 'Refresh Desktop',    action: 'refresh'   }
          ]);
        }

        showMenu(e.clientX, e.clientY);
      });

      // ë©”ë‰´ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
      document.addEventListener('mousedown', function(e) {
        if (!menu.contains(e.target)) hideMenu();
      });

      // ESC ë‹«ê¸°
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          hideMenu();
        }
      });

      // ë©”ë‰´ ì•„ì´í…œ ì‹¤í–‰
      menu.addEventListener('click', function(e) {
        var item = e.target.closest('.dyo-ctx-item');
        if (!item || item.hasAttribute('disabled')) return;
        hideMenu();
        var action = item.dataset.action;
        var ctx = currentCtx;
        switch (action) {
          // ì•„ì´ì½˜
          case 'icon-open':
            if (ctx && ctx.meta && ctx.meta.action) ctx.meta.action();
            break;
          case 'icon-props':
            if (ctx && ctx.meta) showProps(ctx.meta);
            break;
          // íƒœìŠ¤í¬ë°”
          case 'task-front':
            if (ctx && ctx.winEl) {
              var tb2 = document.querySelector('.dyo-taskbtn[data-win-id="' + ctx.winEl.id + '"]');
              window._dyoAnimSrc = tb2 || null;
              ctx.winEl.classList.remove('minimized');
              window._dyoZTop = (window._dyoZTop || 9000) + 1;
              ctx.winEl.style.zIndex = window._dyoZTop;
              if (window.dyoAnimOpen) window.dyoAnimOpen(ctx.winEl);
            }
            break;
          case 'task-minimize':
            if (ctx && ctx.winEl) {
              if (window.dyoAnimMinimize) {
                window.dyoAnimMinimize(ctx.winEl, function() { ctx.winEl.classList.add('minimized'); });
              } else {
                ctx.winEl.classList.add('minimized');
              }
            }
            break;
          case 'task-close':
            if (ctx && ctx.winEl) {
              if (window.dyoAnimDismiss) {
                window.dyoAnimDismiss(ctx.winEl, function() { ctx.winEl.classList.remove('open', 'minimized', 'maximized'); });
              } else {
                ctx.winEl.classList.remove('open', 'minimized', 'maximized');
              }
            }
            break;
          // ë°°ê²½
          case 'terminal':  if (window.dyoOpenShell)    window.dyoOpenShell();              break;
          case 'readme':    if (window.dyoOpenReadme)  window.dyoOpenReadme();             break;
          case 'guestbook': if (window.dyoOpenGuest)   window.dyoOpenGuest();              break;
          case 'blog':      if (window.dyoOpenBrowser) window.dyoOpenBrowser('/category'); break;
          case 'explorer':  if (window.dyoOpenExplorer) window.dyoOpenExplorer();          break;
          case 'gallery':   if (window.dyoOpenGallery)  window.dyoOpenGallery();          break;
          case 'tutorial':  if (window.dyoStartTutorial) window.dyoStartTutorial();         break;
          case 'refresh':   location.reload();                                             break;
          // Explorer ì•„ì´í…œ
          case 'exp-open':
            if (ctx && ctx.openFn) ctx.openFn();
            break;
          case 'exp-browser':
            if (ctx && ctx.child && ctx.child.url) {
              if (window.dyoOpenBrowser) window.dyoOpenBrowser(ctx.child.url);
            }
            break;
          case 'exp-props':
            if (ctx && ctx.child) {
              var ec = ctx.child;
              var isFolder = ctx.isFolder;
              showProps({
                name: ec.label,
                ext: isFolder ? '' : '.html',
                type: isFolder ? 'Folder' : 'Article',
                desc: ec.label + (isFolder ? ' ì¹´í…Œê³ ë¦¬ í´ë”' : ' ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ì¹´í…Œê³ ë¦¬'),
                location: ec.url || '/',
                size: 'â€”', disk: 'â€”',
                created: 'â€”', modified: 'â€”',
                owner: 'doyoucode', group: 'staff',
                permissions: 'Read-only', version: 'â€”',
                iconBg: isFolder ? 'linear-gradient(145deg,#1c2128 0%,#161b22 100%)' : 'linear-gradient(145deg,#1c2128 0%,#161b22 100%)',
                iconBorder: '#30363d', iconColor: '#c9d1d9',
                iconChar: ec.icon || (isFolder ? 'ğŸ“‚' : 'ğŸ“„')
              });
            }
            break;
        }
      });

      // Explorer ì•„ì´í…œ ìš°í´ë¦­ìš© ê¸€ë¡œë²Œ í•¨ìˆ˜
      window.dyoShowExpItemCtx = function(child, openFn, x, y) {
        var isFolder = !!(child.children && child.children.length);
        currentCtx = { type: 'exp-item', child: child, isFolder: isFolder, openFn: openFn };
        var items = [
          { label: isFolder ? 'ğŸ“‚ Open Folder' : 'ğŸŒ Open in Browser', action: 'exp-open' }
        ];
        if (isFolder && child.url) {
          items.push({ label: 'ğŸŒ Open in Browser', action: 'exp-browser' });
        }
        items.push('sep');
        items.push({ label: 'Properties', action: 'exp-props' });
        buildMenu(items);
        showMenu(x, y);
      };
    })();

    // ============================================================
    // Properties Window
    // ============================================================
    (function() {
      var w        = document.getElementById('dyoPropsWin');
      var titlebar = document.getElementById('dyoPropsTitlebar');
      var closeBtn = document.getElementById('dyoPropsClose');
      var minBtn   = document.getElementById('dyoPropsMin');
      var maxBtn   = document.getElementById('dyoPropsMax');
      var titleEl  = document.getElementById('dyoPropsTitle');
      var bodyEl   = document.getElementById('dyoPropsBody');
      if (!w || !titlebar) return;

      var prevRect = null;

      // í’ë¶€í•œ ì†ì„± ë‚´ìš© ë¹Œë“œ
      function buildContent(meta) {
        var today = new Date().toISOString().slice(0, 10);
        var h = '';

        // ì•„ì´ì½˜ í—¤ë”
        h += '<div class="dyo-props-icon-hdr">';
        h += '<div class="dyo-props-icon-box" style="background:' + meta.iconBg + ';border:1px solid ' + meta.iconBorder + ';">';
        h += '<span style="color:' + meta.iconColor + '">' + (meta.iconChar || '?') + '</span>';
        h += '</div>';
        h += '<div class="dyo-props-icon-name">' + meta.name + (meta.ext || '') + '</div>';
        h += '<div class="dyo-props-type-badge">' + meta.type + '</div>';
        h += '</div>';

        // General
        h += '<div class="dyo-props-section">';
        h += '<div class="dyo-props-section-title">General</div>';
        h += row('Name',        meta.name + (meta.ext || ''));
        h += row('Type',        meta.type);
        h += row('Description', meta.desc);
        h += row('Location',    meta.location, 'accent');
        if (meta.url) h += row('URL', meta.url, 'accent');
        h += '</div>';

        // Storage
        h += '<div class="dyo-props-section">';
        h += '<div class="dyo-props-section-title">Storage</div>';
        h += row('Size',    meta.size || 'â€”');
        h += row('On disk', meta.disk || 'â€”');
        h += '</div>';

        // Dates
        h += '<div class="dyo-props-section">';
        h += '<div class="dyo-props-section-title">Dates</div>';
        h += row('Created',  meta.created  || today);
        h += row('Modified', meta.modified || today);
        h += row('Accessed', today, 'green');
        h += '</div>';

        // Details
        h += '<div class="dyo-props-section">';
        h += '<div class="dyo-props-section-title">Details</div>';
        h += row('Owner',       meta.owner       || 'â€”');
        h += row('Group',       meta.group       || 'â€”');
        h += row('Permissions', meta.permissions || 'â€”');
        if (meta.version && meta.version !== 'â€”') h += row('Version', meta.version);
        h += row('Encoding',    'UTF-8');
        h += row('Platform',    'Web / Browser');
        h += '</div>';

        return h;
      }

      function row(key, val, cls) {
        return '<div class="dyo-props-row">' +
          '<span class="dyo-props-key">' + key + '</span>' +
          '<span class="dyo-props-val' + (cls ? ' ' + cls : '') + '">' + val + '</span>' +
          '</div>';
      }

      function openProps(meta) {
        var wasOpen = w.classList.contains('open');
        window._dyoLastPropsMeta = meta;
        titleEl.textContent = meta.name + ' â€” Properties';
        bodyEl.innerHTML = buildContent(meta);
        w.classList.remove('minimized', 'maximized');
        w.classList.add('open');
        bringToFront();
        if (!wasOpen && window.dyoAnimOpen) window.dyoAnimOpen(w);
      }

      function closeProps() {
        if (window.dyoAnimDismiss) {
          window.dyoAnimDismiss(w, function() { w.classList.remove('open', 'minimized', 'maximized'); });
        } else {
          w.classList.remove('open', 'minimized', 'maximized');
        }
      }
      function minimizeProps() {
        if (w.classList.contains('minimized')) {
          var tb = document.querySelector('.dyo-taskbtn[data-win-id="dyoPropsWin"]');
          window._dyoAnimSrc = tb || null;
          w.classList.remove('minimized');
          if (window.dyoAnimOpen) window.dyoAnimOpen(w);
        } else {
          if (window.dyoAnimMinimize) {
            window.dyoAnimMinimize(w, function() { w.classList.add('minimized'); });
          } else {
            w.classList.add('minimized');
          }
        }
      }
      function maximizeProps() {
        if (w.classList.contains('maximized')) {
          if (prevRect) {
            w.style.left = prevRect.l + 'px'; w.style.top    = prevRect.t + 'px';
            w.style.width = prevRect.w + 'px'; w.style.height = prevRect.h + 'px';
          }
          w.classList.remove('maximized');
          if (window.dyoAnimMaximizeOut) window.dyoAnimMaximizeOut(w);
        } else {
          w.classList.remove('minimized');
          var r = w.getBoundingClientRect();
          prevRect = { l: r.left, t: r.top, w: r.width, h: r.height };
          w.style.left = ''; w.style.top = ''; w.style.width = ''; w.style.height = '';
          w.classList.add('maximized');
          if (window.dyoAnimMaximizeIn) window.dyoAnimMaximizeIn(w);
        }
      }
      function bringToFront() {
        window._dyoZTop = (window._dyoZTop || 9000) + 1;
        w.style.zIndex = window._dyoZTop;
      }

      window.dyoOpenProps = openProps;

      w.addEventListener('mousedown', bringToFront);
      if (closeBtn) closeBtn.addEventListener('click', closeProps);
      if (minBtn)   minBtn.addEventListener('click',   minimizeProps);
      if (maxBtn)   maxBtn.addEventListener('click',   maximizeProps);

      titlebar.addEventListener('dblclick', function(e) {
        if (e.target === closeBtn || e.target === minBtn || e.target === maxBtn) return;
        maximizeProps();
      });

      // ë“œë˜ê·¸
      titlebar.addEventListener('mousedown', function(e) {
        if (w.classList.contains('maximized')) return;
        if (e.target === closeBtn || e.target === minBtn || e.target === maxBtn) return;
        var r = w.getBoundingClientRect();
        w.style.left = r.left + 'px'; w.style.top = r.top + 'px';
        var ox = e.clientX - r.left, oy = e.clientY - r.top;
        function onMove(ev) { w.style.left = (ev.clientX - ox) + 'px'; w.style.top = (ev.clientY - oy) + 'px'; }
        function onUp()    { document.removeEventListener('mousemove', onMove); document.removeEventListener('mouseup', onUp); }
        document.addEventListener('mousemove', onMove);
        document.addEventListener('mouseup', onUp);
      });

      // ë¦¬ì‚¬ì´ì¦ˆ
      w.querySelectorAll('.dyo-brs-handle').forEach(function(handle) {
        handle.addEventListener('mousedown', function(e) {
          if (w.classList.contains('maximized')) return;
          e.preventDefault(); e.stopPropagation();
          var dir = handle.className.replace('dyo-brs-handle', '').trim();
          var r = w.getBoundingClientRect();
          var sx = e.clientX, sy = e.clientY;
          var sl = r.left, st = r.top, sw = r.width, sh = r.height;
          function onMove(ev) {
            var dx = ev.clientX - sx, dy = ev.clientY - sy;
            var nl = sl, nt = st, nw = sw, nh = sh;
            if (dir.includes('e')) nw = Math.max(260, sw + dx);
            if (dir.includes('s')) nh = Math.max(200, sh + dy);
            if (dir.includes('w')) { nw = Math.max(260, sw - dx); nl = sl + sw - nw; }
            if (dir.includes('n')) { nh = Math.max(200, sh - dy); nt = st + sh - nh; }
            w.style.width = nw + 'px'; w.style.height = nh + 'px';
            w.style.left  = nl + 'px'; w.style.top    = nt + 'px';
          }
          function onUp() { document.removeEventListener('mousemove', onMove); document.removeEventListener('mouseup', onUp); }
          document.addEventListener('mousemove', onMove);
          document.addEventListener('mouseup', onUp);
        });
      });
    })();

    // ============================================================
    // File Explorer Window
    // ============================================================
    (function() {
      var w        = document.getElementById('dyoExplorerWin');
      var titlebar = document.getElementById('dyoExplorerTitlebar');
      var closeBtn = document.getElementById('dyoExplorerClose');
      var minBtn   = document.getElementById('dyoExplorerMin');
      var maxBtn   = document.getElementById('dyoExplorerMax');
      var treeEl   = document.getElementById('dyoExplorerTree');
      var mainEl   = document.getElementById('dyoExplorerMain');
      if (!w || !titlebar) return;

      var prevRect  = null;
      var treeBuilt = false;
      var viewMode  = 'grid'; // 'grid' | 'list'

      // ë·° ì „í™˜ ë²„íŠ¼
      var viewGridBtn = document.getElementById('dyoExpViewGrid');
      var viewListBtn = document.getElementById('dyoExpViewList');
      function setViewMode(mode) {
        viewMode = mode;
        if (viewGridBtn) viewGridBtn.classList.toggle('active', mode === 'grid');
        if (viewListBtn) viewListBtn.classList.toggle('active', mode === 'list');
        // í˜„ì¬ ìœ„ì¹˜ ë‹¤ì‹œ ë Œë”ë§
        if (navIdx >= 0 && navHistory[navIdx]) {
          var e = navHistory[navIdx];
          renderMain(e.node, e.ancestors);
        }
      }
      if (viewGridBtn) viewGridBtn.addEventListener('click', function() { setViewMode('grid'); });
      if (viewListBtn) viewListBtn.addEventListener('click', function() { setViewMode('list'); });

      // íƒìƒ‰ íˆìŠ¤í† ë¦¬
      var navHistory = [];
      var navIdx     = -1;
      var backBtn    = document.getElementById('dyoExpBack');
      var fwdBtn     = document.getElementById('dyoExpForward');
      var addrBar    = document.getElementById('dyoExpAddrBar');

      // ì¹´í…Œê³ ë¦¬ íŠ¸ë¦¬ ì •ì˜
      var tree = [
        { label: 'Project', icon: 'ğŸ“‚', url: '/category/Project', children: [
          { label: 'Dev Log',    icon: 'ğŸ“', url: '/category/Project/Dev%20Log' },
          { label: 'Retrospect', icon: 'ğŸ“', url: '/category/Project/Retrospect' }
        ]},
        { label: 'Backend', icon: 'â˜•', url: '/category/Backend', children: [
          { label: 'Java',        icon: 'â˜•', url: '/category/Backend/Java' },
          { label: 'Spring Boot', icon: 'ğŸƒ', url: '/category/Backend/Spring%20Boot' },
          { label: 'Database',    icon: 'ğŸ’¾', url: '/category/Backend/Database' }
        ]},
        { label: 'Frontend', icon: 'ğŸ¨', url: '/category/Frontend', children: [
          { label: 'Mobile', icon: 'ğŸ“±', url: '/category/Frontend/Mobile' },
          { label: 'Web',    icon: 'ğŸŒ', url: '/category/Frontend/Web' }
        ]},
        { label: 'CS & Engineering', icon: 'ğŸ’»', url: '/category/CS%20&%20Engineering', children: [
          { label: 'C',                icon: 'ğŸ“—', url: '/category/CS%20&%20Engineering/C' },
          { label: 'Algorithm',        icon: 'ğŸ“', url: '/category/CS%20&%20Engineering/Algorithm' },
          { label: 'Computer Science', icon: 'ğŸ“š', url: '/category/CS%20&%20Engineering/Computer%20Science' },
          { label: 'Infra & Tools',    icon: 'ğŸ§±', url: '/category/CS%20&%20Engineering/Infra%20&%20Tools' }
        ]},
        { label: 'Growth', icon: 'ğŸŒ±', url: '/category/Growth', children: [
          { label: 'Certifications', icon: 'ğŸ“œ', url: '/category/Growth/Certifications' },
          { label: 'English',        icon: 'ğŸ“–', url: '/category/Growth/English' },
          { label: 'Books',          icon: 'ğŸ“š', url: '/category/Growth/Books' },
          { label: 'Documents',      icon: 'ğŸ“‘', url: '/category/Growth/Documents' },
          { label: 'etc',            icon: 'ğŸ“„', url: '/category/Growth/etc' }
        ]}
      ];

      // rootNode ì •ì˜ (íŠ¸ë¦¬ ì •ì˜ ì´í›„ì— ìœ„ì¹˜í•´ì•¼ í•¨)
      var rootNode = { label: 'Blog Root', icon: 'ğŸ“‚', url: '/category', children: tree };

      function bringToFront() {
        window._dyoZTop = (window._dyoZTop || 9000) + 1;
        w.style.zIndex = window._dyoZTop;
      }

      // ë…¸ë“œ â†’ ë£¨íŠ¸ë¶€í„°ì˜ ì¡°ìƒ ë°°ì—´ íƒìƒ‰
      function findAncestors(nodes, target, path) {
        for (var i = 0; i < nodes.length; i++) {
          var p = path.concat([nodes[i]]);
          if (nodes[i] === target) return p;
          if (nodes[i].children) {
            var r = findAncestors(nodes[i].children, target, p);
            if (r) return r;
          }
        }
        return null;
      }

      // ë’¤ë¡œ/ì•ìœ¼ë¡œ ë²„íŠ¼ ìƒíƒœ ê°±ì‹ 
      function updateNavBtns() {
        if (backBtn) backBtn.disabled = navIdx <= 0;
        if (fwdBtn)  fwdBtn.disabled  = navIdx >= navHistory.length - 1;
      }

      // ì£¼ì†Œì°½ ë¸Œë ˆë“œí¬ëŸ¼ ê°±ì‹ 
      function updateAddrBar(ancestors) {
        if (!addrBar) return;
        addrBar.innerHTML = '';
        ancestors.forEach(function(node, i) {
          var isLast = i === ancestors.length - 1;
          var crumb = document.createElement('span');
          crumb.className = 'dyo-exp-crumb' + (isLast ? ' current' : '');
          crumb.textContent = node.icon + '\u00a0' + node.label;
          if (!isLast) {
            (function(n, idx) {
              crumb.addEventListener('click', function() {
                navigate(n, ancestors.slice(0, idx + 1));
              });
            })(node, i);
          }
          addrBar.appendChild(crumb);
          if (!isLast) {
            var sep = document.createElement('span');
            sep.className = 'dyo-exp-crumb-sep';
            sep.textContent = 'â€º';
            addrBar.appendChild(sep);
          }
        });
      }

      // íƒìƒ‰: íˆìŠ¤í† ë¦¬ì— ì¶”ê°€í•˜ê³  ë Œë”ë§
      function navigate(node, ancestors) {
        navHistory = navHistory.slice(0, navIdx + 1);
        navHistory.push({ node: node, ancestors: ancestors });
        navIdx = navHistory.length - 1;
        renderMain(node, ancestors);
        updateAddrBar(ancestors);
        updateNavBtns();
      }

      // ë©”ì¸ íŒ¨ë„ ë Œë”ë§ (DOM ê¸°ë°˜ â€” í´ë¡œì €ë¡œ ë…¸ë“œ ì°¸ì¡° ìœ ì§€)
      function renderMain(node, ancestors) {
        mainEl.innerHTML = '';
        var curAncestors = ancestors || [rootNode];

        if (node.children && node.children.length > 0) {

          // â”€â”€ ê³µí†µ ì´ë²¤íŠ¸ ë°”ì¸ë”© í—¬í¼ â”€â”€
          function bindItem(el, c) {
            var openFn = c.children && c.children.length
              ? function() { navigate(c, curAncestors.concat([c])); }
              : function() { if (window.dyoOpenBrowser) window.dyoOpenBrowser(c.url); };
            el.addEventListener('click', openFn);
            el.addEventListener('contextmenu', function(e) {
              e.preventDefault(); e.stopPropagation();
              if (window.dyoShowExpItemCtx) window.dyoShowExpItemCtx(c, openFn, e.clientX, e.clientY);
            });
          }

          if (viewMode === 'list') {
            // â”€â”€ List ë·° â”€â”€
            var list = document.createElement('div');
            list.className = 'dyo-explorer-list';

            // í—¤ë”
            var hdr = document.createElement('div');
            hdr.className = 'dyo-exp-list-header';
            hdr.innerHTML = '<span></span><span>Name</span><span>Type</span><span style="text-align:right">Items</span>';
            list.appendChild(hdr);

            node.children.forEach(function(child) {
              var isDir = child.children && child.children.length;
              var row = document.createElement('div');
              row.className = 'dyo-exp-list-item';
              row.innerHTML =
                '<span class="dyo-exp-list-icon">' + child.icon + '</span>' +
                '<span class="dyo-exp-list-name">' + child.label + '</span>' +
                '<span class="dyo-exp-list-type">' + (isDir ? 'Folder' : 'Category') + '</span>' +
                '<span class="dyo-exp-list-count">' + (isDir ? child.children.length : 'â€”') + '</span>';
              (function(c) { bindItem(row, c); })(child);
              list.appendChild(row);
            });

            mainEl.appendChild(list);

          } else {
            // â”€â”€ Grid ë·° â”€â”€
            var grid = document.createElement('div');
            grid.className = 'dyo-explorer-grid';

            node.children.forEach(function(child) {
              var item = document.createElement('div');
              item.className = 'dyo-exp-item';
              item.innerHTML =
                '<div class="dyo-exp-item-icon">' + child.icon + '</div>' +
                '<div class="dyo-exp-item-label">' + child.label + '</div>';
              (function(c) { bindItem(item, c); })(child);
              grid.appendChild(item);
            });

            mainEl.appendChild(grid);
          }

        } else {
          // ë¦¬í”„ ë‹¨ë… í‘œì‹œ
          var empty = document.createElement('div');
          empty.className = 'dyo-exp-empty';
          empty.innerHTML =
            '<div style="font-size:40px;margin-bottom:8px;">' + node.icon + '</div>' +
            '<div style="color:#8b949e;font-size:12px;margin-bottom:14px;">' + node.label + '</div>';
          var openBtn = document.createElement('button');
          openBtn.className = 'dyo-exp-open-btn';
          openBtn.textContent = 'Open in Browser \u2192';
          openBtn.addEventListener('click', function() {
            if (window.dyoOpenBrowser) window.dyoOpenBrowser(node.url);
          });
          empty.appendChild(openBtn);
          mainEl.appendChild(empty);
        }
      }

      // íŠ¸ë¦¬ ë¹Œë“œ
      function buildTreeNodes(nodes, depth, parentEl, setActive) {
        nodes.forEach(function(node) {
          var hasChildren = !!(node.children && node.children.length);
          var wrapper = document.createElement('div');

          var item = document.createElement('div');
          item.className = 'dyo-tree-item';
          item.style.paddingLeft = (8 + depth * 14) + 'px';

          var arrow = document.createElement('span');
          arrow.className = 'dyo-tree-arrow';
          arrow.textContent = hasChildren ? 'â–¶' : '\u00a0';

          var label = document.createElement('span');
          label.textContent = node.icon + '\u00a0' + node.label;

          item.appendChild(arrow);
          item.appendChild(label);
          wrapper.appendChild(item);

          var childrenEl = null;
          if (hasChildren) {
            childrenEl = document.createElement('div');
            childrenEl.className = 'dyo-tree-children collapsed';
            buildTreeNodes(node.children, depth + 1, childrenEl, setActive);
            wrapper.appendChild(childrenEl);
          }

          item.addEventListener('click', function(e) {
            e.stopPropagation();
            // active ì—…ë°ì´íŠ¸
            treeEl.querySelectorAll('.dyo-tree-item').forEach(function(el) { el.classList.remove('active'); });
            item.classList.add('active');
            var ancs = findAncestors([rootNode], node, []) || [rootNode, node];
            navigate(node, ancs);
            if (hasChildren && childrenEl) {
              var collapsed = childrenEl.classList.contains('collapsed');
              childrenEl.classList.toggle('collapsed');
              arrow.textContent = collapsed ? 'â–¼' : 'â–¶';
              arrow.classList.toggle('open', collapsed);
            }
          });

          parentEl.appendChild(wrapper);
        });
      }

      function buildTree() {
        if (treeBuilt) return;
        treeBuilt = true;

        // Root í•­ëª©
        var rootItem = document.createElement('div');
        rootItem.className = 'dyo-tree-item active';
        rootItem.style.paddingLeft = '8px';
        rootItem.innerHTML = '<span class="dyo-tree-arrow open">â–¼</span><span>ğŸ“‚\u00a0Blog Root</span>';

        var rootChildren = document.createElement('div');
        rootChildren.className = 'dyo-tree-children';
        buildTreeNodes(tree, 1, rootChildren, null);

        treeEl.appendChild(rootItem);
        treeEl.appendChild(rootChildren);

        rootItem.addEventListener('click', function() {
          treeEl.querySelectorAll('.dyo-tree-item').forEach(function(el) { el.classList.remove('active'); });
          rootItem.classList.add('active');
          navigate(rootNode, [rootNode]);
          var isCollapsed = rootChildren.classList.toggle('collapsed');
          var arrow = rootItem.querySelector('.dyo-tree-arrow');
          if (arrow) {
            arrow.textContent = isCollapsed ? 'â–¶' : 'â–¼';
            arrow.classList.toggle('open', !isCollapsed);
          }
        });

        navigate(rootNode, [rootNode]);
      }

      function openExplorer() {
        var wasOpen = w.classList.contains('open');
        if (!wasOpen) {
          var W = 680, H = 480;
          var left = Math.max(10, Math.round((window.innerWidth  - W) / 2));
          var top  = Math.max(10, Math.round((window.innerHeight - H) / 2));
          w.style.width  = W + 'px';
          w.style.height = H + 'px';
          w.style.left   = left + 'px';
          w.style.top    = top  + 'px';
          // ì¬ì˜¤í”ˆ ì‹œ íˆìŠ¤í† ë¦¬ ì´ˆê¸°í™”
          navHistory = [];
          navIdx     = -1;
        }
        w.classList.remove('minimized', 'maximized');
        w.classList.add('open');
        bringToFront();
        if (!treeBuilt) {
          buildTree();         // ì²« ì˜¤í”ˆ: íŠ¸ë¦¬ ë¹Œë“œ + navigate(rootNode) í¬í•¨
        } else if (!wasOpen) {
          navigate(rootNode, [rootNode]); // ì¬ì˜¤í”ˆ: rootë¡œ ì´ë™
        }
        if (!wasOpen && window.dyoAnimOpen) window.dyoAnimOpen(w);
      }

      // ë’¤ë¡œê°€ê¸°
      if (backBtn) backBtn.addEventListener('click', function() {
        if (navIdx > 0) {
          navIdx--;
          var entry = navHistory[navIdx];
          renderMain(entry.node, entry.ancestors);
          updateAddrBar(entry.ancestors);
          updateNavBtns();
        }
      });

      // ì•ìœ¼ë¡œê°€ê¸°
      if (fwdBtn) fwdBtn.addEventListener('click', function() {
        if (navIdx < navHistory.length - 1) {
          navIdx++;
          var entry = navHistory[navIdx];
          renderMain(entry.node, entry.ancestors);
          updateAddrBar(entry.ancestors);
          updateNavBtns();
        }
      });

      window.dyoOpenExplorer = openExplorer;

      w.addEventListener('mousedown', bringToFront);
      if (closeBtn) closeBtn.addEventListener('click', function() {
        if (window.dyoAnimDismiss) {
          window.dyoAnimDismiss(w, function() { w.classList.remove('open', 'minimized', 'maximized'); });
        } else {
          w.classList.remove('open', 'minimized', 'maximized');
        }
      });
      if (minBtn) minBtn.addEventListener('click', function() {
        if (w.classList.contains('minimized')) {
          var tb = document.querySelector('.dyo-taskbtn[data-win-id="dyoExplorerWin"]');
          window._dyoAnimSrc = tb || null;
          w.classList.remove('minimized');
          if (window.dyoAnimOpen) window.dyoAnimOpen(w);
        } else {
          if (window.dyoAnimMinimize) {
            window.dyoAnimMinimize(w, function() { w.classList.add('minimized'); });
          } else {
            w.classList.add('minimized');
          }
        }
      });
      if (maxBtn)   maxBtn.addEventListener('click', function() {
        if (w.classList.contains('maximized')) {
          if (prevRect) {
            w.style.left = prevRect.l + 'px'; w.style.top    = prevRect.t + 'px';
            w.style.width = prevRect.w + 'px'; w.style.height = prevRect.h + 'px';
          }
          w.classList.remove('maximized');
          if (window.dyoAnimMaximizeOut) window.dyoAnimMaximizeOut(w);
        } else {
          w.classList.remove('minimized');
          var r = w.getBoundingClientRect();
          prevRect = { l: r.left, t: r.top, w: r.width, h: r.height };
          w.style.left = ''; w.style.top = ''; w.style.width = ''; w.style.height = '';
          w.classList.add('maximized');
          if (window.dyoAnimMaximizeIn) window.dyoAnimMaximizeIn(w);
        }
      });

      titlebar.addEventListener('dblclick', function(e) {
        if (e.target === closeBtn || e.target === minBtn || e.target === maxBtn) return;
        maxBtn.click();
      });

      // ë“œë˜ê·¸
      titlebar.addEventListener('mousedown', function(e) {
        if (w.classList.contains('maximized')) return;
        if (e.target === closeBtn || e.target === minBtn || e.target === maxBtn) return;
        var r = w.getBoundingClientRect();
        w.style.left = r.left + 'px'; w.style.top = r.top + 'px';
        var ox = e.clientX - r.left, oy = e.clientY - r.top;
        function onMove(ev) { w.style.left = (ev.clientX - ox) + 'px'; w.style.top = (ev.clientY - oy) + 'px'; }
        function onUp() { document.removeEventListener('mousemove', onMove); document.removeEventListener('mouseup', onUp); }
        document.addEventListener('mousemove', onMove);
        document.addEventListener('mouseup', onUp);
      });

      // ë¦¬ì‚¬ì´ì¦ˆ
      w.querySelectorAll('.dyo-brs-handle').forEach(function(handle) {
        handle.addEventListener('mousedown', function(e) {
          if (w.classList.contains('maximized')) return;
          e.preventDefault(); e.stopPropagation();
          var dir = handle.className.replace('dyo-brs-handle', '').trim();
          var r = w.getBoundingClientRect();
          var sx = e.clientX, sy = e.clientY;
          var sl = r.left, st = r.top, sw = r.width, sh = r.height;
          function onMove(ev) {
            var dx = ev.clientX - sx, dy = ev.clientY - sy;
            var nl = sl, nt = st, nw = sw, nh = sh;
            if (dir.includes('e')) nw = Math.max(380, sw + dx);
            if (dir.includes('s')) nh = Math.max(250, sh + dy);
            if (dir.includes('w')) { nw = Math.max(380, sw - dx); nl = sl + sw - nw; }
            if (dir.includes('n')) { nh = Math.max(250, sh - dy); nt = st + sh - nh; }
            w.style.width = nw + 'px'; w.style.height = nh + 'px';
            w.style.left  = nl + 'px'; w.style.top    = nt + 'px';
          }
          function onUp() { document.removeEventListener('mousemove', onMove); document.removeEventListener('mouseup', onUp); }
          document.addEventListener('mousemove', onMove);
          document.addEventListener('mouseup', onUp);
        });
      });
    })();
  </script>

  <script>
    // ============================================================
    // Blogram ì°½  (Instagram ìŠ¤íƒ€ì¼ â€” ì§ì ‘ ê´€ë¦¬)
    // ============================================================
    (function() {
      var w             = document.getElementById('dyoGalleryWin');
      var titlebar      = document.getElementById('dyoGalleryTitlebar');
      var closeBtn      = document.getElementById('dyoGalleryClose');
      var minBtn        = document.getElementById('dyoGalleryMin');
      var maxBtn        = document.getElementById('dyoGalleryMax');
      var statusEl      = document.getElementById('dyoGalleryStatus');
      var gridEl        = document.getElementById('dyoGalleryGrid');
      var emptyEl       = document.getElementById('dyoGalleryEmpty');
      var galleryBodyEl = document.getElementById('dyoGalleryBody');
      if (!w) return;

      var GALLERY_PAGE_SIZE = 12;
      var _rendered         = 0;
      var _scrollObserver   = null;

      var prevRect = null;

      function bringToFront() {
        window._dyoZTop = (window._dyoZTop || 9000) + 1;
        w.style.zIndex = window._dyoZTop;
      }

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // GALLERY_CATEGORY: ìë™ìœ¼ë¡œ íŒŒì‹±í•  ì¹´í…Œê³ ë¦¬ ê²½ë¡œ
      //   ì„¤ì •í•˜ë©´ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ í˜ì´ì§€ì˜ ê²Œì‹œê¸€(ì¸ë„¤ì¼ ìˆëŠ” ê²ƒ)ì„ ìë™ìœ¼ë¡œ ê°€ì ¸ì˜´.
      //   ê²Œì‹œê¸€ ì œëª©ì´ ì‚¬ì§„ ì´ë¦„ìœ¼ë¡œ í‘œì‹œë¨.
      //   ë¹ˆ ë¬¸ìì—´('')ë¡œ ì„¤ì •í•˜ë©´ ì•„ë˜ GALLERY_POSTS ë°°ì—´ì„ ì§ì ‘ ì‚¬ìš©.
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      var GALLERY_CATEGORY = '/category/Pictures';

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // GALLERY_POSTS: GALLERY_CATEGORYê°€ ë¹„ì–´ìˆê±°ë‚˜ íŒŒì‹± ì‹¤íŒ¨ ì‹œ ì‚¬ìš©í•˜ëŠ” ìˆ˜ë™ ëª©ë¡
      //   img  : ì´ë¯¸ì§€ URL  (í‹°ìŠ¤í† ë¦¬ ì—…ë¡œë“œ í›„ ë³µì‚¬í•œ CDN URL)
      //   url  : í¬ìŠ¤íŠ¸ URL  (í•´ë‹¹ ë¸”ë¡œê·¸ ê¸€ ì£¼ì†Œ)
      //   title: ê¸€ ì œëª©
      //   date : ë‚ ì§œ (YYYY-MM-DD)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      var GALLERY_POSTS = [];

      // ì¹´í…Œê³ ë¦¬ í˜ì´ì§€ HTMLì„ íŒŒì‹±í•´ í¬ìŠ¤íŠ¸ ëª©ë¡ ì¶”ì¶œ
      function fetchCategoryPosts(path, cb) {
        fetch(path, { credentials: 'include' })
          .then(function(r) { if (!r.ok) throw new Error(); return r.text(); })
          .then(function(html) {
            var parser = new DOMParser();
            var doc    = parser.parseFromString(html, 'text/html');
            var posts  = [];
            doc.querySelectorAll('.list_content').forEach(function(item) {
              var thumbEl = item.querySelector('.thumbnail_post img');
              var linkEl  = item.querySelector('a.thumbnail_post, a.link_post');
              var titleEl = item.querySelector('.tit_post');
              var dateEl  = item.querySelector('.txt_date');
              if (!thumbEl || !linkEl) return; // ì¸ë„¤ì¼ ì—†ëŠ” ê²Œì‹œê¸€ ì œì™¸
              var imgUrl  = thumbEl.getAttribute('src') || '';
              // Tistory CDN URL ê³ í™”ì§ˆ(R1280x0)ë¡œ ì—…ê·¸ë ˆì´ë“œ
              imgUrl = imgUrl.replace(/\/thumb\/R\d+x\d+\//, '/thumb/R1280x0/');
              var postUrl = linkEl.getAttribute('href') || '#';
              // ì ˆëŒ€ URLì´ë©´ pathnameë§Œ ì¶”ì¶œ
              try { postUrl = new URL(postUrl).pathname; } catch(e) {}
              posts.push({
                img:   imgUrl,
                url:   postUrl,
                title: titleEl ? titleEl.textContent.trim() : '',
                date:  dateEl  ? dateEl.textContent.trim()  : ''
              });
            });
            cb(posts);
          })
          .catch(function() { cb(null); });
      }

      // â”€â”€ ë¼ì´íŠ¸ë°•ìŠ¤ (Instagram Style) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      var _photos     = [];
      var _currentIdx = 0;
      var lbEl         = document.getElementById('dyoLightbox');
      var lbBgEl       = document.getElementById('dyoLbBg');
      var lbCloseEl    = document.getElementById('dyoLbClose');
      var lbPrevEl     = document.getElementById('dyoLbPrev');
      var lbNextEl     = document.getElementById('dyoLbNext');
      var lbImgEl      = document.getElementById('dyoLbImg');
      var lbTitleEl    = document.getElementById('dyoLbTitle');
      var lbDateEl     = document.getElementById('dyoLbDate');
      var lbCntEl      = document.getElementById('dyoLbCounter');
      var lbPostLink   = document.getElementById('dyoLbPostLink');
      var lbCopyLink   = document.getElementById('dyoLbCopyLink');
      var lbMenuBtn    = document.getElementById('dyoLbMenuBtn');
      var lbDropdown   = document.getElementById('dyoLbDropdown');
      var lbLikeBtn    = document.getElementById('dyoLbLikeBtn');
      var lbLikesLine  = document.getElementById('dyoLbLikesLine');
      var lbCmtBtn     = document.getElementById('dyoLbCmtBtn');
      var lbShareBtn   = document.getElementById('dyoLbShareBtn');
      var lbCmtStub    = document.getElementById('dyoLbCmtStub');
      var lbCmtInput   = document.getElementById('dyoLbCmtInput');
      var lbCmtName    = document.getElementById('dyoLbCmtName');
      var lbCmtPw      = document.getElementById('dyoLbCmtPw');
      var lbCmtSubmit  = document.getElementById('dyoLbCmtSubmit');
      var lbComposeMeta = document.querySelector('.dyo-lb-ig-compose-meta');

      // â”€â”€ ë¡œê·¸ì¸ ìƒíƒœ ê°ì§€ (ê²ŒìŠ¤íŠ¸ë§Œ ì´ë¦„/ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í‘œì‹œ) â”€â”€â”€â”€â”€â”€
      var _lbLoginState = null; // null=ë¯¸í™•ì¸, true=ë¡œê·¸ì¸ë¨, false=ê²ŒìŠ¤íŠ¸
      var _likeCache = {};     // postId â†’ { liked: bool, count: number }

      function detectLoginState(cb) {
        if (_lbLoginState !== null) { cb(_lbLoginState); return; }
        // â‘  /m/api/me ì‹œë„ (Tistory ë‚´ë¶€ API)
        fetch('/m/api/me', { credentials: 'include', headers: { 'X-Requested-With': 'XMLHttpRequest' } })
          .then(function(r) { if (!r.ok) throw new Error(); return r.json(); })
          .then(function(d) {
            var loggedIn = !!(d && (d.data || d.id || d.userId || d.name || d.blogName));
            _lbLoginState = loggedIn;
            cb(loggedIn);
          })
          .catch(function() {
            // â‘¡ ë°©ëª…ë¡ APIì—ì„œ isRequestUser í™•ì¸ (fallback)
            fetch('/m/api/guestbook?limit=3&reverse=true', { credentials: 'include' })
              .then(function(r) { return r.json(); })
              .then(function(d) {
                var items = (d.data && d.data.items) || [];
                var found = false;
                items.forEach(function(item) {
                  if (item.writer && item.writer.isRequestUser) found = true;
                  (item.children || []).forEach(function(c) {
                    if (c.writer && c.writer.isRequestUser) found = true;
                  });
                });
                _lbLoginState = found;
                cb(found);
              })
              .catch(function() { _lbLoginState = false; cb(false); });
          });
      }

      function updateComposeMeta(isLoggedIn) {
        if (lbComposeMeta) lbComposeMeta.style.display = isLoggedIn ? 'none' : '';
      }

      // â”€â”€ ì¢‹ì•„ìš” (Tistory /reaction API) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function getPostId(url) {
        return ((url || '').match(/\/(\d+)/) || [])[1] || null;
      }

      // JSONì—ì„œ ì¹´ìš´íŠ¸ ì¶”ì¶œ (ì—¬ëŸ¬ í‚¤ ì´ë¦„ ëŒ€ì‘)
      function extractCount(d) {
        if (d == null) return null;
        // Tistory /reaction API ì‘ë‹µ: { reactionCounter: { like, sum, sad } }
        if (d.reactionCounter) {
          var rc = d.reactionCounter;
          var v = rc.like != null ? rc.like : rc.sum;
          if (v != null) return parseInt(v, 10);
        }
        var keys = ['count','likeCount','reactionCount','totalCount','sympathyCount','cnt'];
        for (var i = 0; i < keys.length; i++) {
          if (d[keys[i]] != null) return parseInt(d[keys[i]], 10);
        }
        return null;
      }

      // lbOpen ì‹œ: ìºì‹œ ìš°ì„ , ì—†ìœ¼ë©´ ëª¨ë°”ì¼ API + /reaction GET ë³‘ë ¬ë¡œ liked ì—¬ë¶€ + ì¹´ìš´íŠ¸ ì¡°íšŒ
      function fetchLikeState(postId, postUrl, cb) {
        // ì´ë¯¸ ìºì‹œëœ ìƒíƒœê°€ ìˆìœ¼ë©´ ì¦‰ì‹œ ë°˜í™˜
        if (_likeCache[postId] !== undefined) {
          cb(_likeCache[postId]);
          return;
        }

        var result = { liked: false, count: null };
        var done   = 0;
        function finish() {
          if (++done === 2) {
            _likeCache[postId] = result;
            cb(result);
          }
        }

        // â‘  /m/api/{postId}/reaction â€” ì¹´ìš´íŠ¸ + liked ì—¬ë¶€
        fetch('/m/api/' + postId + '/reaction', {
          credentials: 'include',
          headers: { 'X-Requested-With': 'XMLHttpRequest' }
        })
          .then(function(r) { return r.json(); })
          .then(function(d) {
            var src = d.data || d;
            var c = extractCount(src);
            if (c !== null) result.count = c;
            var liked = !!(src.liked || src.isLiked || src.userLiked || src.myReaction || src.userReaction);
            if (liked) result.liked = true;
            finish();
          })
          .catch(function() { finish(); });

        // â‘¡ GET /reaction?entryId â€” isActive / reactionActivated ë¡œ liked ì—¬ë¶€ í™•ì¸ + ì¹´ìš´íŠ¸
        fetch('/reaction?entryId=' + postId, {
          credentials: 'include',
          headers: { 'X-Requested-With': 'XMLHttpRequest' }
        })
          .then(function(r) { return r.json(); })
          .then(function(d) {
            var src = d.data || d;
            // Tistory GET /reaction ì‘ë‹µ: isActive(bool), reactionActivated("LIKE"|"")
            var liked = !!(src.isActive || src.reactionActivated === 'LIKE' ||
                           src.liked || src.isLiked || src.userReaction || src.myReaction);
            if (liked) result.liked = true;
            var c = extractCount(src);
            if (c !== null && result.count === null) result.count = c;
            finish();
          })
          .catch(function() { finish(); });
      }

      // ì¢‹ì•„ìš” ì¶”ê°€/ì·¨ì†Œ: POST or DELETE /reaction
      function callReactionAPI(postId, isLike, cb) {
        var body = isLike
          ? { entryId: parseInt(postId, 10), reactionType: 'LIKE' }
          : { entryId: parseInt(postId, 10) };
        fetch('/reaction', {
          method: isLike ? 'POST' : 'DELETE',
          credentials: 'include',
          headers: {
            'Content-Type': 'application/json',
            'X-Requested-With': 'XMLHttpRequest'
          },
          body: JSON.stringify(body)
        })
          .then(function(r) {
            if (!r.ok) throw new Error('HTTP ' + r.status);
            return r.json();
          })
          .then(function(d) {
            var src = d.data || d;
            var count = extractCount(src);
            _likeCache[postId] = { liked: isLike, count: count };
            cb({ success: true, liked: isLike, count: count });
          })
          .catch(function() { cb({ success: false }); });
      }

      function applyLikeUI(liked, count) {
        if (!lbLikeBtn || !lbLikesLine) return;
        lbLikeBtn.classList.toggle('liked', liked);
        lbLikesLine.textContent = count != null ? 'ì¢‹ì•„ìš” ' + count + 'ê°œ' : 'ì¢‹ì•„ìš”';
      }

      // lbOpen ì‹œ í˜„ì¬ ìƒíƒœ ë¡œë“œ
      function updateLikeUI(postUrl) {
        var postId = getPostId(postUrl);
        if (!postId) { applyLikeUI(false, 0); return; }
        applyLikeUI(false, null); // ì´ˆê¸°í™”
        fetchLikeState(postId, postUrl, function(state) {
          applyLikeUI(state.liked, state.count);
        });
      }

      // â”€â”€ HTML ì´ìŠ¤ì¼€ì´í”„ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function escHtml(s) {
        return String(s)
          .replace(/&/g,'&amp;').replace(/</g,'&lt;')
          .replace(/>/g,'&gt;').replace(/"/g,'&quot;');
      }

      // â”€â”€ ëŒ“ê¸€ ì‹œê°„ í¬ë§· â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function fmtTime(str) {
        if (!str) return '';
        // "YYYY-MM-DD HH:mm:ss" ë˜ëŠ” ISO í˜•ì‹
        var d = new Date(str.replace(' ', 'T'));
        if (isNaN(d)) return str;
        var diff = Math.floor((Date.now() - d) / 1000);
        if (diff < 60)   return 'ë°©ê¸ˆ ì „';
        if (diff < 3600) return Math.floor(diff/60) + 'ë¶„ ì „';
        if (diff < 86400) return Math.floor(diff/3600) + 'ì‹œê°„ ì „';
        var y = d.getFullYear(), m = d.getMonth()+1, day = d.getDate();
        return y + '. ' + m + '. ' + day + '.';
      }

      // â”€â”€ ë¹„ë°€ë²ˆí˜¸ í•´ì‹±: SHA-256( MD5( encodeURIComponent(pw) ) ) â”€â”€
      //    ë°©ëª…ë¡ê³¼ ë™ì¼í•œ Tistory í‘œì¤€ ë°©ì‹
      function sha256hex(str) {
        return crypto.subtle.digest('SHA-256', new TextEncoder().encode(str))
          .then(function(buf) {
            return Array.from(new Uint8Array(buf))
              .map(function(b) { return b.toString(16).padStart(2, '0'); }).join('');
          });
      }
      function lbHashPw(passwd) {
        if (!passwd) return Promise.resolve('');
        var encoded = encodeURIComponent(passwd);
        var md5hash = (typeof md5 === 'function') ? md5(encoded) : encoded;
        return sha256hex(md5hash);
      }

      // â”€â”€ Tistory ëª¨ë°”ì¼ ëŒ“ê¸€ API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      //  GET /m/api/{postId}/comment?reverse=true
      //  ì‘ë‹µ: { data: { items: [...], totalItems: N } }
      function fetchTistoryComments(postUrl, cb) {
        var postId = (postUrl.match(/\/(\d+)/) || [])[1];
        if (!postId) { cb(null); return; }
        fetch('/m/api/' + postId + '/comment?reverse=true', { credentials: 'include' })
          .then(function(r) {
            if (!r.ok) throw new Error('HTTP ' + r.status);
            return r.json();
          })
          .then(function(res) {
            var d    = res.data || res;
            var list = d.items || d.comments || [];
            cb(Array.isArray(list) ? list : []);
          })
          .catch(function() { cb(null); });
      }

      // â”€â”€ ëŒ“ê¸€ ë‹¨ì¼ í•­ëª© HTML â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function cmtItemHtml(c, isReply) {
        var author = escHtml((c.writer && c.writer.name) || c.name || 'ìµëª…');
        var text   = escHtml(c.content || '');
        var time   = escHtml(c.written || fmtTime(c.regTime || c.date || ''));
        var avatar = (c.writer && c.writer.profileImage) || c.profileImage || '';
        var avHtml = avatar
          ? '<img class="dyo-lb-ig-cmt-avatar" src="' + escHtml(avatar) + '" alt="" loading="lazy">'
          : '<div class="dyo-lb-ig-cmt-avatar dyo-lb-ig-cmt-avatar-def"></div>';
        return (
          '<div class="dyo-lb-ig-cmt-item' + (isReply ? ' dyo-lb-ig-cmt-reply' : '') + '">' +
            avHtml +
            '<div class="dyo-lb-ig-cmt-body">' +
              '<span class="dyo-lb-ig-cmt-author">' + author + '</span> ' +
              '<span class="dyo-lb-ig-cmt-text">'   + text   + '</span>' +
              (time ? '<div class="dyo-lb-ig-cmt-time">' + time + '</div>' : '') +
            '</div>' +
          '</div>'
        );
      }

      // â”€â”€ ëŒ“ê¸€ ë Œë”ë§ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function renderComments(comments) {
        if (!lbCmtStub) return;
        if (comments === null) {
          lbCmtStub.innerHTML = '<p class="dyo-lb-ig-cmt-empty">ëŒ“ê¸€ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</p>';
          return;
        }
        if (comments.length === 0) {
          lbCmtStub.innerHTML = '<p class="dyo-lb-ig-cmt-empty">ì²« ë²ˆì§¸ ëŒ“ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”.</p>';
          return;
        }
        var html = '';
        comments.forEach(function(c) {
          html += cmtItemHtml(c, false);
          // ë‹µê¸€(children)ë„ ë Œë”ë§
          if (Array.isArray(c.children)) {
            c.children.forEach(function(child) {
              html += cmtItemHtml(child, true);
            });
          }
        });
        lbCmtStub.innerHTML = html;
      }

      function updateCmtUI(postUrl) {
        if (!lbCmtStub) return;
        lbCmtStub.innerHTML = '<p class="dyo-lb-ig-cmt-empty">ëŒ“ê¸€ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦</p>';
        fetchTistoryComments(postUrl, function(comments) {
          // ëŒ“ê¸€ ì‘ë‹µì—ì„œ isRequestUser í™•ì¸ (ì•„ì§ ë¡œê·¸ì¸ ìƒíƒœ ë¯¸í™•ì¸ ì‹œ)
          if (_lbLoginState === null && Array.isArray(comments)) {
            comments.forEach(function(c) {
              if (c.writer && c.writer.isRequestUser) _lbLoginState = true;
              (c.children || []).forEach(function(child) {
                if (child.writer && child.writer.isRequestUser) _lbLoginState = true;
              });
            });
            if (_lbLoginState === true) updateComposeMeta(true);
          }
          renderComments(comments);
        });
      }

      // â”€â”€ ëŒ“ê¸€ ì‘ì„± â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      //  POST /m/api/{postId}/comment
      function postComment(postId, name, pw, text, cb) {
        lbHashPw(pw).then(function(hashedPw) {
          fetch('/m/api/' + postId + '/comment', {
            method: 'POST',
            credentials: 'include',
            headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
            body: JSON.stringify({
              captcha:    '',
              comment:    text,
              homepage:   location.origin,
              isSecret:   false,
              mentionId:  null,
              name:       name || 'ìµëª…',
              parent:     null,
              password:   hashedPw
            })
          })
            .then(function(r) {
              if (!r.ok) throw new Error('HTTP ' + r.status);
              return r.json();
            })
            .then(function(d) { cb({ success: true, data: d }); })
            .catch(function() { cb({ success: false }); });
        }).catch(function() { cb({ success: false }); });
      }

      // â”€â”€ ê³µìœ  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function sharePost(url) {
        var fullUrl = location.origin + url;
        if (navigator.share) {
          navigator.share({ url: fullUrl }).catch(function() {});
        } else {
          navigator.clipboard.writeText(fullUrl).then(function() {
            var btn = lbShareBtn;
            var orig = btn.innerHTML;
            btn.innerHTML = '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#4ade80" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>';
            setTimeout(function() { btn.innerHTML = orig; }, 1500);
          }).catch(function() {});
        }
      }

      // â”€â”€ ë©”ì¸ open/close â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function lbOpen(idx) {
        _currentIdx = ((idx % _photos.length) + _photos.length) % _photos.length;
        var p = _photos[_currentIdx];

        lbImgEl.src              = p.img;
        lbImgEl.alt              = p.title || '';
        if (lbTitleEl)  lbTitleEl.textContent  = p.title || '';
        if (lbDateEl)   lbDateEl.textContent   = p.date  || '';
        if (lbCntEl)    lbCntEl.textContent    = (_currentIdx + 1) + ' / ' + _photos.length;
        if (lbPostLink) lbPostLink.href = p.url;

        var show = _photos.length > 1;
        if (lbPrevEl) lbPrevEl.style.display = show ? '' : 'none';
        if (lbNextEl) lbNextEl.style.display = show ? '' : 'none';

        updateLikeUI(p.url);
        updateCmtUI(p.url);
        // ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¼ ì´ë¦„/ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ë€ í‘œì‹œ ì—¬ë¶€ ê²°ì •
        updateComposeMeta(_lbLoginState === true);

        if (lbEl) lbEl.classList.add('open');
        if (lbDropdown) lbDropdown.classList.remove('open');
      }

      function lbClose() {
        if (lbEl) lbEl.classList.remove('open');
        if (lbImgEl) lbImgEl.src = '';
        if (lbDropdown) lbDropdown.classList.remove('open');
      }

      // â”€â”€ ì´ë²¤íŠ¸ ë°”ì¸ë”© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      if (lbCloseEl) lbCloseEl.addEventListener('click', lbClose);
      if (lbBgEl)    lbBgEl.addEventListener('click',    lbClose);
      if (lbPrevEl)  lbPrevEl.addEventListener('click',  function() { lbOpen(_currentIdx - 1); });
      if (lbNextEl)  lbNextEl.addEventListener('click',  function() { lbOpen(_currentIdx + 1); });

      // í–„ë²„ê±° ë©”ë‰´
      if (lbMenuBtn) lbMenuBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        if (lbDropdown) lbDropdown.classList.toggle('open');
      });
      document.addEventListener('click', function() {
        if (lbDropdown) lbDropdown.classList.remove('open');
      });

      // ë§í¬ ë³µì‚¬
      if (lbCopyLink) lbCopyLink.addEventListener('click', function() {
        var p = _photos[_currentIdx];
        if (!p) return;
        navigator.clipboard.writeText(location.origin + p.url).then(function() {
          lbCopyLink.textContent = 'ë³µì‚¬ë¨ âœ“';
          setTimeout(function() { lbCopyLink.textContent = 'ë§í¬ ë³µì‚¬'; }, 1500);
        }).catch(function() {});
        if (lbDropdown) lbDropdown.classList.remove('open');
      });

      // ì¢‹ì•„ìš”
      if (lbLikeBtn) lbLikeBtn.addEventListener('click', function() {
        var p = _photos[_currentIdx];
        if (!p) return;
        var postId  = getPostId(p.url);
        if (!postId) return;
        var nowLiked = !lbLikeBtn.classList.contains('liked');
        // ë‚™ê´€ì  UI ì—…ë°ì´íŠ¸ (ì¦‰ì‹œ ë°˜ì˜)
        var curText  = lbLikesLine ? lbLikesLine.textContent : '';
        var curCount = parseInt((curText.match(/\d+/) || ['0'])[0], 10);
        applyLikeUI(nowLiked, nowLiked ? curCount + 1 : Math.max(0, curCount - 1));
        lbLikeBtn.classList.remove('pop');
        void lbLikeBtn.offsetWidth;
        lbLikeBtn.classList.add('pop');
        // API í˜¸ì¶œ í›„ ì„œë²„ ì¹´ìš´íŠ¸ë¡œ ë³´ì •
        callReactionAPI(postId, nowLiked, function(res) {
          if (!res.success) {
            // ì‹¤íŒ¨ ì‹œ ì›ë˜ ìƒíƒœë¡œ ë¡¤ë°± + ìºì‹œë„ ë³µì›
            _likeCache[postId] = { liked: !nowLiked, count: curCount };
            applyLikeUI(!nowLiked, curCount);
          } else if (res.count != null) {
            applyLikeUI(nowLiked, res.count);
          }
        });
      });

      // ê³µìœ 
      if (lbShareBtn) lbShareBtn.addEventListener('click', function() {
        var p = _photos[_currentIdx];
        if (p) sharePost(p.url);
      });

      // ëŒ“ê¸€ ì…ë ¥ â€” ë‚´ìš© ìˆì–´ì•¼ ê²Œì‹œ ë²„íŠ¼ í™œì„±í™”
      if (lbCmtInput) lbCmtInput.addEventListener('input', function() {
        if (lbCmtSubmit) lbCmtSubmit.disabled = !this.value.trim();
      });

      // ëŒ“ê¸€ ì…ë ¥ â€” Enter í‚¤ë¡œ ì œì¶œ
      if (lbCmtInput) lbCmtInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' && !e.shiftKey && lbCmtSubmit && !lbCmtSubmit.disabled) {
          e.preventDefault();
          lbCmtSubmit.click();
        }
      });

      // ëŒ“ê¸€ ê²Œì‹œ
      if (lbCmtSubmit) lbCmtSubmit.addEventListener('click', function() {
        var p = _photos[_currentIdx];
        if (!p) return;
        var postId  = getPostId(p.url);
        var name    = lbCmtName   ? lbCmtName.value.trim()   : '';
        var pw      = lbCmtPw     ? lbCmtPw.value             : '';
        var comment = lbCmtInput  ? lbCmtInput.value.trim()  : '';
        if (!comment || !postId) return;

        lbCmtSubmit.disabled = true;
        lbCmtSubmit.textContent = 'â€¦';

        postComment(postId, name, pw, comment, function(res) {
          lbCmtSubmit.textContent = 'ê²Œì‹œ';
          if (res.success) {
            if (lbCmtInput) { lbCmtInput.value = ''; }
            // ëŒ“ê¸€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            updateCmtUI(p.url);
          } else {
            // ì‹¤íŒ¨ ì‹œ ë²„íŠ¼ ì¬í™œì„±í™”
            lbCmtSubmit.disabled = false;
          }
        });
      });

      // í‚¤ë³´ë“œ
      document.addEventListener('keydown', function(e) {
        if (!lbEl || !lbEl.classList.contains('open')) return;
        if (e.key === 'Escape')     lbClose();
        if (e.key === 'ArrowLeft')  lbOpen(_currentIdx - 1);
        if (e.key === 'ArrowRight') lbOpen(_currentIdx + 1);
      });

      var gpPostCountEl = document.getElementById('dyoGpPostCount');
      function setProfilePostCount(n) {
        if (gpPostCountEl) gpPostCountEl.textContent = n;
      }

      // â”€â”€ ë Œë”ë§ (ë¬´í•œ ìŠ¤í¬ë¡¤) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function _makeCell(p, idx) {
        var cell = document.createElement('div');
        cell.className = 'dyo-gallery-item';
        var img = document.createElement('img');
        img.src     = p.img;
        img.alt     = p.title || '';
        img.loading = 'lazy';
        var overlay = document.createElement('div');
        overlay.className = 'dyo-gallery-overlay';
        overlay.innerHTML = '<span class="dyo-ig-center-icon"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg></span>';
        cell.appendChild(img);
        cell.appendChild(overlay);
        cell.addEventListener('click', function() { lbOpen(idx); });
        return cell;
      }

      function renderMore() {
        if (_rendered >= _photos.length) return;
        // ê¸°ì¡´ sentinel ì œê±°
        var oldSentinel = gridEl.querySelector('.dyo-gallery-sentinel');
        if (oldSentinel) { if (_scrollObserver) _scrollObserver.unobserve(oldSentinel); oldSentinel.remove(); }

        var batch = _photos.slice(_rendered, _rendered + GALLERY_PAGE_SIZE);
        batch.forEach(function(p, bi) {
          gridEl.appendChild(_makeCell(p, _rendered + bi));
        });
        _rendered += batch.length;

        // ì•„ì§ ë” ìˆìœ¼ë©´ sentinel ì¶”ê°€
        if (_rendered < _photos.length) {
          var sentinel = document.createElement('div');
          sentinel.className = 'dyo-gallery-sentinel';
          gridEl.appendChild(sentinel);
          if (_scrollObserver) _scrollObserver.observe(sentinel);
        }
      }

      function render() {
        gridEl.innerHTML = '';
        _rendered = 0;
        _photos = GALLERY_POSTS;

        setProfilePostCount(_photos.length);

        if (!_photos.length) {
          gridEl.style.display  = 'none';
          emptyEl.style.display = 'flex';
          if (statusEl) statusEl.textContent = '0 posts';
          return;
        }

        gridEl.style.display  = 'grid';
        emptyEl.style.display = 'none';
        if (statusEl) statusEl.textContent = _photos.length + ' posts';
        renderMore();
      }

      // IntersectionObserver â€” ìŠ¤í¬ë¡¤ ë ê°ì§€
      if (galleryBodyEl && 'IntersectionObserver' in window) {
        _scrollObserver = new IntersectionObserver(function(entries) {
          entries.forEach(function(entry) {
            if (entry.isIntersecting) {
              _scrollObserver.unobserve(entry.target);
              renderMore();
            }
          });
        }, { root: galleryBodyEl, rootMargin: '60px' });
      }

      // â”€â”€ ì°½ ì—´ê¸°/ë‹«ê¸°/ìµœì†Œí™”/ìµœëŒ€í™” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function openGallery() {
        var wasOpen = w.classList.contains('open');
        if (!wasOpen) {
          var W = Math.min(400, window.innerWidth  - 40);
          var H = Math.min(580, window.innerHeight - 40);
          w.style.width  = W + 'px';
          w.style.height = H + 'px';
          w.style.left   = Math.round(window.innerWidth - W - 24) + 'px';
          w.style.top    = Math.max(20, Math.min(
            Math.round((window.innerHeight - H) / 2),
            window.innerHeight - H - 160
          )) + 'px';
          w.style.right  = 'auto';
          w.style.bottom = 'auto';
        }
        w.classList.remove('minimized', 'maximized');
        w.classList.add('open');
        bringToFront();
        if (!wasOpen && window.dyoAnimOpen) window.dyoAnimOpen(w);

        // ë¡œê·¸ì¸ ìƒíƒœ ê°ì§€ (ì²˜ìŒ í•œ ë²ˆë§Œ)
        if (_lbLoginState === null) {
          detectLoginState(function(isLoggedIn) { updateComposeMeta(isLoggedIn); });
        }

        if (GALLERY_CATEGORY) {
          // ì¹´í…Œê³ ë¦¬ í˜ì´ì§€ì—ì„œ ìë™ íŒŒì‹±
          if (statusEl) statusEl.textContent = 'ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦';
          if (gridEl)   gridEl.innerHTML = '';
          if (emptyEl)  emptyEl.style.display = 'none';
          fetchCategoryPosts(GALLERY_CATEGORY, function(posts) {
            if (posts && posts.length > 0) GALLERY_POSTS = posts;
            render();
          });
        } else {
          render();
        }
      }

      window.dyoOpenGallery = openGallery;

      if (closeBtn) closeBtn.addEventListener('click', function() {
        if (window.dyoAnimDismiss) {
          window.dyoAnimDismiss(w, function() { w.classList.remove('open', 'minimized', 'maximized'); });
        } else {
          w.classList.remove('open', 'minimized', 'maximized');
        }
      });

      if (minBtn) minBtn.addEventListener('click', function() {
        if (w.classList.contains('minimized')) {
          var tb = document.querySelector('.dyo-taskbtn[data-win-id="dyoGalleryWin"]');
          window._dyoAnimSrc = tb || null;
          w.classList.remove('minimized');
          bringToFront();
          if (window.dyoAnimOpen) window.dyoAnimOpen(w);
        } else {
          if (window.dyoAnimMinimize) {
            window.dyoAnimMinimize(w, function() { w.classList.add('minimized'); });
          } else {
            w.classList.add('minimized');
          }
        }
      });

      if (maxBtn) maxBtn.addEventListener('click', function() {
        if (w.classList.contains('maximized')) {
          if (prevRect) {
            w.style.left = prevRect.l + 'px'; w.style.top    = prevRect.t + 'px';
            w.style.width = prevRect.w + 'px'; w.style.height = prevRect.h + 'px';
          }
          w.classList.remove('maximized');
          if (window.dyoAnimMaximizeOut) window.dyoAnimMaximizeOut(w);
        } else {
          w.classList.remove('minimized');
          var r = w.getBoundingClientRect();
          prevRect = { l: r.left, t: r.top, w: r.width, h: r.height };
          w.style.left = ''; w.style.top = ''; w.style.width = ''; w.style.height = '';
          w.classList.add('maximized');
          if (window.dyoAnimMaximizeIn) window.dyoAnimMaximizeIn(w);
        }
      });

      titlebar.addEventListener('dblclick', function(e) {
        if (e.target === closeBtn || e.target === minBtn || e.target === maxBtn) return;
        maxBtn.click();
      });

      // ë“œë˜ê·¸
      titlebar.addEventListener('mousedown', function(e) {
        if (w.classList.contains('maximized')) return;
        if (e.target === closeBtn || e.target === minBtn || e.target === maxBtn) return;
        var r = w.getBoundingClientRect();
        w.style.left = r.left + 'px'; w.style.top = r.top + 'px';
        var ox = e.clientX - r.left, oy = e.clientY - r.top;
        function onMove(ev) { w.style.left = (ev.clientX - ox) + 'px'; w.style.top = (ev.clientY - oy) + 'px'; }
        function onUp() { document.removeEventListener('mousemove', onMove); document.removeEventListener('mouseup', onUp); }
        document.addEventListener('mousemove', onMove);
        document.addEventListener('mouseup', onUp);
      });

      // ë¦¬ì‚¬ì´ì¦ˆ
      w.querySelectorAll('.dyo-brs-handle').forEach(function(handle) {
        handle.addEventListener('mousedown', function(e) {
          if (w.classList.contains('maximized')) return;
          e.preventDefault(); e.stopPropagation();
          var dir = handle.className.replace('dyo-brs-handle', '').trim();
          var r = w.getBoundingClientRect();
          var sx = e.clientX, sy = e.clientY;
          var sl = r.left, st = r.top, sw = r.width, sh = r.height;
          function onMove(ev) {
            var dx = ev.clientX - sx, dy = ev.clientY - sy;
            var nl = sl, nt = st, nw = sw, nh = sh;
            if (dir.includes('e')) nw = Math.max(340, sw + dx);
            if (dir.includes('s')) nh = Math.max(260, sh + dy);
            if (dir.includes('w')) { nw = Math.max(340, sw - dx); nl = sl + sw - nw; }
            if (dir.includes('n')) { nh = Math.max(260, sh - dy); nt = st + sh - nh; }
            w.style.width = nw + 'px'; w.style.height = nh + 'px';
            w.style.left  = nl + 'px'; w.style.top    = nt + 'px';
          }
          function onUp2() { document.removeEventListener('mousemove', onMove); document.removeEventListener('mouseup', onUp2); }
          document.addEventListener('mousemove', onMove);
          document.addEventListener('mouseup', onUp2);
        });
      });

      w.addEventListener('mousedown', bringToFront);
    })();

    // ======================================================
    // ì „ì—­ ESC â†’ ìµœì „ë©´ ì°½ ë‹«ê¸°
    // ======================================================
    document.addEventListener('keydown', function(e) {
      if (e.key !== 'Escape') return;
      if (document.querySelector('.dyo-ctx-menu.show')) return;
      var wins = document.querySelectorAll(
        '.dyo-shell-win.open:not(.minimized), .dyo-browser-win.open:not(.minimized)'
      );
      var top = null, topZ = -1;
      wins.forEach(function(w) {
        var z = parseInt(w.style.zIndex) || 0;
        if (z > topZ) { topZ = z; top = w; }
      });
      if (!top) return;
      if (window.dyoAnimDismiss) {
        window.dyoAnimDismiss(top, function() { top.classList.remove('open', 'minimized', 'maximized'); });
      } else {
        top.classList.remove('open', 'minimized', 'maximized');
      }
    });

    // ======================================================
    // íŠœí† ë¦¬ì–¼
    // ======================================================
    (function() {
      var TUT_KEY = 'dyo_tut_v1';

      var overlay   = document.getElementById('dyoTutorial');
      var spotlight = document.getElementById('dyoTutSpotlight');
      var box       = document.getElementById('dyoTutBox');
      var emojiEl   = document.getElementById('dyoTutEmoji');
      var titleEl   = document.getElementById('dyoTutTitle');
      var descEl    = document.getElementById('dyoTutDesc');
      var dotsEl    = document.getElementById('dyoTutDots');
      var skipBtn   = document.getElementById('dyoTutSkip');
      var nextBtn   = document.getElementById('dyoTutNext');
      if (!overlay) return;

      var previewEl = document.getElementById('dyoTutPreview');

      // â”€â”€ ë”ë¯¸ ì½˜í…ì¸  í—¬í¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function _blogCard(title, date, tag) {
        return '<div style="width:210px;border:1px solid #d0d7de;border-radius:8px;padding:12px;background:#fff;">' +
          '<div style="font-size:10px;color:#0969da;margin-bottom:5px;font-weight:600">' + tag + '</div>' +
          '<div style="font-size:12px;font-weight:600;color:#1f2328;margin-bottom:6px;line-height:1.4">' + title + '</div>' +
          '<div style="font-size:10px;color:#656d76">' + date + '</div>' +
          '</div>';
      }
      function _expItem(icon, label) {
        return '<div class="dyo-exp-item">' +
          '<div class="dyo-exp-item-icon">' + icon + '</div>' +
          '<div class="dyo-exp-item-label">' + label + '</div>' +
          '</div>';
      }
      function _chatRow(name, text, role, time) {
        return '<div class="dyo-chat-row ' + role + '">' +
          '<div class="dyo-chat-wrap">' +
          '<div class="dyo-chat-name">' + name + '</div>' +
          '<div class="dyo-chat-bwrap"><div class="dyo-chat-bubble">' + text + '</div></div>' +
          '<div class="dyo-chat-time">' + time + '</div>' +
          '</div></div>';
      }

      // ë”ë¯¸ ë°ì´í„°ë¥¼ í´ë¡ ì— ì£¼ì…
      function injectDummyContent(clone, winId) {
        if (winId === 'dyoBrowserWin') {
          var frame = clone.querySelector('iframe');
          if (frame) {
            var fakeDiv = document.createElement('div');
            fakeDiv.style.cssText = 'width:100%;height:100%;background:#f6f8fa;overflow:auto;padding:20px;box-sizing:border-box;font-family:"Segoe UI",sans-serif;';
            fakeDiv.innerHTML =
              '<div style="display:flex;flex-wrap:wrap;gap:14px;">' +
              _blogCard('JavaScript í´ë¡œì € ì™„ì „ ì •ë³µ', '2024.12.15', 'JavaScript') +
              _blogCard('React 18 ì£¼ìš” ë³€ê²½ì‚¬í•­', '2024.12.10', 'React') +
              _blogCard('TypeScript ìœ í‹¸ë¦¬í‹° íƒ€ì…', '2024.12.05', 'TypeScript') +
              _blogCard('Git ë¸Œëœì¹˜ ì „ëµ A to Z', '2024.11.28', 'Git') +
              _blogCard('Docker ì…ë¬¸ ê°€ì´ë“œ', '2024.11.15', 'DevOps') +
              _blogCard('CSS Grid vs Flexbox', '2024.11.10', 'CSS') +
              '</div>';
            frame.parentNode.replaceChild(fakeDiv, frame);
          }
          var urlBar = clone.querySelector('.dyo-browser-url');
          if (urlBar) urlBar.value = 'https://doyoucoding.tistory.com';
        } else if (winId === 'dyoExplorerWin') {
          var tree = clone.querySelector('#dyoExplorerTree');
          var main = clone.querySelector('#dyoExplorerMain');
          var addr = clone.querySelector('#dyoExpAddrBar');
          if (tree) {
            tree.innerHTML =
              '<div class="dyo-tree-item active" style="padding-left:4px">ğŸ“ Blog</div>' +
              '<div class="dyo-tree-children">' +
              '<div class="dyo-tree-item" style="padding-left:18px">ğŸ“ JavaScript</div>' +
              '<div class="dyo-tree-item" style="padding-left:18px">ğŸ“ React</div>' +
              '<div class="dyo-tree-item" style="padding-left:18px">ğŸ“ TypeScript</div>' +
              '<div class="dyo-tree-item" style="padding-left:18px">ğŸ“ DevOps</div>' +
              '<div class="dyo-tree-item" style="padding-left:18px">ğŸ“ Algorithm</div>' +
              '<div class="dyo-tree-item" style="padding-left:18px">ğŸ“ CSS</div>' +
              '</div>';
          }
          if (main) {
            main.innerHTML =
              '<div class="dyo-explorer-grid" style="padding:10px;">' +
              _expItem('ğŸ“', 'JavaScript') +
              _expItem('ğŸ“', 'React') +
              _expItem('ğŸ“', 'TypeScript') +
              _expItem('ğŸ“', 'DevOps') +
              _expItem('ğŸ“', 'Algorithm') +
              _expItem('ğŸ“', 'CSS') +
              '</div>';
          }
          if (addr) {
            addr.innerHTML = '<span class="dyo-exp-crumb current">ğŸ“&nbsp;Blog</span>';
          }
        } else if (winId === 'dyoGuestWin') {
          var loading = clone.querySelector('#dyoGuestLoading');
          var chat    = clone.querySelector('#dyoGuestChat');
          var footer  = clone.querySelector('#dyoGuestFooter');
          // ë¯¸ë¦¬ë³´ê¸°ì—ì„  ì…ë ¥ í‘¸í„° ìˆ¨ê¹€ â†’ ì±„íŒ… ì˜ì—­ì´ ê½‰ ì°¨ì„œ ì‹¤ì œ ëŒ€í™”ì²˜ëŸ¼ ë³´ì„
          if (footer)  footer.style.display  = 'none';
          if (loading) loading.style.display = 'none';
          if (chat) {
            chat.style.display = 'flex';
            chat.innerHTML =
              _chatRow('dummy', 'ë°©ëª…ë¡ì…ë‹ˆë‹¤.', 'visitor', '2025. 1. 1. 12:00') +
              _chatRow('doyoucode', 'ë°˜ê°‘ìŠµë‹ˆë‹¤ ğŸ˜Š', 'admin', '2025. 1. 1. 12:05') +
              _chatRow('dummy', 'ë¸”ë¡œê·¸ ì˜ ë³´ê³  ìˆì–´ìš” ã…ã…', 'visitor', '2025. 1. 15. 14:30') +
              _chatRow('doyoucode', 'ê°ì‚¬í•©ë‹ˆë‹¤! ìì£¼ ë†€ëŸ¬ì˜¤ì„¸ìš” :)', 'admin', '2025. 1. 15. 14:45');
          }
        }
      }

      // ì‹¤ì œ ì°½ ìš”ì†Œë¥¼ í´ë¡ í•´ì„œ ì˜¤ë¥¸ìª½ íŒ¨ë„ì— í‘œì‹œ
      function showWinPreview(winId) {
        previewEl.innerHTML = '';
        if (!winId) { previewEl.classList.add('hidden'); return; }
        var win = document.getElementById(winId);
        if (!win) { previewEl.classList.add('hidden'); return; }

        // ê° ì°½ì˜ ê³ ì • í¬ê¸° (CSS ê¸°ë³¸ê°’ ê¸°ì¤€, inline ë¦¬ì‚¬ì´ì¦ˆ ë¬´ì‹œ)
        var winW = winId === 'dyoBrowserWin'  ? 860
                 : winId === 'dyoExplorerWin' ? 580
                 : winId === 'dyoGuestWin'    ? 360
                 : 680;
        var winH = winId === 'dyoBrowserWin'  ? 580
                 : winId === 'dyoExplorerWin' ? 400
                 : winId === 'dyoGuestWin'    ? 580
                 : 440;

        // ë·°í¬íŠ¸ ê¸°ì¤€ìœ¼ë¡œ ìŠ¤ì¼€ì¼ ê³„ì‚° (ì˜¤ë¥¸ìª½ ì ˆë°˜ ê³µê°„ì— ë§ì¶¤)
        var maxH = window.innerHeight - 120;
        var maxW = window.innerWidth * 0.5 - 80;
        var scale = Math.min(maxH / winH, maxW / winW, 1);
        var scaledW = Math.round(winW * scale);
        var scaledH = Math.round(winH * scale);

        var clone = win.cloneNode(true);
        clone.removeAttribute('id');
        injectDummyContent(clone, winId);

        // .dyo-shell-winì´ font-monoë¥¼ ìƒì†í•˜ë¯€ë¡œ ë°©ëª…ë¡ì€ ID ì—†ì´ í°íŠ¸ê°€ ê¹¨ì§ â†’ ì¸ë¼ì¸ìœ¼ë¡œ ê°•ì œ
        var guestFont = winId === 'dyoGuestWin'
          ? 'font-family:\'Noto Sans KR\',\'Apple SD Gothic Neo\',-apple-system,sans-serif !important;'
          : '';
        clone.style.cssText =
          'position:static !important;display:flex !important;' +
          'width:' + winW + 'px !important;height:' + winH + 'px !important;' +
          'transform:scale(' + scale + ');transform-origin:top left;' +
          'pointer-events:none;flex-shrink:0;border-radius:12px;overflow:hidden;' +
          'box-sizing:border-box;bottom:auto !important;right:auto !important;' +
          'top:auto !important;left:auto !important;z-index:auto !important;' +
          guestFont;

        var viewport = document.createElement('div');
        viewport.style.cssText =
          'width:' + scaledW + 'px;height:' + scaledH + 'px;' +
          'overflow:hidden;border-radius:10px;' +
          'box-shadow:0 8px 40px rgba(0,0,0,0.8);pointer-events:none;flex-shrink:0;';
        viewport.appendChild(clone);
        previewEl.appendChild(viewport);
        previewEl.classList.remove('hidden');
      }

      var steps = [
        {
          target: null,
          emoji: 'ğŸ‘‹',
          title: 'ì•ˆë…•í•˜ì„¸ìš”!',
          desc: 'ì´ ë¸”ë¡œê·¸ëŠ” desktop í™”ë©´ì²˜ëŸ¼ ê¾¸ë©°ì§„ ê°œë°œ ë¸”ë¡œê·¸ \'Do you Coding?\' ì…ë‹ˆë‹¤. í•¨ê»˜ ë‘˜ëŸ¬ë³¼ê¹Œìš”?',
          previewWin: null
        },
        {
          target: 'desktopIconReadme',
          emoji: 'ğŸ“„',
          title: 'README',
          desc: 'ë¸”ë¡œê·¸ ì†Œê°œ, ì‚¬ìš©ë²• ë“±ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¸”ë¡œê·¸ì˜ ì „ì²´ì ì¸ ê¸°ëŠ¥ì„ ì—¬ê¸°ì„œ í™•ì¸í•˜ì„¸ìš”.',
          previewWin: 'dyoReadmeWin'
        },
        {
          target: 'desktopIconBlog',
          emoji: 'ğŸŒ',
          title: 'Dev Blog',
          desc: 'ë¸”ë¡œê·¸ ê¸€ ì „ì²´ë³´ê¸°ë¡œ ì´ë™í•©ë‹ˆë‹¤. ì‘ì„±ëœ í¬ìŠ¤íŠ¸ë¥¼ í•œëˆˆì— í™•ì¸í•´ë³´ì„¸ìš”.',
          previewWin: 'dyoBrowserWin'
        },
        {
          target: 'desktopIconShell',
          emoji: 'âŒ¨ï¸',
          title: 'Terminal',
          desc: 'ì»¤ìŠ¤í…€ í„°ë¯¸ë„ë¡œ ë‹¤ì–‘í•œ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n`help`ë¥¼ ì…ë ¥í•´ ë³´ì„¸ìš”.',
          previewWin: 'dyoShellWin'
        },
        {
          target: 'desktopIconExplorer',
          emoji: 'ğŸ“‚',
          title: 'File Explorer',
          desc: 'ì¹´í…Œê³ ë¦¬ ë³„ í¬ìŠ¤íŠ¸ë¥¼ íŒŒì¼ íƒìƒ‰ê¸° í˜•ì‹ìœ¼ë¡œ íƒìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
          previewWin: 'dyoExplorerWin'
        },
        {
          target: 'desktopIconGuest',
          emoji: 'ğŸ’¬',
          title: 'Guestbook',
          desc: 'ë°©ëª…ë¡ì— ë°©ë¬¸ í”ì ì„ ë‚¨ê²¨ì£¼ì„¸ìš”!\nì—¬ëŸ¬ë¶„ì˜ ëŒ“ê¸€ì„ í™˜ì˜í•©ë‹ˆë‹¤.',
          previewWin: 'dyoGuestWin'
        },
        {
          target: null,
          emoji: 'ğŸ‰',
          title: 'ì¤€ë¹„ ì™„ë£Œ!',
          desc: 'ì´ì œ ììœ ë¡­ê²Œ íƒìƒ‰í•˜ì„¸ìš”.\nìš°í´ë¦­ ë©”ë‰´ì—ì„œ ì–¸ì œë“  íŠœí† ë¦¬ì–¼ì„ ë‹¤ì‹œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
          last: true,
          previewWin: null
        }
      ];

      var currentStep = 0;

      function applySpotlight(targetId) {
        if (!targetId) {
          spotlight.classList.add('no-target');
          var cx = window.innerWidth / 2;
          var cy = window.innerHeight / 2;
          spotlight.style.left   = cx + 'px';
          spotlight.style.top    = cy + 'px';
          spotlight.style.width  = '0px';
          spotlight.style.height = '0px';
          return;
        }
        spotlight.classList.remove('no-target');
        var el = document.getElementById(targetId);
        if (!el) { applySpotlight(null); return; }
        var r   = el.getBoundingClientRect();
        var pad = 12;
        spotlight.style.left   = (r.left   - pad) + 'px';
        spotlight.style.top    = (r.top    - pad) + 'px';
        spotlight.style.width  = (r.width  + pad * 2) + 'px';
        spotlight.style.height = (r.height + pad * 2) + 'px';
      }

      function positionBox(targetId) {
        var bw = box.offsetWidth  || 300;
        var bh = box.offsetHeight || 220;
        var margin = 20;
        var vw = window.innerWidth;
        var vh = window.innerHeight;

        if (!targetId) {
          box.style.left = Math.round((vw - bw) / 2) + 'px';
          box.style.top  = Math.round((vh - bh) / 2) + 'px';
          return;
        }
        var el = document.getElementById(targetId);
        if (!el) { positionBox(null); return; }
        var r = el.getBoundingClientRect();

        // ì˜¤ë¥¸ìª½ì— ê³µê°„ì´ ìˆìœ¼ë©´ ì˜¤ë¥¸ìª½, ì—†ìœ¼ë©´ ì™¼ìª½
        var leftRight;
        if (r.right + margin + bw < vw) {
          leftRight = r.right + margin;
        } else {
          leftRight = r.left - bw - margin;
        }
        leftRight = Math.max(8, Math.min(leftRight, vw - bw - 8));

        // ìˆ˜ì§ ì¤‘ì•™ ì •ë ¬, í™”ë©´ ë°– ë³´ì •
        var topPos = Math.round(r.top + r.height / 2 - bh / 2);
        topPos = Math.max(8, Math.min(topPos, vh - bh - 8));

        box.style.left = leftRight + 'px';
        box.style.top  = topPos   + 'px';
      }

      function buildDots(total, current) {
        dotsEl.innerHTML = '';
        for (var i = 0; i < total; i++) {
          var d = document.createElement('span');
          d.className = 'dyo-tut-dot' + (i === current ? ' active' : '');
          dotsEl.appendChild(d);
        }
      }

      function showStep(idx) {
        var step = steps[idx];
        emojiEl.textContent = step.emoji;
        titleEl.textContent = step.title;
        descEl.textContent  = step.desc;
        nextBtn.textContent = step.last ? 'ì™„ë£Œ âœ“' : 'Next â†’';
        buildDots(steps.length, idx);

        // ì‹¤ì œ ì°½ í´ë¡  ë¯¸ë¦¬ë³´ê¸°
        showWinPreview(step.previewWin);

        applySpotlight(step.target);
        // ë°•ìŠ¤ ìœ„ì¹˜: ì¦‰ì‹œ ì„¤ì • (ì´ˆê¸°) í›„ ìŠ¤íŒŸë¼ì´íŠ¸ ì „í™˜ ë’¤ ì¬ì¡°ì •
        positionBox(step.target);
        setTimeout(function() { positionBox(step.target); }, 50);
      }

      function closeTutorial() {
        overlay.classList.remove('active');
        setTimeout(function() { overlay.style.display = 'none'; }, 400);
      }

      function endTutorial() {
        localStorage.setItem(TUT_KEY, '1');
        closeTutorial();
      }

      if (!skipBtn || !nextBtn) return;
      skipBtn.addEventListener('click', endTutorial);
      nextBtn.addEventListener('click', function() {
        currentStep++;
        if (currentStep >= steps.length) {
          endTutorial();
        } else {
          showStep(currentStep);
        }
      });

      // ESC ë¡œ ë‹«ê¸°
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && overlay.classList.contains('active')) {
          endTutorial();
        }
      });

      window.dyoStartTutorial = function() {
        currentStep = 0;
        overlay.style.display = '';
        requestAnimationFrame(function() {
          overlay.classList.add('active');
          showStep(0);
        });
      };

      window.dyoMaybeStartTutorial = function() {
        if (!localStorage.getItem(TUT_KEY)) {
          window.dyoStartTutorial();
        }
      };
    })();

    if (window.dyoMaybeStartTutorial) window.dyoMaybeStartTutorial();
  </script>
</body>

</html>
